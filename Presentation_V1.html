<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="RL">

<title>Untitled</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Presentation_V1_files/libs/clipboard/clipboard.min.js"></script>
<script src="Presentation_V1_files/libs/quarto-html/quarto.js"></script>
<script src="Presentation_V1_files/libs/quarto-html/popper.min.js"></script>
<script src="Presentation_V1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Presentation_V1_files/libs/quarto-html/anchor.min.js"></script>
<link href="Presentation_V1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Presentation_V1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Presentation_V1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Presentation_V1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Presentation_V1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Untitled</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>RL </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>From: <a href="https://osf.io/p5xsd/files/osfstorage" class="uri">https://osf.io/p5xsd/files/osfstorage</a></p>
<section id="load-and-prepare-data" class="level1">
<h1>0. Load and prepare data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="load-data" class="level2">
<h2 class="anchored" data-anchor-id="load-data">0.1 Load data:</h2>
<p>The permutation takes to long to allow for re-computing the code each time, so load it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"DataSave3SDiag_WardRothen.RData"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dataSource <span class="sc">==</span> <span class="st">"Ward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="ward-data" class="level3">
<h3 class="anchored" data-anchor-id="ward-data">0.1.1. Ward Data</h3>
</section>
<section id="rothen-data" class="level3">
<h3 class="anchored" data-anchor-id="rothen-data">0.1.1. Rothen Data</h3>
</section>
<section id="rename-variables-to-match-datasets" class="level3">
<h3 class="anchored" data-anchor-id="rename-variables-to-match-datasets">0.1.2. Rename variables to match datasets</h3>
</section>
</section>
<section id="merge-data" class="level2">
<h2 class="anchored" data-anchor-id="merge-data">0.2 Merge data:</h2>
</section>
<section id="wrangle-dataset" class="level2">
<h2 class="anchored" data-anchor-id="wrangle-dataset">0.3 Wrangle dataset</h2>
</section>
<section id="filter-ids" class="level2">
<h2 class="anchored" data-anchor-id="filter-ids">0.4 Filter ID’s</h2>
</section>
<section id="standardizescale-coordinates" class="level2">
<h2 class="anchored" data-anchor-id="standardizescale-coordinates">0.4 Standardize/scale coordinates</h2>
</section>
</section>
<section id="compute-consistency" class="level1">
<h1>1. Compute Consistency:</h1>
<p>Calculating consistency Each stimulus is represented by three xy coordinates - (x1, y1), (x2, y2), (x3, y3) - from the three repetitions. For each stimulus, the area of the triangle bounded by the coordinates is calculated as follows:</p>
<p><span class="math inline">\(Area = (x1y2 + x2y3 + x3y1 – x1y3 – x2y1 – x3y2) / 2\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define area calculation function</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>triangle_area <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(x) <span class="sc">!=</span> <span class="dv">3</span> <span class="sc">|</span> <span class="fu">length</span>(y) <span class="sc">!=</span> <span class="dv">3</span>) <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  area <span class="ot">&lt;-</span> <span class="fu">abs</span>(</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    x[<span class="dv">1</span>]<span class="sc">*</span>y[<span class="dv">2</span>] <span class="sc">+</span> x[<span class="dv">2</span>]<span class="sc">*</span>y[<span class="dv">3</span>] <span class="sc">+</span> x[<span class="dv">3</span>]<span class="sc">*</span>y[<span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    x[<span class="dv">1</span>]<span class="sc">*</span>y[<span class="dv">3</span>] <span class="sc">-</span> x[<span class="dv">2</span>]<span class="sc">*</span>y[<span class="dv">1</span>] <span class="sc">-</span> x[<span class="dv">3</span>]<span class="sc">*</span>y[<span class="dv">2</span>]</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(area)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply per group</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(ID, stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">triangle_area =</span> <span class="fu">triangle_area</span>(x, y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The mean area is calculated by adding together the area for each stimulus and dividing by 29. This unit is transformed into a percentage area taking into account the different pixel resolution of each participant.<br>
Mean area = $(Summed area / 29) * 100 / Screen area $ Where: <span class="math inline">\(Screen area = Xpixels * Ypixels\)</span></p>
<p><em>Note: 29 since 29 stimuli</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually adjust:</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>height[ds<span class="sc">$</span>ID <span class="sc">==</span> <span class="dv">29324</span>] <span class="ot">&lt;-</span> <span class="dv">1080</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>width[ds<span class="sc">$</span>ID <span class="sc">==</span> <span class="dv">32190</span> ] <span class="ot">&lt;-</span> <span class="dv">1440</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># This ID has weird changing screen settings, consider exclusion:</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>width[ds<span class="sc">$</span>ID <span class="sc">==</span> <span class="dv">33168</span> ]  <span class="ot">&lt;-</span> <span class="dv">308</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>height[ds<span class="sc">$</span>ID <span class="sc">==</span> <span class="dv">33168</span> ] <span class="ot">&lt;-</span> <span class="dv">149</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>width[ds<span class="sc">$</span>ID <span class="sc">==</span> <span class="dv">35556</span> ] <span class="ot">&lt;-</span> <span class="dv">1439</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>height[ds<span class="sc">$</span>ID <span class="sc">==</span> <span class="dv">35556</span> ] <span class="ot">&lt;-</span> <span class="dv">734</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>width[ds<span class="sc">$</span>ID <span class="sc">==</span> <span class="dv">48114</span> ]  <span class="ot">&lt;-</span> <span class="dv">1593</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>height[ds<span class="sc">$</span>ID <span class="sc">==</span> <span class="dv">48114</span> ] <span class="ot">&lt;-</span> <span class="dv">671</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>width[ds<span class="sc">$</span>ID <span class="sc">==</span> <span class="dv">59854</span>] <span class="ot">&lt;-</span> <span class="dv">1366</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>height[ds<span class="sc">$</span>ID <span class="sc">==</span> <span class="dv">59854</span>] <span class="ot">&lt;-</span> <span class="dv">663</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>width[ds<span class="sc">$</span>ID <span class="sc">==</span> <span class="dv">63127</span>] <span class="ot">&lt;-</span> <span class="dv">1920</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>height[ds<span class="sc">$</span>ID <span class="sc">==</span> <span class="dv">63127</span>] <span class="ot">&lt;-</span> <span class="dv">880</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Should be empty:</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>ID_heigthKO <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nhig =</span> <span class="fu">length</span>(<span class="fu">unique</span>(height))) <span class="sc">%&gt;%</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nhig <span class="sc">!=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>()<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(ID)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>ID_widthKO <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nwid =</span> <span class="fu">length</span>(<span class="fu">unique</span>(width))) <span class="sc">%&gt;%</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nwid <span class="sc">!=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>()<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(ID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>Screen_area <span class="ot">&lt;-</span> ds<span class="sc">$</span>width<span class="sc">*</span>ds<span class="sc">$</span>height</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span>  </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID,repetition) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Consistency =</span> ((<span class="fu">sum</span>(triangle_area)<span class="sc">/</span><span class="dv">29</span>)<span class="sc">*</span><span class="dv">100</span>)<span class="sc">/</span>Screen_area)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Sanity Check:</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ds %&gt;%</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(ID == 46603) %&gt;%</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   pull(Consistency)</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Should be 0.14498267124883</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="compute-permuted-consistency" class="level1">
<h1>2. Compute Permuted consistency</h1>
<p>Replicate Rothen methods. Might take some time to compute.</p>
<p><em>Calculating chance levels of consistency To create permuted datasets for each participant: the 87 xy coordinates are randomly shuffled so they are no longer linked to the original data labels (“Monday”, “5”, “April”, etc.). The mean area of the triangles based on the shuffled coordinates is computed (as described above), and the whole process is repeated 1000 times to obtain a subject-specific distribution of chance levels of consistency. A z-score is calculated comparing the observed consistency against the mean and SD of the permuted data:</em></p>
<p><span class="math inline">\(Z = [(observed consistency) – (mean consistency of permuted data)] / (SD of permuted data)\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Create a simulated distribution of consistency.  Note that each time this is run it will give a slightly different answer due to the randomisation</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>IDlist <span class="ot">&lt;-</span> <span class="fu">unique</span>(ds<span class="sc">$</span>ID)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>simulated_consistency <span class="ot">&lt;-</span> <span class="fu">data.frame</span>() </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>observed_consistency <span class="ot">&lt;-</span> <span class="fu">data.frame</span>() </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span>  <span class="co"># Total iterations</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>bar_width <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>update_points <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">length</span>(IDlist), <span class="at">length.out =</span> <span class="dv">200</span>))</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(ID_n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(IDlist)) {</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (ID_n <span class="sc">%in%</span> update_points <span class="sc">||</span> <span class="fu">length</span>(IDlist) <span class="sc">==</span> n) {</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    percent <span class="ot">&lt;-</span> ID_n <span class="sc">/</span> <span class="fu">length</span>(IDlist)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    num_hashes <span class="ot">&lt;-</span> <span class="fu">round</span>(percent <span class="sc">*</span> bar_width)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    bar <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"["</span>, </span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">paste</span>(<span class="fu">rep</span>(<span class="st">"#"</span>, num_hashes), <span class="at">collapse =</span> <span class="st">""</span>), </span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">paste</span>(<span class="fu">rep</span>(<span class="st">"-"</span>, bar_width <span class="sc">-</span> num_hashes), <span class="at">collapse =</span> <span class="st">""</span>), </span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"]"</span>)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\r</span><span class="st">%s %3d%%"</span>, bar, <span class="fu">round</span>(percent <span class="sc">*</span> <span class="dv">100</span>)))</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">flush.console</span>()</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(ID_n)</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>  ds_ID <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(ID <span class="sc">==</span> IDlist[ID_n])</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  observed_consistency[ID_n,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">unique</span>(ds_ID<span class="sc">$</span>ID)</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>  observed_consistency[ID_n,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">unique</span>(ds_ID<span class="sc">$</span>Consistency)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  <span class="do">### calculate the x and y standard deviations (no longer used, but calculated by Ward et al. 2018); Note the syntoolkit software calculated population SD (using N) but R will use sample SD (using N-1).  The values returned are very similar.</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>  observed_consistency[ID_n,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sd</span> (ds_ID<span class="sc">$</span>x) <span class="sc">/</span> ds_ID<span class="sc">$</span>width)</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  observed_consistency[ID_n,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sd</span> (ds_ID<span class="sc">$</span>y) <span class="sc">/</span> ds_ID<span class="sc">$</span>height)</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (N_shuffle <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>    <span class="do">## shuffle the data</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>    shuffled <span class="ot">&lt;-</span> ds_ID[<span class="fu">sample</span>(<span class="fu">nrow</span>(ds_ID)),]</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>    shuffled<span class="sc">$</span>rep2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>,<span class="dv">3</span>)</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>    area <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>    Stim_list <span class="ot">&lt;-</span> <span class="fu">unique</span>(ds_ID<span class="sc">$</span>stimulus)</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>    shuffled <span class="ot">&lt;-</span> shuffled <span class="sc">%&gt;%</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(rep2) <span class="sc">%&gt;%</span></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">area =</span> <span class="fu">triangle_area</span>(x, y))</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>    simulated_consistency[N_shuffle,<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">unique</span>((<span class="fu">sum</span>(shuffled<span class="sc">$</span>area)<span class="sc">/</span><span class="dv">29</span>) <span class="sc">*</span> <span class="dv">100</span> <span class="sc">/</span> (shuffled<span class="sc">$</span>width <span class="sc">*</span> shuffled<span class="sc">$</span>height))</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>  <span class="do">## calculate the p-value and z-score of the observed consistency</span></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>  observed_consistency[ID_n,<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(simulated_consistency[,<span class="dv">1</span>])</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>  observed_consistency[ID_n,<span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(simulated_consistency[,<span class="dv">1</span>])</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>  observed_consistency[ID_n,<span class="dv">7</span>] <span class="ot">&lt;-</span> (observed_consistency[ID_n,<span class="dv">2</span>] <span class="sc">-</span> observed_consistency[ID_n,<span class="dv">5</span>]) <span class="sc">/</span>   observed_consistency[ID_n,<span class="dv">6</span>]</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(observed_consistency) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'participant'</span>, <span class="st">'consistency'</span>, <span class="st">'x-sd'</span>, <span class="st">'y-sd'</span>, <span class="st">'mean_simulation'</span>, <span class="st">'SD_simulation'</span>, <span class="st">'z-score'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="compute-sd-as-in-ward" class="level1">
<h1>3. Compute SD as in Ward</h1>
<p>As in Ward:</p>
<p>“<em>Specifically, the standard deviation of the x-coordinates and/or the standard deviation of the y-coordinates (measured across all trials) should exceed a proposed value of 0.075 for a normalized screen with width and height of 1 unit.</em>”</p>
<p>“<em>A participant who produced a horizontal straight-line form would have a very low standard deviation in the y-coordinates but a high standard deviation in x-coordinates, and a participant with a vertical line would have the reverse profile. A participant with a circular spatial form would be high on both. A participant who clicks randomly around the screen would also be high on both x and y standard deviation, but would fail the consistency tests (the triangles would be large).</em>”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rescale x &amp; y mcoordinates depending on screen size:</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>xSc <span class="ot">&lt;-</span> ds<span class="sc">$</span>x<span class="sc">/</span>ds<span class="sc">$</span>width</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>ySc <span class="ot">&lt;-</span> ds<span class="sc">$</span>y<span class="sc">/</span>ds<span class="sc">$</span>height</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the SD across all trials (per ID):</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SD_IDx =</span> <span class="fu">sd</span>(xSc)) <span class="sc">%&gt;%</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SD_IDy =</span> <span class="fu">sd</span>(ySc)) </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>ds <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(ID <span class="sc">==</span> <span class="dv">28301</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>()<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(SD_IDy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2030271</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ds_Q <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ID <span class="sc">==</span> <span class="dv">28301</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(y_sd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2018569</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare full lists:</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>sd_ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">row_number</span>()<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(SD_IDy,ID)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>sd_dsQ <span class="ot">&lt;-</span> ds_Q <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(ID)  <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(y_sd,ID)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>merge_sd <span class="ot">&lt;-</span> <span class="fu">merge</span>(sd_ds,sd_dsQ, <span class="at">by =</span> <span class="st">"ID"</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co"># I think we can live with this degree of error (i.e. max 0.002)</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co"># boxplot(merge_sd$SD_IDy -merge_sd$y_sd)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="compute-line-intersections" class="level1">
<h1>5. Compute line intersections</h1>
<p>An idea I have is to look into the lines and order of the forms. I would exclude when lines crosses. (since we expect forms the lines crossing means no form is formed). Needs refinement.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define function: this was generated by chatgpt. I tested it and it works, but need to figure out the geometry behind it:</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>count_self_intersections <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">verbose =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n <span class="sc">&lt;</span> <span class="dv">4</span>) {</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (verbose) <span class="fu">cat</span>(<span class="st">"Need at least 4 points to check for self-intersection.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Orientation function</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  orientation <span class="ot">&lt;-</span> <span class="cf">function</span>(p, q, r) {</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    val <span class="ot">&lt;-</span> (q[<span class="dv">2</span>] <span class="sc">-</span> p[<span class="dv">2</span>]) <span class="sc">*</span> (r[<span class="dv">1</span>] <span class="sc">-</span> q[<span class="dv">1</span>]) <span class="sc">-</span> (q[<span class="dv">1</span>] <span class="sc">-</span> p[<span class="dv">1</span>]) <span class="sc">*</span> (r[<span class="dv">2</span>] <span class="sc">-</span> q[<span class="dv">2</span>])</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.na</span>(val)) <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (val <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (val <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="dv">1</span>) <span class="cf">else</span> <span class="fu">return</span>(<span class="dv">2</span>)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if q lies on segment pr</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  on_segment <span class="ot">&lt;-</span> <span class="cf">function</span>(p, q, r) {</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">is.na</span>(<span class="fu">c</span>(p, q, r)))) <span class="fu">return</span>(<span class="cn">FALSE</span>)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    q[<span class="dv">1</span>] <span class="sc">&lt;=</span> <span class="fu">max</span>(p[<span class="dv">1</span>], r[<span class="dv">1</span>]) <span class="sc">&amp;&amp;</span> q[<span class="dv">1</span>] <span class="sc">&gt;=</span> <span class="fu">min</span>(p[<span class="dv">1</span>], r[<span class="dv">1</span>]) <span class="sc">&amp;&amp;</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>      q[<span class="dv">2</span>] <span class="sc">&lt;=</span> <span class="fu">max</span>(p[<span class="dv">2</span>], r[<span class="dv">2</span>]) <span class="sc">&amp;&amp;</span> q[<span class="dv">2</span>] <span class="sc">&gt;=</span> <span class="fu">min</span>(p[<span class="dv">2</span>], r[<span class="dv">2</span>])</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Main intersection check</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>  segments_intersect <span class="ot">&lt;-</span> <span class="cf">function</span>(p1, p2, p3, p4) {</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    o1 <span class="ot">&lt;-</span> <span class="fu">orientation</span>(p1, p2, p3)</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    o2 <span class="ot">&lt;-</span> <span class="fu">orientation</span>(p1, p2, p4)</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>    o3 <span class="ot">&lt;-</span> <span class="fu">orientation</span>(p3, p4, p1)</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>    o4 <span class="ot">&lt;-</span> <span class="fu">orientation</span>(p3, p4, p2)</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">is.na</span>(<span class="fu">c</span>(o1, o2, o3, o4)))) <span class="fu">return</span>(<span class="cn">FALSE</span>)</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># General case</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (o1 <span class="sc">!=</span> o2 <span class="sc">&amp;&amp;</span> o3 <span class="sc">!=</span> o4) <span class="fu">return</span>(<span class="cn">TRUE</span>)</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Special colinear cases</span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (o1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">on_segment</span>(p1, p3, p2)) <span class="fu">return</span>(<span class="cn">TRUE</span>)</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (o2 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">on_segment</span>(p1, p4, p2)) <span class="fu">return</span>(<span class="cn">TRUE</span>)</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (o3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">on_segment</span>(p3, p1, p4)) <span class="fu">return</span>(<span class="cn">TRUE</span>)</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (o4 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">on_segment</span>(p3, p2, p4)) <span class="fu">return</span>(<span class="cn">TRUE</span>)</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">FALSE</span>)</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>  count <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">2</span>)) {</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> (i <span class="sc">+</span> <span class="dv">2</span>)<span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (j <span class="sc">==</span> i <span class="sc">+</span> <span class="dv">1</span>) <span class="cf">next</span>  <span class="co"># skip adjacent segments</span></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>      p1 <span class="ot">&lt;-</span> <span class="fu">c</span>(x[i], y[i])</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>      p2 <span class="ot">&lt;-</span> <span class="fu">c</span>(x[i <span class="sc">+</span> <span class="dv">1</span>], y[i <span class="sc">+</span> <span class="dv">1</span>])</span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>      p3 <span class="ot">&lt;-</span> <span class="fu">c</span>(x[j], y[j])</span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>      p4 <span class="ot">&lt;-</span> <span class="fu">c</span>(x[j <span class="sc">+</span> <span class="dv">1</span>], y[j <span class="sc">+</span> <span class="dv">1</span>])</span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">segments_intersect</span>(p1, p2, p3, p4)) {</span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>        count <span class="ot">&lt;-</span> count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (verbose) {</span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Intersection #%d: segments (%d-%d) and (%d-%d)</span><span class="sc">\n</span><span class="st">"</span>, count, i, i<span class="sc">+</span><span class="dv">1</span>, j, j<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (verbose) <span class="fu">cat</span>(<span class="st">"Total crossings:"</span>, count, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(count)</span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I think that the number of stimuli per condition should be taken into account (i.e.&nbsp;9 numbers, 7 days, 12 months). Hence would need to be divided by this number of stimulus.</p>
<p>In each condition the connected x and y generates a segment, hence the number of segment is <code>length(stimuli)-1</code>. Moreover, currently, each stimuli is connected by 3 segment, one for each (of the 3) repetition. So dividing by 3, we have the average number of segment crossings per condition. Next we sum these for each ID Ideally we should compute the number of crossings across the repetitions, in addition to make it more complex it would also be computationally more demanding, and I don’t believe it would lead to a significant difference.</p>
<p>To do: - Maybe the easier would be to have the average number of crossing per segment.</p>
<p>IMPORTANT: data frame needs to be informed of stimulus order to make sense!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Cond,repetition) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nSegments =</span> <span class="fu">length</span>(stimulus)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of crossings per condition and repetition</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">ordered</span>(stimulus, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Monday"</span>, <span class="st">"Tuesday"</span>, <span class="st">"Wednesday"</span>, <span class="st">"Thursday"</span>, <span class="st">"Friday"</span>,<span class="st">"Saturday"</span>,<span class="st">"Sunday"</span>))) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">ordered</span>(stimulus, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"January"</span>, <span class="st">"February"</span>, <span class="st">"March"</span>, <span class="st">"April"</span>, <span class="st">"May"</span>,<span class="st">"June"</span>,<span class="st">"July"</span>,<span class="st">"August"</span>,<span class="st">"September"</span>,<span class="st">"October"</span>,<span class="st">"November"</span>,<span class="st">"December"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(ID, Cond,repetition) %&gt;%</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Cond) <span class="sc">%&gt;%</span> <span class="co"># This should ignore the repetitions. So it should become a very long line including all repetitions, which might catch some consistency.</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nLineCross =</span> (<span class="fu">count_self_intersections</span>(x,y, <span class="at">verbose =</span> <span class="cn">FALSE</span>)))</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Cond) <span class="sc">%&gt;%</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">meanLineCross =</span> nLineCross<span class="sc">/</span>(<span class="dv">3</span><span class="sc">*</span>nSegments))</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Average per ID, use the number of segment rather than the number of stimuli</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GA_lineInter =</span> <span class="fu">mean</span>(meanLineCross))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="random-walk" class="level2">
<h2 class="anchored" data-anchor-id="random-walk">4.1 Random walk</h2>
<p>There are thee way of dealing with repetitions: - compute separately the line crossing across repetitions - compute the line crossing as if we had a very long line (i.e.&nbsp;1_1 -&gt; 2_1 -&gt; 3_1 -&gt; 4_1, … 7_3 -&gt; 8_3 -&gt; 9_3) (_x = repetition). - do a random walk across repetitions. (But I don’t know if it makes any sense practically).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ds &lt;- ds %&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(ID, Cond,repetition) %&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(nSegments = length(stimulus)-1)</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># # Number of crossings per condition and repetition</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ds &lt;- ds %&gt;% </span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(stimulus) %&gt;%</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   arrange(stimulus) %&gt;%</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   arrange(ordered(stimulus, levels = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday","Saturday","Sunday"))) %&gt;% arrange(ordered(stimulus, levels = c("January", "February", "March", "April", "May","June","July","August","September","October","November","December"))) %&gt;%</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   ungroup() %&gt;%</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   # group_by(ID, Cond,repetition) %&gt;%</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(ID, Cond) %&gt;% # This should ignore the repetitions. So it should become a very long line including all repetitions, which might catch some consistency.</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(nLineCross = (count_self_intersections(x,y, verbose = FALSE)))</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co"># ds &lt;- ds %&gt;% </span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(ID, Cond) %&gt;%</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(meanLineCross = nLineCross/(3*nSegments))</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="co"># # Average per ID, use the number of segment rather than the number of stimuli</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ds &lt;- ds %&gt;%</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(ID) %&gt;%</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(totLineCross = mean(meanLineCross))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="line-intersections" class="level2">
<h2 class="anchored" data-anchor-id="line-intersections">4.2. Line intersections</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Cond,repetition) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nSegments =</span> <span class="fu">length</span>(stimulus)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of intersections for each ID X Cond X repetition</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">ordered</span>(stimulus, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Monday"</span>, <span class="st">"Tuesday"</span>, <span class="st">"Wednesday"</span>, <span class="st">"Thursday"</span>, <span class="st">"Friday"</span>,<span class="st">"Saturday"</span>,<span class="st">"Sunday"</span>))) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">ordered</span>(stimulus, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"January"</span>, <span class="st">"February"</span>, <span class="st">"March"</span>, <span class="st">"April"</span>, <span class="st">"May"</span>,<span class="st">"June"</span>,<span class="st">"July"</span>,<span class="st">"August"</span>,<span class="st">"September"</span>,<span class="st">"October"</span>,<span class="st">"November"</span>,<span class="st">"December"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Cond,repetition) <span class="sc">%&gt;%</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nLineCross =</span> (<span class="fu">count_self_intersections</span>(x,y, <span class="at">verbose =</span> <span class="cn">FALSE</span>)))</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear transformation: chances for each segment to intersect:</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Cond,repetition) <span class="sc">%&gt;%</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_lineInter =</span> nLineCross<span class="sc">/</span>nSegments)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Average per ID</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GA_lineInter =</span> <span class="fu">mean</span>(meanLineCross))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Arbitrary threshold of 0.25.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>SynLine <span class="ot">&lt;-</span> ds<span class="sc">$</span>GA_lineInter <span class="sc">&lt;=</span> <span class="fl">0.25</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>GA_lineInter</code> is the general average of all repetitions and conditions, of the chances that two segments <em>within each Condition and repetition</em> would cross. That is, for each IDXConditionXrepetition separatedly, we computed the number of segments that crosses in ordered stimuli (note the number of segment is the number of stimuli - 1), divided by the number of segments. This gives, for each IDXConditionXrepetition separately, the chances that two segments intersect. This chance is then averaged for each ID. This also means that conditions with more stimuli might have smaller averages (?). Could also compute the median.</p>
</section>
</section>
<section id="questionnaire-classification-based" class="level1">
<h1>5. Questionnaire Classification based</h1>
<p>see ´SynQuest´</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>ds_Q<span class="sc">$</span>QuestCriteria <span class="ot">&lt;-</span> ds_Q<span class="sc">$</span><span class="st">`</span><span class="at">questionnaire score</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="dv">19</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(ds_Q<span class="sc">$</span>QuestCriteria)<span class="sc">/</span><span class="fu">length</span>(ds_Q<span class="sc">$</span>QuestCriteria)<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>ID_SynQuest <span class="ot">&lt;-</span> ds_Q<span class="sc">$</span>ID[ds_Q<span class="sc">$</span>QuestCriteria]</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>SynQuest <span class="ot">&lt;-</span> ds<span class="sc">$</span>ID <span class="sc">%in%</span> ID_SynQuest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With this criteria alone NA % would qualify as 3S</p>
<section id="consistency" class="level2">
<h2 class="anchored" data-anchor-id="consistency">5.2. Consistency</h2>
<p>see ´SynCons´</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>SynCons <span class="ot">&lt;-</span> ds<span class="sc">$</span>Consistency <span class="sc">&lt;=</span> .<span class="dv">203</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>IDSynCons<span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(SynCons)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Adding missing grouping variables: `ID`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(IDSynCons<span class="sc">$</span>SynCons)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 331</code></pre>
</div>
</div>
<p>With this criteria alone 70.8779443 % would qualify as 3S</p>
</section>
<section id="sd" class="level2">
<h2 class="anchored" data-anchor-id="sd">5.3. SD</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>IDSynSD <span class="ot">&lt;-</span> observed_consistency<span class="sc">$</span>participant[observed_consistency<span class="sc">$</span><span class="st">`</span><span class="at">x-sd</span><span class="st">`</span> <span class="sc">&gt;=</span> .<span class="dv">075</span> <span class="sc">|</span> observed_consistency<span class="sc">$</span><span class="st">`</span><span class="at">y-sd</span><span class="st">`</span> <span class="sc">&gt;=</span> .<span class="dv">075</span>]</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>SynSD<span class="ot">&lt;-</span> ds<span class="sc">$</span>ID <span class="sc">%in%</span> IDSynSD</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With this criteria alone 93.3618844 % would qualify as 3S</p>
</section>
<section id="permuted-z-score" class="level2">
<h2 class="anchored" data-anchor-id="permuted-z-score">5.4. Permuted z-score</h2>
<p>see ´SynPermzs´</p>
<p>Note this might vary due to the randomisation process involved in the permutation. Some sd are 0, leadiong to NaN in the z score. The two additional lines are to take this into account.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>ID_SynPermzs <span class="ot">&lt;-</span> <span class="fu">unique</span>(observed_consistency<span class="sc">$</span>participant[<span class="fu">abs</span>(observed_consistency<span class="sc">$</span><span class="st">`</span><span class="at">z-score</span><span class="st">`</span>) <span class="sc">&gt;=</span> <span class="dv">2</span>])</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>ID_SynPermzs <span class="ot">&lt;-</span> <span class="fu">c</span>(ID_SynPermzs,observed_consistency<span class="sc">$</span>participant[<span class="fu">is.nan</span>(observed_consistency<span class="sc">$</span><span class="st">`</span><span class="at">z-score</span><span class="st">`</span>)])</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>ID_SynPermzs <span class="ot">&lt;-</span> ID_SynPermzs[<span class="sc">!</span><span class="fu">is.na</span>(ID_SynPermzs)]</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>SynPermzs <span class="ot">&lt;-</span> ds<span class="sc">$</span>ID <span class="sc">%in%</span> ID_SynPermzs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With this criteria alone 94.6466809 % would qualify as 3S</p>
</section>
<section id="summary-plot-for-each-criteria" class="level2">
<h2 class="anchored" data-anchor-id="summary-plot-for-each-criteria">5.4. Summary plot for each criteria:</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>AllID <span class="ot">&lt;-</span> <span class="fu">unique</span>(ds<span class="sc">$</span>ID)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggalluvial)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>ID_SynCons <span class="ot">&lt;-</span> <span class="fu">unique</span>(ds <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SynCons) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(ID))</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>IDSynSD</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "1005_SeMi" "101_Elin"  "1025_MaJo" "1027_ReEd" "103_PG"    "10_AS"    
  [7] "1107_GeBe" "1178_AlCa" "1188_MiBo" "1198_LiKe" "1230_FeKe" "12_CH"    
 [13] "13_vz"     "146_ChSa"  "147_MeWi"  "148_KaHe"  "150_AnTa"  "156_LoGr" 
 [19] "157_OlJe"  "158_JuWa"  "160_ToPa"  "161_FrCo"  "1_LD"      "2002_PaKr"
 [25] "2006_MeFu" "2008_SaMa" "2009_YaAh" "2010_SoBr" "2011_CoSc" "2012_FiDo"
 [31] "2013_ChKi" "2014_DeMl" "2015_RhPo" "2016_PaPu" "2017_MaEl" "2018_KaAr"
 [37] "2019_RiDa" "201_PaMi"  "2020_FrHa" "2021_GiBo" "2022_ChPo" "2023_ChHu"
 [43] "202_NiBl"  "204_KaHo"  "205_ZiLi"  "209_LuSm"  "210_ChWa"  "214_ChKw" 
 [49] "214_LuBe"  "215_JaWi"  "217_PhKe"  "219_AlMu"  "28301"     "28307"    
 [55] "28521"     "28563"     "28740"     "28746"     "28777"     "28779"    
 [61] "28796"     "28803"     "29043"     "29048"     "29053"     "29058"    
 [67] "29063"     "29104"     "29119"     "29123"     "29128"     "29134"    
 [73] "29147"     "29151"     "29153"     "29154"     "29157"     "29166"    
 [79] "29172"     "29180"     "29189"     "29195"     "29207"     "29213"    
 [85] "29216"     "29255"     "29289"     "29291"     "29303"     "29306"    
 [91] "29320"     "29324"     "29332"     "29346"     "29352"     "29367"    
 [97] "29395"     "29400"     "29403"     "29408"     "29426"     "29434"    
[103] "29436"     "29457"     "29463"     "29485"     "29489"     "29497"    
[109] "29514"     "29526"     "29530"     "29535"     "29544"     "29548"    
[115] "29571"     "29578"     "29599"     "29704"     "29711"     "29775"    
[121] "29784"     "29818"     "29844"     "29851"     "29863"     "29864"    
[127] "29995"     "30103"     "30159"     "30259"     "30321"     "30642"    
[133] "30648"     "30650"     "30653"     "30658"     "30662"     "30679"    
[139] "30681"     "30686"     "30694"     "30721"     "30756"     "30799"    
[145] "30838"     "30883"     "30889"     "30892"     "30893"     "30900"    
[151] "30937"     "30984"     "31065"     "31076"     "31236"     "31403"    
[157] "31406"     "31795"     "31887"     "33010"     "33160"     "33168"    
[163] "33344"     "33531"     "34096"     "34433"     "34464"     "34469"    
[169] "34732"     "34757"     "35430"     "35556"     "35732"     "36062"    
[175] "36067"     "36096"     "36660"     "36820"     "36828"     "36911"    
[181] "36918"     "37578"     "38175"     "38176"     "38626"     "38637"    
[187] "38750"     "38791"     "38815"     "38822"     "38908"     "39188"    
[193] "39200"     "39208"     "39216"     "39217"     "39236"     "39237"    
[199] "39254"     "39266"     "39285"     "39381"     "39386"     "39492"    
[205] "39524"     "3_GA"      "40048"     "40867"     "410_ChAd"  "424_ToWi" 
[211] "42698"     "43416"     "44133"     "44140"     "44183"     "44293"    
[217] "44298"     "44306"     "44307"     "44308"     "44309"     "44341"    
[223] "44347"     "44351"     "44371"     "44415"     "44427"     "44453"    
[229] "44489"     "44540"     "44582"     "44588"     "44589"     "44590"    
[235] "44618"     "44627"     "44666"     "44672"     "44685"     "44695"    
[241] "44731"     "44733"     "44773"     "44784"     "44787"     "44833"    
[247] "44857"     "44871"     "44973"     "45041"     "45043"     "45047"    
[253] "45169"     "45290"     "45292"     "45299"     "45300"     "45363"    
[259] "45369"     "45376"     "45475"     "45714"     "45720"     "45727"    
[265] "45728"     "45731"     "45733"     "45734"     "45736"     "45743"    
[271] "45748"     "45759"     "45760"     "45763"     "45775"     "45776"    
[277] "45782"     "45791"     "45819"     "45829"     "45878"     "45905"    
[283] "45920"     "45948"     "46082"     "46110"     "46125"     "46126"    
[289] "46130"     "46150"     "46214"     "46264"     "46288"     "46293"    
[295] "46299"     "46308"     "46313"     "46315"     "46320"     "46363"    
[301] "46378"     "46419"     "46439"     "46473"     "46555"     "46583"    
[307] "46603"     "46604"     "46613"     "46636"     "46639"     "46693"    
[313] "46706"     "46730"     "46740"     "46742"     "46746"     "46751"    
[319] "46802"     "46811"     "46868"     "47191"     "47246"     "480_BeHe" 
[325] "48114"     "48243"     "48245"     "48249"     "482_MiSa"  "48373"    
[331] "48398"     "48522"     "48587"     "48830"     "48989"     "49011"    
[337] "49326"     "49369"     "49393"     "49395"     "49399"     "49410"    
[343] "49701"     "49733"     "4_JB"      "50392"     "52064"     "52269"    
[349] "52783"     "52960"     "53238"     "53252"     "53284"     "532_DePa" 
[355] "53343"     "53347"     "53351"     "53357"     "53381"     "53417"    
[361] "53432"     "53461"     "53494"     "53535"     "53725"     "53727"    
[367] "53730"     "53732"     "53751"     "53759"     "538_RoBr"  "55397"    
[373] "55459"     "55515"     "55774"     "56173"     "56211"     "593_FrPo" 
[379] "59738"     "59741"     "59742"     "59749"     "59750"     "59752"    
[385] "59774"     "59778"     "59780"     "59785"     "59791"     "59798"    
[391] "59803"     "59808"     "59813"     "59820"     "59830"     "59831"    
[397] "59854"     "60241"     "60242"     "60246"     "60314"     "62624"    
[403] "62777"     "62784"     "62793"     "62797"     "62807"     "62811"    
[409] "62812"     "62816"     "62848"     "62868"     "62874"     "62882"    
[415] "62886"     "62899"     "62934"     "62943"     "63028"     "63127"    
[421] "63156"     "63158"     "63170"     "63233"     "63309"     "63482"    
[427] "63695"     "63742"     "6_gks"     "755_FrIn"  "792_AnMa"  "806_AmSq" 
[433] "867_SaSe"  "887_MaEi"  "896_MaSc"  "933_ClDa" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>ID_SynPermzs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "1005_SeMi" "101_Elin"  "1025_MaJo" "1027_ReEd" "103_PG"    "10_AS"    
  [7] "1107_GeBe" "1178_AlCa" "1188_MiBo" "1198_LiKe" "1230_FeKe" "12_CH"    
 [13] "13_vz"     "146_ChSa"  "147_MeWi"  "148_KaHe"  "149_MaRo"  "150_AnTa" 
 [19] "156_LoGr"  "157_OlJe"  "158_JuWa"  "160_ToPa"  "161_FrCo"  "1_LD"     
 [25] "2002_PaKr" "2006_MeFu" "2008_SaMa" "2009_YaAh" "2010_SoBr" "2011_CoSc"
 [31] "2012_FiDo" "2013_ChKi" "2014_DeMl" "2015_RhPo" "2016_PaPu" "2017_MaEl"
 [37] "2018_KaAr" "2019_RiDa" "201_PaMi"  "2020_FrHa" "2021_GiBo" "2022_ChPo"
 [43] "2023_ChHu" "202_NiBl"  "204_KaHo"  "205_ZiLi"  "209_LuSm"  "210_ChWa" 
 [49] "214_ChKw"  "214_LuBe"  "215_JaWi"  "217_PhKe"  "219_AlMu"  "28301"    
 [55] "28307"     "28521"     "28563"     "28740"     "28746"     "28777"    
 [61] "28779"     "28796"     "28803"     "29043"     "29048"     "29053"    
 [67] "29058"     "29063"     "29104"     "29119"     "29123"     "29128"    
 [73] "29134"     "29147"     "29151"     "29153"     "29154"     "29157"    
 [79] "29166"     "29172"     "29180"     "29189"     "29195"     "29207"    
 [85] "29213"     "29216"     "29255"     "29289"     "29291"     "29303"    
 [91] "29306"     "29320"     "29324"     "29332"     "29346"     "29352"    
 [97] "29367"     "29395"     "29400"     "29403"     "29408"     "29426"    
[103] "29434"     "29436"     "29457"     "29463"     "29485"     "29489"    
[109] "29497"     "29514"     "29526"     "29530"     "29535"     "29544"    
[115] "29548"     "29571"     "29578"     "29599"     "29696"     "29704"    
[121] "29711"     "29775"     "29784"     "29818"     "29844"     "29851"    
[127] "29863"     "29864"     "29995"     "30103"     "30159"     "30259"    
[133] "30321"     "30642"     "30648"     "30650"     "30653"     "30658"    
[139] "30662"     "30679"     "30681"     "30686"     "30694"     "30721"    
[145] "30725"     "30756"     "30799"     "30838"     "30883"     "30889"    
[151] "30892"     "30893"     "30900"     "30937"     "30984"     "31065"    
[157] "31076"     "31236"     "31403"     "31406"     "31561"     "31795"    
[163] "32074"     "32633"     "33010"     "33160"     "33344"     "33531"    
[169] "34096"     "34433"     "34464"     "34469"     "34732"     "35430"    
[175] "35554"     "35992"     "36062"     "36067"     "36196"     "36828"    
[181] "37055"     "37578"     "37652"     "38175"     "38176"     "38444"    
[187] "38637"     "38750"     "38813"     "38815"     "38908"     "39188"    
[193] "39200"     "39208"     "39216"     "39217"     "39236"     "39237"    
[199] "39254"     "39266"     "39285"     "39381"     "39386"     "39492"    
[205] "39524"     "3_GA"      "40048"     "40867"     "410_ChAd"  "424_ToWi" 
[211] "42698"     "43416"     "44133"     "44140"     "44183"     "44293"    
[217] "44296"     "44298"     "44306"     "44307"     "44308"     "44309"    
[223] "44340"     "44341"     "44347"     "44351"     "44371"     "44427"    
[229] "44489"     "44540"     "44582"     "44588"     "44589"     "44590"    
[235] "44618"     "44627"     "44666"     "44672"     "44685"     "44695"    
[241] "44731"     "44733"     "44773"     "44784"     "44787"     "44833"    
[247] "44857"     "44871"     "44956"     "44973"     "45041"     "45043"    
[253] "45047"     "45169"     "45280"     "45290"     "45292"     "45299"    
[259] "45300"     "45369"     "45376"     "45475"     "45714"     "45720"    
[265] "45727"     "45728"     "45731"     "45733"     "45734"     "45736"    
[271] "45743"     "45748"     "45759"     "45760"     "45763"     "45775"    
[277] "45776"     "45782"     "45791"     "45819"     "45829"     "45878"    
[283] "45905"     "45920"     "45948"     "46110"     "46125"     "46126"    
[289] "46150"     "46214"     "46264"     "46288"     "46293"     "46297"    
[295] "46299"     "46308"     "46313"     "46315"     "46320"     "46358"    
[301] "46378"     "46419"     "46439"     "46473"     "46480"     "46555"    
[307] "46583"     "46603"     "46604"     "46613"     "46636"     "46639"    
[313] "46693"     "46706"     "46730"     "46740"     "46742"     "46746"    
[319] "46751"     "46802"     "46811"     "46868"     "47191"     "47246"    
[325] "480_BeHe"  "48114"     "48243"     "48245"     "48249"     "482_MiSa" 
[331] "48373"     "48398"     "48522"     "48587"     "48830"     "48989"    
[337] "49011"     "49369"     "49393"     "49395"     "49399"     "49410"    
[343] "49547"     "49701"     "49733"     "4_JB"      "50392"     "52064"    
[349] "52269"     "52783"     "52960"     "53238"     "53284"     "532_DePa" 
[355] "53343"     "53347"     "53351"     "53357"     "53381"     "53417"    
[361] "53432"     "53461"     "53494"     "53535"     "53725"     "53727"    
[367] "53730"     "53732"     "53751"     "53759"     "538_RoBr"  "55397"    
[373] "55459"     "55515"     "55774"     "56173"     "593_FrPo"  "59738"    
[379] "59741"     "59742"     "59749"     "59750"     "59752"     "59774"    
[385] "59778"     "59780"     "59785"     "59791"     "59798"     "59803"    
[391] "59808"     "59813"     "59820"     "59830"     "59831"     "59854"    
[397] "60241"     "60242"     "60246"     "60314"     "62624"     "62777"    
[403] "62784"     "62793"     "62797"     "62807"     "62811"     "62812"    
[409] "62816"     "62848"     "62868"     "62874"     "62882"     "62886"    
[415] "62899"     "62934"     "62943"     "63028"     "63127"     "63156"    
[421] "63158"     "63170"     "63233"     "63309"     "63482"     "63695"    
[427] "63742"     "6_gks"     "755_FrIn"  "792_AnMa"  "806_AmSq"  "867_SaSe" 
[433] "887_MaEi"  "896_MaSc"  "933_ClDa"  "34405"     "36795"     "37643"    
[439] "37928"     "38181"     "39032"     "44141"    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>ID_Synline <span class="ot">&lt;-</span> <span class="fu">unique</span>(ds <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SynLine) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(ID))</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> AllID,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">C_Quest =</span> AllID <span class="sc">%in%</span> ID_SynQuest,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">C_Cons =</span> AllID <span class="sc">%in%</span> ID_SynCons,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">C_SD =</span> AllID <span class="sc">%in%</span> IDSynSD,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">C_permzs =</span> AllID <span class="sc">%in%</span> ID_SynPermzs,</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">C_linecross =</span> AllID <span class="sc">%in%</span> ID_Synline</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"C"</span>), <span class="at">names_to =</span> <span class="st">"Stage"</span>, <span class="at">values_to =</span> <span class="st">"Passed"</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_long,</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Stage, <span class="at">stratum =</span> Passed, <span class="at">alluvium =</span> ID,</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> Passed, <span class="at">label =</span> Passed)) <span class="sc">+</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_flow</span>(<span class="at">stat =</span> <span class="st">"alluvium"</span>, <span class="at">lode.guidance =</span> <span class="st">"frontback"</span>) <span class="sc">+</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_stratum</span>() <span class="sc">+</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Dropout by Criteria"</span>, <span class="at">y =</span> <span class="st">"Number of IDs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plot-desities" class="level2">
<h2 class="anchored" data-anchor-id="plot-desities">5.5 Plot desities</h2>
<p>This plot exites me the most, indicates that those who self report synesthesia seem to have less line crossings than non synesthetes. Also indicates that most do not have line crossings.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ds, <span class="fu">aes</span>(<span class="at">x =</span> GA_lineInter, <span class="at">group =</span> SynQuest, <span class="at">fill =</span> SynQuest)) <span class="sc">+</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Eventually export:</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(observed_consistency, <span class="at">file =</span> <span class="st">"ExportedCsv/observed_consistency.csv"</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(ds <span class="sc">%&gt;%</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(<span class="fu">row_number</span>()<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">select</span>(ID,group, triangle_area, Consistency,GA_lineInter,SynQuest,SynCons,SynSD,SynPermzs, SynLine),<span class="at">file =</span> <span class="st">"ExportedCsv/SynCat.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="section" class="level1">
<h1></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>ds <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SynQuest) <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="fu">median</span>(Consistency),<span class="fu">sd</span>(Consistency)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  SynQuest `median(Consistency)` `sd(Consistency)`
  &lt;lgl&gt;                    &lt;dbl&gt;             &lt;dbl&gt;
1 FALSE                   0.0966             0.755
2 TRUE                    0.102              0.338</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>ds <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SynQuest) <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="fu">median</span>(GA_lineInter),<span class="fu">sd</span>(GA_lineInter)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  SynQuest `median(GA_lineInter)` `sd(GA_lineInter)`
  &lt;lgl&gt;                     &lt;dbl&gt;              &lt;dbl&gt;
1 FALSE                     3.02                5.53
2 TRUE                      0.320               3.25</code></pre>
</div>
</div>
</section>
<section id="figure-mega-plot" class="level1">
<h1>6.Figure Mega plot</h1>
<p>This exports many pdf’s. It plots each ID and condition z-score x and y coordinates. Since each coordinate is repeated 3 times, these are represented by triangles. The line paths connect average coordinates to visualize forms (stimulus are ordered, i.e.&nbsp;1 to 9, monday to sunday, january to december). Finally in the top right corner, each dots indicates if the ID would pass / fails depending on the criteria:</p>
<ul>
<li>Questionnaire <code>SynQuest</code></li>
<li>Consistency <code>SynCons</code></li>
<li>SD <code>SynSD</code></li>
<li>Permuted z-score <code>SynPermzs</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple pages</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the number of rows &amp; columns per pages</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>N_rows <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>N_cols <span class="ot">=</span> <span class="dv">9</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">round</span>(<span class="fu">length</span>(IDlist)<span class="sc">/</span>(N_rows<span class="sc">*</span>N_cols)<span class="sc">*</span><span class="dv">3</span>)<span class="sc">+</span><span class="dv">1</span>)){</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a> gp1 <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># filter(ID  %in% c(28779,29027,29043)) %&gt;%</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">ordered</span>(stimulus, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Monday"</span>, <span class="st">"Tuesday"</span>, <span class="st">"Wednesday"</span>, <span class="st">"Thursday"</span>, <span class="st">"Friday"</span>,<span class="st">"Saturday"</span>,<span class="st">"Sunday"</span>))) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">ordered</span>(stimulus, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"January"</span>, <span class="st">"February"</span>, <span class="st">"March"</span>, <span class="st">"April"</span>, <span class="st">"May"</span>,<span class="st">"June"</span>,<span class="st">"July"</span>,<span class="st">"August"</span>,<span class="st">"September"</span>,<span class="st">"October"</span>,<span class="st">"November"</span>,<span class="st">"December"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_zs, <span class="at">y =</span> y_zs, <span class="at">group =</span> stimulus, <span class="at">label =</span> stimulus, <span class="at">fill =</span> stimulus)) <span class="sc">+</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="fl">4.5</span>, <span class="at">label =</span> dataSource), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">3.7</span>, <span class="at">y =</span> <span class="fl">5.5</span>, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Criteria:  Ques   Cons  SD    Pzs     Line"</span>)), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">color =</span>SynQuest), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span> <span class="sc">-</span><span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">color =</span>SynCons), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span> <span class="sc">-</span><span class="fl">1.</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">color =</span>SynSD), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">color =</span>SynPermzs), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span> <span class="sc">+</span> <span class="fl">0.2</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">color =</span>SynLine), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># SynLine is developed later in the code.</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_polygon</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> X_mean_zs<span class="fl">+0.1</span>, <span class="at">y =</span> Y_mean_zs<span class="fl">+0.1</span>), <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">x =</span> X_mean_zs, <span class="at">y =</span> Y_mean_zs, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_zs, <span class="at">y =</span> y_zs, <span class="at">group =</span> repetition), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_zs<span class="fl">+0.1</span>, <span class="at">y =</span> y_zs<span class="fl">+0.1</span>), <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap_paginate</span>( <span class="sc">~</span> ID<span class="sc">+</span> Cond, <span class="at">ncol =</span> N_cols, <span class="at">nrow =</span> N_rows, <span class="at">page =</span> i)  <span class="sc">+</span></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a> gp1</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ggsave(paste0("Figures/Syn_Categories",i,".pdf"),width = N_cols*2, height = N_rows*2)</span></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="id-issues" class="level2">
<h2 class="anchored" data-anchor-id="id-issues">6.1. ID issues:</h2>
<p>Maybe could automatize by pulling the inconsistent but with few line crossings.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>InconsbutLine_ID <span class="ot">&lt;-</span> <span class="fu">unique</span>(ds<span class="sc">$</span>ID[<span class="sc">!</span>ds<span class="sc">$</span>SynCons <span class="sc">&amp;</span> ds<span class="sc">$</span>SynLine])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="inconsitent-ids-that-pass-line-criteria" class="level3">
<h3 class="anchored" data-anchor-id="inconsitent-ids-that-pass-line-criteria">6.1.1 Inconsitent ID’s that pass line criteria:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>IDnr <span class="ot">=</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>ds <span class="sc">%&gt;%</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(ID <span class="sc">%in%</span> InconsbutLine_ID[IDnr]) <span class="sc">%&gt;%</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">ordered</span>(stimulus, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Monday"</span>, <span class="st">"Tuesday"</span>, <span class="st">"Wednesday"</span>, <span class="st">"Thursday"</span>, <span class="st">"Friday"</span>,<span class="st">"Saturday"</span>,<span class="st">"Sunday"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">ordered</span>(stimulus, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"January"</span>, <span class="st">"February"</span>, <span class="st">"March"</span>, <span class="st">"April"</span>, <span class="st">"May"</span>,<span class="st">"June"</span>,<span class="st">"July"</span>,<span class="st">"August"</span>,<span class="st">"September"</span>,<span class="st">"October"</span>,<span class="st">"November"</span>,<span class="st">"December"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_zs, <span class="at">y =</span> y_zs, <span class="at">group =</span> stimulus, <span class="at">label =</span> stimulus, <span class="at">fill =</span> stimulus)) <span class="sc">+</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="fl">4.5</span>, <span class="at">label =</span> dataSource), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">3.7</span>, <span class="at">y =</span> <span class="fl">5.5</span>, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Criteria:  Ques   Cons  SD    Pzs     Line"</span>)), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">color =</span>SynQuest), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span> <span class="sc">-</span><span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">color =</span>SynCons), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span> <span class="sc">-</span><span class="fl">1.</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">color =</span>SynSD), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">color =</span>SynPermzs), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span> <span class="sc">+</span> <span class="fl">0.2</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">color =</span>SynLine), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># SynLine is developed later in the code.</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_polygon</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> X_mean_zs<span class="fl">+0.1</span>, <span class="at">y =</span> Y_mean_zs<span class="fl">+0.1</span>), <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">x =</span> X_mean_zs, <span class="at">y =</span> Y_mean_zs, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_zs, <span class="at">y =</span> y_zs, <span class="at">group =</span> repetition), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_zs<span class="fl">+0.1</span>, <span class="at">y =</span> y_zs<span class="fl">+0.1</span>), <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>( <span class="sc">~</span> ID<span class="sc">+</span> Cond)  <span class="sc">+</span></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>ds <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(ID <span class="sc">%in%</span> InconsbutLine_ID[IDnr]) <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Cond, repetition) <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">row_number</span>()<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(triangle_area,nLineCross,GA_lineInter)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Adding missing grouping variables: `Cond`, `repetition`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 5
# Groups:   Cond, repetition [9]
  Cond    repetition triangle_area nLineCross GA_lineInter
  &lt;chr&gt;        &lt;int&gt;         &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;
1 month            1           20           0        0.246
2 month            2           20           0        0.246
3 month            3           20           0        0.246
4 weekday          1         1472.          0        0.246
5 weekday          2         1472.          2        0.246
6 weekday          3         1472.          0        0.246
7 number           1         1385           0        0.246
8 number           2         1385           0        0.246
9 number           3         1385           1        0.246</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ds %&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(ID %in% InconsbutLine_ID[30:40]) %&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(stimulus) %&gt;%</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   arrange(stimulus) %&gt;%</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   arrange(ordered(stimulus, levels = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday","Saturday","Sunday"))) %&gt;% arrange(ordered(stimulus, levels = c("January", "February", "March", "April", "May","June","July","August","September","October","November","December"))) %&gt;%</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = x_zs, y = y_zs, group = stimulus, label = stimulus, fill = stimulus)) +</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(x = 5 -2, y = 5, color =SynQuest), size = 0.5) + </span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(x = 5 -1.5, y = 5, color =SynCons), size = 0.5) + </span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(x = 5 -1., y = 5, color =SynSD), size = 0.5) +</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(x = 5 -0.5, y = 5, color =SynPermzs), size = 0.5) +</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(x = 5 + 0.2, y = 5, color =SynLine), size = 0.5) + # SynLine is developed later in the code.</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_polygon(alpha = 0.4) +</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_text(aes(x = X_mean_zs+0.1, y = Y_mean_zs+0.1), colour = "black", size = 0.5) +</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_path(aes(x = X_mean_zs, y = Y_mean_zs, group = 1)) +</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_wrap(ID ~ Cond)  +</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostic tables and figures per ID:</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>ID_here <span class="ot">&lt;-</span> InconsbutLine_ID[<span class="dv">5</span>]</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>ds <span class="sc">%&gt;%</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(ID <span class="sc">%in%</span> ID_here) <span class="sc">%&gt;%</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">ordered</span>(stimulus, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Monday"</span>, <span class="st">"Tuesday"</span>, <span class="st">"Wednesday"</span>, <span class="st">"Thursday"</span>, <span class="st">"Friday"</span>,<span class="st">"Saturday"</span>,<span class="st">"Sunday"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">ordered</span>(stimulus, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"January"</span>, <span class="st">"February"</span>, <span class="st">"March"</span>, <span class="st">"April"</span>, <span class="st">"May"</span>,<span class="st">"June"</span>,<span class="st">"July"</span>,<span class="st">"August"</span>,<span class="st">"September"</span>,<span class="st">"October"</span>,<span class="st">"November"</span>,<span class="st">"December"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_zs, <span class="at">y =</span> y_zs, <span class="at">group =</span> stimulus, <span class="at">label =</span> stimulus, <span class="at">fill =</span> stimulus)) <span class="sc">+</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">color =</span>SynQuest), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span> <span class="sc">-</span><span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">color =</span>SynCons), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span> <span class="sc">-</span><span class="fl">1.</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">color =</span>SynSD), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">color =</span>SynPermzs), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span> <span class="sc">+</span> <span class="fl">0.2</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">color =</span>SynLine), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># SynLine is developed later in the code.</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_polygon</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> X_mean_zs<span class="fl">+0.1</span>, <span class="at">y =</span> Y_mean_zs<span class="fl">+0.1</span>), <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">x =</span> X_mean_zs, <span class="at">y =</span> Y_mean_zs, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>( <span class="sc">~</span> ID<span class="sc">+</span> Cond <span class="sc">+</span> repetition)  <span class="sc">+</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Criteriums:</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>ds <span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ID <span class="sc">%in%</span> ID_here) <span class="sc">%&gt;%</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>()<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Consistency,GA_lineInter)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Adding missing grouping variables: `ID`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
# Groups:   ID [1]
  ID    Consistency GA_lineInter
  &lt;chr&gt;       &lt;dbl&gt;        &lt;dbl&gt;
1 45776       0.367        0.176</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Per condition:</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>ds <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(ID <span class="sc">%in%</span> ID_here) <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Cond) <span class="sc">%&gt;%</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">row_number</span>()<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(triangle_area,nLineCross)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Adding missing grouping variables: `Cond`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
# Groups:   Cond [3]
  Cond    triangle_area nLineCross
  &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt;
1 month           765            1
2 weekday           0.5          0
3 number          767            0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Response level</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>ds <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(ID  <span class="sc">%in%</span> ID_here) <span class="sc">%&gt;%</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Cond) <span class="sc">%&gt;%</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">Mx =</span> <span class="fu">mean</span>(x_zs), <span class="at">My =</span> <span class="fu">mean</span>(y_zs), <span class="at">nStim =</span><span class="fu">length</span>(stimulus)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  Cond          Mx        My nStim
  &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt; &lt;int&gt;
1 month   1.23e-17 -4.93e-17    36
2 number  1.48e-16  8.33e-17    30
3 weekday 6.34e-17  2.22e-15    21</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>ds <span class="sc">%&gt;%</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(ID  <span class="sc">%in%</span> ID_here) <span class="sc">%&gt;%</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Cond) <span class="sc">%&gt;%</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">Mx =</span> <span class="fu">mean</span>(x), <span class="at">My =</span> <span class="fu">mean</span>(y), <span class="at">SDx =</span> <span class="fu">sd</span>(x), <span class="at">SDy =</span> <span class="fu">sd</span>(y), <span class="at">nStim =</span><span class="fu">length</span>(stimulus))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 6
  Cond       Mx    My   SDx   SDy nStim
  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
1 month    830.  512.  612. 335.     36
2 number   830.  487.  575. 102.     30
3 weekday 1019.  520.  652.  19.2    21</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Most detailed possible, stimulus level:</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>ds <span class="sc">%&gt;%</span> </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(ID  <span class="sc">%in%</span> ID_here) <span class="sc">%&gt;%</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Cond, stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">Mx =</span> <span class="fu">mean</span>(x), <span class="at">My =</span> <span class="fu">mean</span>(y), <span class="at">SDx =</span> <span class="fu">sd</span>(x), <span class="at">SDy =</span> <span class="fu">sd</span>(y), <span class="at">nStim =</span><span class="fu">length</span>(stimulus)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Cond'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 29 × 7
# Groups:   Cond [3]
   Cond  stimulus    Mx     My   SDx    SDy nStim
   &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;
 1 month April     300.  379   232.  126.       3
 2 month August    662   579.  466.   34.0      3
 3 month December 1844. 1001.   10.7   9.02     3
 4 month February  698.   87   311.   20.1      3
 5 month January   104.   94    79.1 102.       3
 6 month July      325.  529.  314.   22.7      3
 7 month June     1052.  431.  584.  124.       3
 8 month March    1377    88.3 590.   37.1      3
 9 month May       700.  364   391.   59.0      3
10 month November 1084. 1000.  157.   20.2      3
# ℹ 19 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Hardware level:</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>ds <span class="sc">%&gt;%</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(ID  <span class="sc">%in%</span> ID_here) <span class="sc">%&gt;%</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Cond) <span class="sc">%&gt;%</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">Mwidth =</span> <span class="fu">mean</span>(width), <span class="at">Mheight =</span> <span class="fu">mean</span>(height)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  Cond    Mwidth Mheight
  &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;
1 month     1920    1057
2 number    1920    1057
3 weekday   1920    1057</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Illustrations</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply per group</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>ds <span class="sc">%&gt;%</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ID  <span class="sc">%in%</span> ID_here) <span class="sc">%&gt;%</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">triangle_area =</span> <span class="fu">triangle_area</span>(x, y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 38
# Groups:   ID, stimulus [29]
   stimulus     x     y width height group ID    dataSource trial_index trial_id
   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;            &lt;dbl&gt;    &lt;dbl&gt;
 1 January     56    38  1920   1057 Syn   45776 Ward                76  1426066
 2 January     60    32  1920   1057 Syn   45776 Ward                48  1426038
 3 January    195   212  1920   1057 Syn   45776 Ward                20  1425987
 4 February   353   110  1920   1057 Syn   45776 Ward                 4  1425960
 5 February   783    73  1920   1057 Syn   45776 Ward                43  1426032
 6 February   957    78  1920   1057 Syn   45776 Ward                71  1426061
 7 March      696   124  1920   1057 Syn   45776 Ward                 5  1425961
 8 March     1710    50  1920   1057 Syn   45776 Ward                69  1426059
 9 March     1725    91  1920   1057 Syn   45776 Ward                30  1426006
10 April      151   292  1920   1057 Syn   45776 Ward                34  1426014
# ℹ 77 more rows
# ℹ 28 more variables: session_id &lt;dbl&gt;, rt &lt;dbl&gt;, Cond &lt;chr&gt;, Nrep &lt;int&gt;,
#   repetition &lt;int&gt;, X_mean &lt;dbl&gt;, Y_mean &lt;dbl&gt;, x_zs &lt;dbl[,1]&gt;,
#   y_zs &lt;dbl[,1]&gt;, X_mean_zs &lt;dbl&gt;, Y_mean_zs &lt;dbl&gt;, triangle_area &lt;dbl&gt;,
#   Screen_area &lt;dbl&gt;, Consistency &lt;dbl&gt;, xSc &lt;dbl&gt;, ySc &lt;dbl&gt;, SD_IDx &lt;dbl&gt;,
#   SD_IDy &lt;dbl&gt;, nSegments &lt;dbl&gt;, nLineCross &lt;dbl&gt;, meanLineCross &lt;dbl&gt;,
#   GA_lineInter &lt;dbl&gt;, mean_lineInter &lt;dbl&gt;, SynLine &lt;lgl&gt;, SynQuest &lt;lgl&gt;, …</code></pre>
</div>
</div>
</section>
<section id="not-pass-sd-ids-that-pass-line-criteria" class="level3">
<h3 class="anchored" data-anchor-id="not-pass-sd-ids-that-pass-line-criteria">6.1.1 Not pass SD ID’s that pass line criteria:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>NoSDbutLine_ID <span class="ot">&lt;-</span> <span class="fu">unique</span>(ds<span class="sc">$</span>ID[<span class="sc">!</span>ds<span class="sc">$</span>SynSD <span class="sc">&amp;</span> ds<span class="sc">$</span>SynLine])</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Only 1 ID!</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>NopermbutLine_ID <span class="ot">&lt;-</span> <span class="fu">unique</span>(ds<span class="sc">$</span>ID[<span class="sc">!</span>ds<span class="sc">$</span>SynPermzs <span class="sc">&amp;</span> ds<span class="sc">$</span>SynLine])</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># No one!</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>NoLinebutCons <span class="ot">&lt;-</span> <span class="fu">unique</span>(ds<span class="sc">$</span>ID[<span class="sc">!</span>ds<span class="sc">$</span>SynLine <span class="sc">&amp;</span> ds<span class="sc">$</span>SynCons])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>ds <span class="sc">%&gt;%</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ID <span class="sc">%in%</span> NoLinebutCons[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">ordered</span>(stimulus, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Monday"</span>, <span class="st">"Tuesday"</span>, <span class="st">"Wednesday"</span>, <span class="st">"Thursday"</span>, <span class="st">"Friday"</span>,<span class="st">"Saturday"</span>,<span class="st">"Sunday"</span>))) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">ordered</span>(stimulus, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"January"</span>, <span class="st">"February"</span>, <span class="st">"March"</span>, <span class="st">"April"</span>, <span class="st">"May"</span>,<span class="st">"June"</span>,<span class="st">"July"</span>,<span class="st">"August"</span>,<span class="st">"September"</span>,<span class="st">"October"</span>,<span class="st">"November"</span>,<span class="st">"December"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_zs, <span class="at">y =</span> y_zs, <span class="at">group =</span> stimulus, <span class="at">label =</span> stimulus, <span class="at">fill =</span> stimulus)) <span class="sc">+</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">color =</span>SynQuest), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span> <span class="sc">-</span><span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">color =</span>SynCons), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span> <span class="sc">-</span><span class="fl">1.</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">color =</span>SynSD), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">color =</span>SynPermzs), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span> <span class="sc">+</span> <span class="fl">0.2</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">color =</span>SynLine), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># SynLine is developed later in the code.</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> X_mean_zs<span class="fl">+0.1</span>, <span class="at">y =</span> Y_mean_zs<span class="fl">+0.1</span>), <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">x =</span> X_mean_zs, <span class="at">y =</span> Y_mean_zs, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(ID <span class="sc">~</span> Cond)  <span class="sc">+</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="fig-distributions" class="level1">
<h1>7. Fig Distributions</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>ds <span class="sc">%&gt;%</span> </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dataSource <span class="sc">==</span> <span class="st">"Ward"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Consistency, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">group =</span> SynQuest, <span class="at">fill =</span> SynQuest)) <span class="sc">+</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density_ridges</span>(<span class="at">quantile_lines =</span> <span class="cn">TRUE</span>,<span class="at">quantiles =</span> <span class="fl">0.5</span>,<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>Cond) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.0331</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.0343</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.0369</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Cond,repetition) <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nSegments =</span> <span class="fu">length</span>(stimulus)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of crossings per condition and repetition</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">ordered</span>(stimulus, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Monday"</span>, <span class="st">"Tuesday"</span>, <span class="st">"Wednesday"</span>, <span class="st">"Thursday"</span>, <span class="st">"Friday"</span>,<span class="st">"Saturday"</span>,<span class="st">"Sunday"</span>))) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">ordered</span>(stimulus, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"January"</span>, <span class="st">"February"</span>, <span class="st">"March"</span>, <span class="st">"April"</span>, <span class="st">"May"</span>,<span class="st">"June"</span>,<span class="st">"July"</span>,<span class="st">"August"</span>,<span class="st">"September"</span>,<span class="st">"October"</span>,<span class="st">"November"</span>,<span class="st">"December"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Cond,repetition) <span class="sc">%&gt;%</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(ID, Cond) %&gt;% # This should ignore the repetitions. So it should become a very long line including all repetitions, which might catch some consistency.</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nLineCross =</span> (<span class="fu">count_self_intersections</span>(x,y, <span class="at">verbose =</span> <span class="cn">FALSE</span>)))</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Cond) <span class="sc">%&gt;%</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">meanLineCross =</span> nLineCross<span class="sc">/</span>(<span class="dv">3</span><span class="sc">*</span>nSegments))</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Average per ID, use the number of segment rather than the number of stimuli</span></span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GA_lineInter =</span> <span class="fu">mean</span>(meanLineCross))</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>ds <span class="sc">%&gt;%</span> </span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(dataSource <span class="sc">==</span> <span class="st">"Ward"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GA_lineInter, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">group =</span> SynQuest, <span class="at">fill =</span> SynQuest)) <span class="sc">+</span></span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_density_ridges</span>(<span class="at">quantile_lines =</span> <span class="cn">TRUE</span>,<span class="at">quantiles =</span> <span class="fl">0.5</span>,<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="sc">~</span>Cond) <span class="sc">+</span></span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.0304</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.0315</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.0338</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3567 rows containing non-finite outside the scale range
(`stat_density_ridges()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="laboratory-or-sandkiste" class="level3">
<h3 class="anchored" data-anchor-id="laboratory-or-sandkiste">Laboratory or Sandkiste</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Cond,repetition) <span class="sc">%&gt;%</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nSegments =</span> <span class="fu">length</span>(stimulus)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of intersections for each ID X Cond X repetition</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">ordered</span>(stimulus, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Monday"</span>, <span class="st">"Tuesday"</span>, <span class="st">"Wednesday"</span>, <span class="st">"Thursday"</span>, <span class="st">"Friday"</span>,<span class="st">"Saturday"</span>,<span class="st">"Sunday"</span>))) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">ordered</span>(stimulus, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"January"</span>, <span class="st">"February"</span>, <span class="st">"March"</span>, <span class="st">"April"</span>, <span class="st">"May"</span>,<span class="st">"June"</span>,<span class="st">"July"</span>,<span class="st">"August"</span>,<span class="st">"September"</span>,<span class="st">"October"</span>,<span class="st">"November"</span>,<span class="st">"December"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Cond,repetition) <span class="sc">%&gt;%</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nLineCross =</span> (<span class="fu">count_self_intersections</span>(x,y, <span class="at">verbose =</span> <span class="cn">FALSE</span>)))</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>ds <span class="sc">%&gt;%</span> </span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(dataSource <span class="sc">==</span> <span class="st">"Ward"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> nLineCross, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">group =</span> SynQuest, <span class="at">fill =</span> SynQuest,<span class="at">colour =</span> SynQuest)) <span class="sc">+</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_density_ridges</span>(<span class="at">quantile_lines =</span> <span class="cn">TRUE</span>,<span class="at">quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span>),<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="sc">~</span>Cond) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 1.46</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.954</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.412</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear transformation: chances for each segment to intersect:</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Cond,repetition) <span class="sc">%&gt;%</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_lineInter =</span> nLineCross<span class="sc">/</span>nSegments)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Average per ID</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GA_lineInter =</span> <span class="fu">mean</span>(meanLineCross))</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot</span></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>ds <span class="sc">%&gt;%</span> </span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(dataSource <span class="sc">==</span> <span class="st">"Ward"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean_lineInter, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">group =</span> SynQuest, <span class="at">fill =</span> SynQuest,<span class="at">colour =</span> SynQuest)) <span class="sc">+</span></span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_density_ridges</span>(<span class="at">quantile_lines =</span> <span class="cn">TRUE</span>,<span class="at">quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span>),<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="sc">~</span>Cond) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.133</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.106</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.0686</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-39-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>ds <span class="sc">%&gt;%</span> </span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(dataSource <span class="sc">==</span> <span class="st">"Ward"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GA_lineInter, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">group =</span> SynQuest, <span class="at">fill =</span> SynQuest,<span class="at">colour =</span> SynQuest)) <span class="sc">+</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_density_ridges</span>(<span class="at">quantile_lines =</span> <span class="cn">TRUE</span>,<span class="at">quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span>),<span class="at">alpha =</span> <span class="fl">0.5</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.0285</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-39-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>SynLine <span class="ot">&lt;-</span> ds<span class="sc">$</span>GA_lineInter <span class="sc">&lt;=</span> <span class="fl">0.25</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="cohens-kconsistency-specificity-and-accuracy" class="level1">
<h1>7. Cohen’s k,consistency, Specificity and Accuracy</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install if needed</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(irr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lpSolve</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>Diagnoses <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, SynQuest, SynCons, SynPermzs, SynLine,dataSource)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Line categorizes significantly differently from Consistency:</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kappa2</span>(Diagnoses[,<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>)])  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Cohen's Kappa for 2 Raters (Weights: unweighted)

 Subjects = 467 
   Raters = 2 
    Kappa = -0.0979 

        z = -2.12 
  p-value = 0.0342 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Line categorizes significantly different than Questionnaire</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>Diagnoses_Ward <span class="ot">=</span> Diagnoses <span class="sc">%&gt;%</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dataSource <span class="sc">==</span> <span class="st">"Ward"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, SynQuest, SynCons, SynLine, SynPermzs, SynLine,dataSource)</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kappa2</span>(Diagnoses_Ward[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">weight =</span> <span class="st">"unweighted"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Cohen's Kappa for 2 Raters (Weights: unweighted)

 Subjects = 467 
   Raters = 2 
    Kappa = 0.187 

        z = 4.35 
  p-value = 1.34e-05 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Overall does not change (but doubt about this):</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: Missing data are omitted in a listwise way.</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="co"># THM: significant difference might depend on calculation used:</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kappam.light</span>(Diagnoses[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>])  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Light's Kappa for m Raters

 Subjects = 467 
   Raters = 4 
    Kappa = 0.244 

        z = 1.06 
  p-value = 0.288 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kappam.fleiss</span>(Diagnoses[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Fleiss' Kappa for m Raters

 Subjects = 467 
   Raters = 4 
    Kappa = 0.233 

        z = 12.3 
  p-value = 0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kappam.fleiss</span>(Diagnoses[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>], <span class="at">exact=</span><span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Fleiss' Kappa for m Raters (exact value)

 Subjects = 467 
   Raters = 4 
    Kappa = 0.245 </code></pre>
</div>
</div>
<section id="consistency-1" class="level2">
<h2 class="anchored" data-anchor-id="consistency-1">7.1. Consistency</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>criterion1 <span class="ot">=</span> <span class="fu">as.logical</span>(Diagnoses_Ward<span class="sc">$</span>SynQuest)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>criterion2 <span class="ot">=</span> <span class="fu">as.logical</span>(Diagnoses_Ward<span class="sc">$</span>SynCons)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Accuracy</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">sum</span>(criterion1 <span class="sc">==</span> criterion2) <span class="sc">/</span> <span class="fu">length</span>(criterion1)</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Sensitivity: how well criterion1 detects positive cases in criterion2</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>true_positives <span class="ot">&lt;-</span> <span class="fu">sum</span>(criterion1 <span class="sc">&amp;</span> criterion2)</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>actual_positives <span class="ot">&lt;-</span> <span class="fu">sum</span>(criterion2)</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>sensitivity <span class="ot">&lt;-</span> true_positives <span class="sc">/</span> actual_positives</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Consistency: Percent agreement (could also compute Cohen’s kappa)</span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>percent_agreement <span class="ot">&lt;-</span> <span class="fu">mean</span>(criterion1 <span class="sc">==</span> criterion2)</span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Output</span></span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Accuracy:    %.2f</span><span class="sc">\n</span><span class="st">"</span>, accuracy))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy:    0.60</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Sensitivity: %.2f</span><span class="sc">\n</span><span class="st">"</span>, sensitivity))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sensitivity: 0.59</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Agreement:   %.2f</span><span class="sc">\n</span><span class="st">"</span>, percent_agreement))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Agreement:   0.60</code></pre>
</div>
</div>
</section>
<section id="line-intersection" class="level2">
<h2 class="anchored" data-anchor-id="line-intersection">7.2. Line Intersection:</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>  criterion1 <span class="ot">=</span> <span class="fu">as.logical</span>(Diagnoses_Ward<span class="sc">$</span>SynQuest)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  criterion2 <span class="ot">=</span> <span class="fu">as.logical</span>(Diagnoses_Ward<span class="sc">$</span>SynLine)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Accuracy</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>  accuracy <span class="ot">&lt;-</span> <span class="fu">sum</span>(criterion1 <span class="sc">==</span> criterion2) <span class="sc">/</span> <span class="fu">length</span>(criterion1)</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sensitivity: how well criterion1 detects positive cases in criterion2</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>  true_positives <span class="ot">&lt;-</span> <span class="fu">sum</span>(criterion1 <span class="sc">&amp;</span> criterion2)</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>  actual_positives <span class="ot">&lt;-</span> <span class="fu">sum</span>(criterion2)</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>  sensitivity <span class="ot">&lt;-</span> true_positives <span class="sc">/</span> actual_positives</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Consistency: Percent agreement (could also compute Cohen’s kappa)</span></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>  percent_agreement <span class="ot">&lt;-</span> <span class="fu">mean</span>(criterion1 <span class="sc">==</span> criterion2)</span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Output</span></span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Accuracy:    %.2f</span><span class="sc">\n</span><span class="st">"</span>, accuracy))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy:    0.71</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Sensitivity: %.2f</span><span class="sc">\n</span><span class="st">"</span>, sensitivity))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sensitivity: 0.66</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Agreement:   %.2f</span><span class="sc">\n</span><span class="st">"</span>, percent_agreement))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Agreement:   0.71</code></pre>
</div>
</div>
<section id="tried-to-do-it-with-different-questionnaires-cutoffs" class="level3">
<h3 class="anchored" data-anchor-id="tried-to-do-it-with-different-questionnaires-cutoffs">7.2.3. Tried to do it with different questionnaires cutoffs</h3>
</section>
</section>
</section>
<section id="consistency-2" class="level1">
<h1>Consistency</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ds_Q<span class="sc">$</span><span class="st">`</span><span class="at">questionnaire score</span><span class="st">`</span>,<span class="dv">45</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">9</span><span class="sc">:</span><span class="dv">45</span>){</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  ds_Q<span class="sc">$</span>QuestCriteria <span class="ot">&lt;-</span> ds_Q<span class="sc">$</span><span class="st">`</span><span class="at">questionnaire score</span><span class="st">`</span> <span class="sc">&lt;=</span> i</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(ds_Q<span class="sc">$</span>QuestCriteria)<span class="sc">/</span><span class="fu">length</span>(ds_Q<span class="sc">$</span>QuestCriteria)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  ID_SynQuest <span class="ot">&lt;-</span> ds_Q<span class="sc">$</span>ID[ds_Q<span class="sc">$</span>QuestCriteria]</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  ds<span class="sc">$</span>SynQuest <span class="ot">&lt;-</span> ds<span class="sc">$</span>ID <span class="sc">%in%</span> ID_SynQuest</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>  gp1 <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(dataSource <span class="sc">==</span> <span class="st">"Ward"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Consistency, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">group =</span> SynQuest, <span class="at">fill =</span> SynQuest,<span class="at">colour =</span> SynQuest)) <span class="sc">+</span></span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stat_density_ridges</span>(<span class="at">quantile_lines =</span> <span class="cn">TRUE</span>,<span class="at">quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span>),<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"FigureDens/FigCons"</span>,<span class="fu">as.character</span>(i),<span class="st">".png"</span>))</span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(gp1)</span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a>  Diagnoses_Ward <span class="ot">&lt;-</span>  ds <span class="sc">%&gt;%</span></span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(dataSource <span class="sc">==</span> <span class="st">"Ward"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>)   <span class="sc">%&gt;%</span></span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(ID, SynQuest, SynCons, SynPermzs, SynLine,dataSource)</span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a>  criterion1 <span class="ot">=</span> <span class="fu">as.logical</span>(Diagnoses_Ward<span class="sc">$</span>SynCons)</span>
<span id="cb113-23"><a href="#cb113-23" aria-hidden="true" tabindex="-1"></a>  criterion2 <span class="ot">=</span> <span class="fu">as.logical</span>(Diagnoses_Ward<span class="sc">$</span>SynLine)</span>
<span id="cb113-24"><a href="#cb113-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-25"><a href="#cb113-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Accuracy</span></span>
<span id="cb113-26"><a href="#cb113-26" aria-hidden="true" tabindex="-1"></a>  accuracy <span class="ot">&lt;-</span> <span class="fu">sum</span>(criterion1 <span class="sc">==</span> criterion2) <span class="sc">/</span> <span class="fu">length</span>(criterion1)</span>
<span id="cb113-27"><a href="#cb113-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-28"><a href="#cb113-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sensitivity: how well criterion1 detects positive cases in criterion2</span></span>
<span id="cb113-29"><a href="#cb113-29" aria-hidden="true" tabindex="-1"></a>  true_positives <span class="ot">&lt;-</span> <span class="fu">sum</span>(criterion1 <span class="sc">&amp;</span> criterion2)</span>
<span id="cb113-30"><a href="#cb113-30" aria-hidden="true" tabindex="-1"></a>  actual_positives <span class="ot">&lt;-</span> <span class="fu">sum</span>(criterion2)</span>
<span id="cb113-31"><a href="#cb113-31" aria-hidden="true" tabindex="-1"></a>  sensitivity <span class="ot">&lt;-</span> true_positives <span class="sc">/</span> actual_positives</span>
<span id="cb113-32"><a href="#cb113-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-33"><a href="#cb113-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Consistency: Percent agreement (could also compute Cohen’s kappa)</span></span>
<span id="cb113-34"><a href="#cb113-34" aria-hidden="true" tabindex="-1"></a>  percent_agreement <span class="ot">&lt;-</span> <span class="fu">mean</span>(criterion1 <span class="sc">==</span> criterion2)</span>
<span id="cb113-35"><a href="#cb113-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-36"><a href="#cb113-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Output</span></span>
<span id="cb113-37"><a href="#cb113-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Questionnaire score:    %.2f</span><span class="sc">\n</span><span class="st">"</span>, i))</span>
<span id="cb113-38"><a href="#cb113-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"n ID pass Quest: % 2f</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">length</span>(ID_SynQuest)))</span>
<span id="cb113-39"><a href="#cb113-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Accuracy:    %.2f</span><span class="sc">\n</span><span class="st">"</span>, accuracy))</span>
<span id="cb113-40"><a href="#cb113-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Sensitivity: %.2f</span><span class="sc">\n</span><span class="st">"</span>, sensitivity))</span>
<span id="cb113-41"><a href="#cb113-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Agreement:   %.2f</span><span class="sc">\n</span><span class="st">"</span>, percent_agreement))</span>
<span id="cb113-42"><a href="#cb113-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-43"><a href="#cb113-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(knitr<span class="sc">::</span><span class="fu">kable</span>( ds <span class="sc">%&gt;%</span></span>
<span id="cb113-44"><a href="#cb113-44" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">group_by</span>(SynQuest) <span class="sc">%&gt;%</span></span>
<span id="cb113-45"><a href="#cb113-45" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">summarize</span>(<span class="at">Med_Cons =</span> <span class="fu">round</span>(<span class="fu">median</span>(Consistency),<span class="dv">4</span>),<span class="at">SD_Cons =</span> <span class="fu">round</span>(<span class="fu">sd</span>(Consistency),<span class="dv">4</span>) ) ) )</span>
<span id="cb113-46"><a href="#cb113-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-47"><a href="#cb113-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-48"><a href="#cb113-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(knitr<span class="sc">::</span><span class="fu">kable</span>( ds <span class="sc">%&gt;%</span></span>
<span id="cb113-49"><a href="#cb113-49" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">group_by</span>(SynQuest) <span class="sc">%&gt;%</span></span>
<span id="cb113-50"><a href="#cb113-50" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">summarize</span>(<span class="at">Med_Line =</span><span class="fu">round</span>(<span class="fu">median</span>(GA_lineInter),<span class="dv">4</span>),<span class="at">SD_Line =</span> <span class="fu">round</span>(<span class="fu">sd</span>(GA_lineInter),<span class="dv">4</span>) ) ) )</span>
<span id="cb113-51"><a href="#cb113-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-52"><a href="#cb113-52" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0155

Picking joint bandwidth of 0.0155</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    9.00
n ID pass Quest:  142.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1086|  0.6301|
|TRUE     |   0.0868|  0.1877|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.0469|  0.3997|
|TRUE     |   0.0043|  0.0818|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0166

Picking joint bandwidth of 0.0166</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    10.00
n ID pass Quest:  165.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1135|  0.6463|
|TRUE     |   0.0786|  0.1677|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.0592|  0.4050|
|TRUE     |   0.0043|  0.0718|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0173

Picking joint bandwidth of 0.0173</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    11.00
n ID pass Quest:  184.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1138|  0.6606|
|TRUE     |   0.0868|  0.1736|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.0683|  0.4092|
|TRUE     |   0.0044|  0.0986|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0194

Picking joint bandwidth of 0.0194</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    12.00
n ID pass Quest:  206.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1157|  0.6783|
|TRUE     |   0.0892|  0.1783|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.0759|  0.4122|
|TRUE     |   0.0086|  0.1701|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0205

Picking joint bandwidth of 0.0205</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    13.00
n ID pass Quest:  224.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1086|  0.6952|
|TRUE     |   0.0976|  0.1725|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.0939|  0.4154|
|TRUE     |   0.0086|  0.1761|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0216

Picking joint bandwidth of 0.0216</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    14.00
n ID pass Quest:  241.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1083|  0.7115|
|TRUE     |   0.0990|  0.1699|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.1133|  0.4179|
|TRUE     |   0.0086|  0.1822|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0223

Picking joint bandwidth of 0.0223</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    15.00
n ID pass Quest:  259.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1072|  0.7271|
|TRUE     |   0.0991|  0.2036|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.1282|  0.4212|
|TRUE     |   0.0089|  0.1931|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.024

Picking joint bandwidth of 0.024</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    16.00
n ID pass Quest:  268.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1086|  0.7368|
|TRUE     |   0.0991|  0.1998|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.1356|  0.4224|
|TRUE     |   0.0089|  0.2002|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0262

Picking joint bandwidth of 0.0262</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    17.00
n ID pass Quest:  282.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1169|  0.7530|
|TRUE     |   0.0992|  0.1951|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.1526|  0.4234|
|TRUE     |   0.0126|  0.2159|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0267

Picking joint bandwidth of 0.0267</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    18.00
n ID pass Quest:  299.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1068|  0.7731|
|TRUE     |   0.1003|  0.2115|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.1847|  0.4227|
|TRUE     |   0.0128|  0.2385|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0277

Picking joint bandwidth of 0.0277</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    19.00
n ID pass Quest:  315.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0966|  0.7547|
|TRUE     |   0.1020|  0.3378|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.2188|  0.4248|
|TRUE     |   0.0132|  0.2445|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0259

Picking joint bandwidth of 0.0259</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    20.00
n ID pass Quest:  328.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0894|  0.7245|
|TRUE     |   0.1022|  0.4285|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.2533|  0.4262|
|TRUE     |   0.0134|  0.2506|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0264

Picking joint bandwidth of 0.0264</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    21.00
n ID pass Quest:  340.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0832|  0.7423|
|TRUE     |   0.1038|  0.4241|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.3218|  0.4268|
|TRUE     |   0.0169|  0.2499|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0267

Picking joint bandwidth of 0.0267</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-15.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    22.00
n ID pass Quest:  354.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0859|  0.7467|
|TRUE     |   0.1030|  0.4413|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |    0.459|  0.4262|
|TRUE     |    0.017|  0.2639|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0272

Picking joint bandwidth of 0.0272</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-16.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    23.00
n ID pass Quest:  367.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0830|  0.7659|
|TRUE     |   0.1044|  0.4402|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.5396|  0.4261|
|TRUE     |   0.0170|  0.2687|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0274

Picking joint bandwidth of 0.0274</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-17.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    24.00
n ID pass Quest:  373.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0864|  0.7667|
|TRUE     |   0.1029|  0.4484|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.5396|  0.4252|
|TRUE     |   0.0173|  0.2791|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0257

Picking joint bandwidth of 0.0257</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-18.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    25.00
n ID pass Quest:  385.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0846|  0.7246|
|TRUE     |   0.1032|  0.5009|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.5396|  0.4282|
|TRUE     |   0.0177|  0.2950|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0256

Picking joint bandwidth of 0.0256</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-19.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    26.00
n ID pass Quest:  399.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0864|  0.7173|
|TRUE     |   0.1029|  0.5185|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.5906|  0.4303|
|TRUE     |   0.0179|  0.3018|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0289

Picking joint bandwidth of 0.0289</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-20.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    27.00
n ID pass Quest:  410.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0859|  0.7149|
|TRUE     |   0.1026|  0.5279|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.5975|  0.4310|
|TRUE     |   0.0179|  0.3092|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0294

Picking joint bandwidth of 0.0294</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-21.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    28.00
n ID pass Quest:  426.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0676|  0.7407|
|TRUE     |   0.1030|  0.5267|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.6843|  0.4276|
|TRUE     |   0.0179|  0.3156|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0298

Picking joint bandwidth of 0.0298</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-22.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    29.00
n ID pass Quest:  433.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0752|  0.7598|
|TRUE     |   0.1029|  0.5224|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.6853|  0.4226|
|TRUE     |   0.0179|  0.3217|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0305

Picking joint bandwidth of 0.0305</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-23.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    30.00
n ID pass Quest:  440.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0625|  0.7451|
|TRUE     |   0.1030|  0.5353|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.6863|  0.4211|
|TRUE     |   0.0209|  0.3281|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0382

Picking joint bandwidth of 0.0382</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-24.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    31.00
n ID pass Quest:  446.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0466|  0.7660|
|TRUE     |   0.1038|  0.5314|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.6863|  0.4211|
|TRUE     |   0.0210|  0.3337|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.029

Picking joint bandwidth of 0.029</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-25.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    32.00
n ID pass Quest:  453.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0453|  0.6961|
|TRUE     |   0.1052|  0.5599|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.7209|  0.4220|
|TRUE     |   0.0213|  0.3364|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.034

Picking joint bandwidth of 0.034</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-26.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    33.00
n ID pass Quest:  457.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0459|  0.7088|
|TRUE     |   0.1044|  0.5575|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.7209|  0.4243|
|TRUE     |   0.0213|  0.3391|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0329

Picking joint bandwidth of 0.0329</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-27.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    34.00
n ID pass Quest:  466.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0453|  0.6512|
|TRUE     |   0.1048|  0.5755|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.8048|  0.4184|
|TRUE     |   0.0220|  0.3420|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0448

Picking joint bandwidth of 0.0448</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-28.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    35.00
n ID pass Quest:  478.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0529|  0.6949|
|TRUE     |   0.1030|  0.5690|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.7342|  0.4102|
|TRUE     |   0.0223|  0.3539|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0424

Picking joint bandwidth of 0.0424</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-29.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    36.00
n ID pass Quest:  488.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0529|  0.6975|
|TRUE     |   0.1030|  0.5726|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.7342|  0.4015|
|TRUE     |   0.0238|  0.3594|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0428

Picking joint bandwidth of 0.0428</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-30.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    37.00
n ID pass Quest:  491.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0497|  0.7152|
|TRUE     |   0.1032|  0.5711|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.7695|  0.4019|
|TRUE     |   0.0253|  0.3611|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0434

Picking joint bandwidth of 0.0434</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-31.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    38.00
n ID pass Quest:  495.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0497|  0.6812|
|TRUE     |   0.1032|  0.5774|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.7695|  0.4018|
|TRUE     |   0.0254|  0.3633|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0526

Picking joint bandwidth of 0.0526</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-32.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    39.00
n ID pass Quest:  501.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0545|  0.7206|
|TRUE     |   0.1029|  0.5740|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.7695|  0.4034|
|TRUE     |   0.0257|  0.3671|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0667

Picking joint bandwidth of 0.0667</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-33.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    40.00
n ID pass Quest:  506.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0466|  0.7022|
|TRUE     |   0.1030|  0.5785|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.8048|  0.4012|
|TRUE     |   0.0261|  0.3689|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0308

Picking joint bandwidth of 0.0308</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-34.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    41.00
n ID pass Quest:  511.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0417|  0.7274|
|TRUE     |   0.1032|  0.5787|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.8649|  0.4099|
|TRUE     |   0.0266|  0.3700|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0327

Picking joint bandwidth of 0.0327</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-35.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    42.00
n ID pass Quest:  520.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0098|  0.7709|
|TRUE     |   0.1026|  0.5799|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.8769|  0.4152|
|TRUE     |   0.0297|  0.3742|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0948

Picking joint bandwidth of 0.0948</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-36.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    43.00
n ID pass Quest:  523.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0049|  0.8318|
|TRUE     |   0.1024|  0.5783|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.8814|  0.3825|
|TRUE     |   0.0297|  0.3746|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.00931

Picking joint bandwidth of 0.00931</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-37.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    44.00
n ID pass Quest:  530.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |    0.000|  0.0069|
|TRUE     |    0.103|  0.5919|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.9909|  0.0666|
|TRUE     |   0.0298|  0.3750|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0179

Picking joint bandwidth of 0.0179</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-43-38.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    45.00
n ID pass Quest:  537.000000
Accuracy:    0.55
Sensitivity: 0.68
Agreement:   0.55


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|TRUE     |   0.1009|  0.5887|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|TRUE     |   0.0309|  0.3823|</code></pre>
</div>
</div>
</section>
<section id="line-intersect" class="level1">
<h1>Line Intersect</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ds_Q<span class="sc">$</span><span class="st">`</span><span class="at">questionnaire score</span><span class="st">`</span>,<span class="dv">45</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">9</span><span class="sc">:</span><span class="dv">45</span>){</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>  ds_Q<span class="sc">$</span>QuestCriteria <span class="ot">&lt;-</span> ds_Q<span class="sc">$</span><span class="st">`</span><span class="at">questionnaire score</span><span class="st">`</span> <span class="sc">&lt;=</span> i</span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(ds_Q<span class="sc">$</span>QuestCriteria)<span class="sc">/</span><span class="fu">length</span>(ds_Q<span class="sc">$</span>QuestCriteria)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>  ID_SynQuest <span class="ot">&lt;-</span> ds_Q<span class="sc">$</span>ID[ds_Q<span class="sc">$</span>QuestCriteria]</span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a>  ds<span class="sc">$</span>SynQuest <span class="ot">&lt;-</span> ds<span class="sc">$</span>ID <span class="sc">%in%</span> ID_SynQuest</span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a>  gp1 <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(dataSource <span class="sc">==</span> <span class="st">"Ward"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb189-10"><a href="#cb189-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GA_lineInter, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">group =</span> SynQuest, <span class="at">fill =</span> SynQuest,<span class="at">colour =</span> SynQuest)) <span class="sc">+</span></span>
<span id="cb189-11"><a href="#cb189-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stat_density_ridges</span>(<span class="at">quantile_lines =</span> <span class="cn">TRUE</span>,<span class="at">quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span>),<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb189-12"><a href="#cb189-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"FigureDens/FigCons"</span>,<span class="fu">as.character</span>(i),<span class="st">".png"</span>))</span>
<span id="cb189-13"><a href="#cb189-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb189-14"><a href="#cb189-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(gp1)</span>
<span id="cb189-15"><a href="#cb189-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb189-16"><a href="#cb189-16" aria-hidden="true" tabindex="-1"></a>  Diagnoses_Ward <span class="ot">&lt;-</span>  ds <span class="sc">%&gt;%</span></span>
<span id="cb189-17"><a href="#cb189-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(dataSource <span class="sc">==</span> <span class="st">"Ward"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb189-18"><a href="#cb189-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb189-19"><a href="#cb189-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>)   <span class="sc">%&gt;%</span></span>
<span id="cb189-20"><a href="#cb189-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(ID, SynQuest, SynCons, SynPermzs, SynLine,dataSource)</span>
<span id="cb189-21"><a href="#cb189-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb189-22"><a href="#cb189-22" aria-hidden="true" tabindex="-1"></a>  criterion1 <span class="ot">=</span> <span class="fu">as.logical</span>(Diagnoses_Ward<span class="sc">$</span>SynQuest)</span>
<span id="cb189-23"><a href="#cb189-23" aria-hidden="true" tabindex="-1"></a>  criterion2 <span class="ot">=</span> <span class="fu">as.logical</span>(Diagnoses_Ward<span class="sc">$</span>SynLine)</span>
<span id="cb189-24"><a href="#cb189-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb189-25"><a href="#cb189-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Accuracy</span></span>
<span id="cb189-26"><a href="#cb189-26" aria-hidden="true" tabindex="-1"></a>  accuracy <span class="ot">&lt;-</span> <span class="fu">sum</span>(criterion1 <span class="sc">==</span> criterion2) <span class="sc">/</span> <span class="fu">length</span>(criterion1)</span>
<span id="cb189-27"><a href="#cb189-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb189-28"><a href="#cb189-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sensitivity: how well criterion1 detects positive cases in criterion2</span></span>
<span id="cb189-29"><a href="#cb189-29" aria-hidden="true" tabindex="-1"></a>  true_positives <span class="ot">&lt;-</span> <span class="fu">sum</span>(criterion1 <span class="sc">&amp;</span> criterion2)</span>
<span id="cb189-30"><a href="#cb189-30" aria-hidden="true" tabindex="-1"></a>  actual_positives <span class="ot">&lt;-</span> <span class="fu">sum</span>(criterion2)</span>
<span id="cb189-31"><a href="#cb189-31" aria-hidden="true" tabindex="-1"></a>  sensitivity <span class="ot">&lt;-</span> true_positives <span class="sc">/</span> actual_positives</span>
<span id="cb189-32"><a href="#cb189-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb189-33"><a href="#cb189-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Consistency: Percent agreement (could also compute Cohen’s kappa)</span></span>
<span id="cb189-34"><a href="#cb189-34" aria-hidden="true" tabindex="-1"></a>  percent_agreement <span class="ot">&lt;-</span> <span class="fu">mean</span>(criterion1 <span class="sc">==</span> criterion2)</span>
<span id="cb189-35"><a href="#cb189-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb189-36"><a href="#cb189-36" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb189-37"><a href="#cb189-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb189-38"><a href="#cb189-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Output</span></span>
<span id="cb189-39"><a href="#cb189-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Questionnaire score:    %.2f</span><span class="sc">\n</span><span class="st">"</span>, i))</span>
<span id="cb189-40"><a href="#cb189-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"n ID pass Quest: % 2f</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">length</span>(ID_SynQuest)))</span>
<span id="cb189-41"><a href="#cb189-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Accuracy:    %.2f</span><span class="sc">\n</span><span class="st">"</span>, accuracy))</span>
<span id="cb189-42"><a href="#cb189-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Sensitivity: %.2f</span><span class="sc">\n</span><span class="st">"</span>, sensitivity))</span>
<span id="cb189-43"><a href="#cb189-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Agreement:   %.2f</span><span class="sc">\n</span><span class="st">"</span>, percent_agreement))</span>
<span id="cb189-44"><a href="#cb189-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb189-45"><a href="#cb189-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(knitr<span class="sc">::</span><span class="fu">kable</span>( ds <span class="sc">%&gt;%</span></span>
<span id="cb189-46"><a href="#cb189-46" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">group_by</span>(SynQuest) <span class="sc">%&gt;%</span></span>
<span id="cb189-47"><a href="#cb189-47" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">summarize</span>(<span class="at">Med_Cons =</span> <span class="fu">round</span>(<span class="fu">median</span>(Consistency),<span class="dv">4</span>),<span class="at">SD_Cons =</span> <span class="fu">round</span>(<span class="fu">sd</span>(Consistency),<span class="dv">4</span>) ) ) )</span>
<span id="cb189-48"><a href="#cb189-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb189-49"><a href="#cb189-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb189-50"><a href="#cb189-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(knitr<span class="sc">::</span><span class="fu">kable</span>( ds <span class="sc">%&gt;%</span></span>
<span id="cb189-51"><a href="#cb189-51" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">group_by</span>(SynQuest) <span class="sc">%&gt;%</span></span>
<span id="cb189-52"><a href="#cb189-52" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">summarize</span>(<span class="at">Med_Line =</span><span class="fu">round</span>(<span class="fu">median</span>(GA_lineInter),<span class="dv">4</span>),<span class="at">SD_Line =</span> <span class="fu">round</span>(<span class="fu">sd</span>(GA_lineInter),<span class="dv">4</span>) ) ) )</span>
<span id="cb189-53"><a href="#cb189-53" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb189-54"><a href="#cb189-54" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0236

Picking joint bandwidth of 0.0236</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    9.00
n ID pass Quest:  142.000000
Accuracy:    0.42
Sensitivity: 0.21
Agreement:   0.42


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1086|  0.6301|
|TRUE     |   0.0868|  0.1877|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.0469|  0.3997|
|TRUE     |   0.0043|  0.0818|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0238

Picking joint bandwidth of 0.0238</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    10.00
n ID pass Quest:  165.000000
Accuracy:    0.47
Sensitivity: 0.28
Agreement:   0.47


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1135|  0.6463|
|TRUE     |   0.0786|  0.1677|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.0592|  0.4050|
|TRUE     |   0.0043|  0.0718|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0245

Picking joint bandwidth of 0.0245</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    11.00
n ID pass Quest:  184.000000
Accuracy:    0.51
Sensitivity: 0.33
Agreement:   0.51


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1138|  0.6606|
|TRUE     |   0.0868|  0.1736|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.0683|  0.4092|
|TRUE     |   0.0044|  0.0986|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0249

Picking joint bandwidth of 0.0249</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    12.00
n ID pass Quest:  206.000000
Accuracy:    0.54
Sensitivity: 0.38
Agreement:   0.54


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1157|  0.6783|
|TRUE     |   0.0892|  0.1783|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.0759|  0.4122|
|TRUE     |   0.0086|  0.1701|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0254

Picking joint bandwidth of 0.0254</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    13.00
n ID pass Quest:  224.000000
Accuracy:    0.57
Sensitivity: 0.43
Agreement:   0.57


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1086|  0.6952|
|TRUE     |   0.0976|  0.1725|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.0939|  0.4154|
|TRUE     |   0.0086|  0.1761|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0258

Picking joint bandwidth of 0.0258</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    14.00
n ID pass Quest:  241.000000
Accuracy:    0.61
Sensitivity: 0.48
Agreement:   0.61


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1083|  0.7115|
|TRUE     |   0.0990|  0.1699|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.1133|  0.4179|
|TRUE     |   0.0086|  0.1822|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0266

Picking joint bandwidth of 0.0266</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    15.00
n ID pass Quest:  259.000000
Accuracy:    0.64
Sensitivity: 0.53
Agreement:   0.64


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1072|  0.7271|
|TRUE     |   0.0991|  0.2036|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.1282|  0.4212|
|TRUE     |   0.0089|  0.1931|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0269

Picking joint bandwidth of 0.0269</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    16.00
n ID pass Quest:  268.000000
Accuracy:    0.65
Sensitivity: 0.55
Agreement:   0.65


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1086|  0.7368|
|TRUE     |   0.0991|  0.1998|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.1356|  0.4224|
|TRUE     |   0.0089|  0.2002|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0272

Picking joint bandwidth of 0.0272</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    17.00
n ID pass Quest:  282.000000
Accuracy:    0.67
Sensitivity: 0.59
Agreement:   0.67


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1169|  0.7530|
|TRUE     |   0.0992|  0.1951|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.1526|  0.4234|
|TRUE     |   0.0126|  0.2159|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0277

Picking joint bandwidth of 0.0277</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    18.00
n ID pass Quest:  299.000000
Accuracy:    0.69
Sensitivity: 0.63
Agreement:   0.69


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1068|  0.7731|
|TRUE     |   0.1003|  0.2115|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.1847|  0.4227|
|TRUE     |   0.0128|  0.2385|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0285

Picking joint bandwidth of 0.0285</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    19.00
n ID pass Quest:  315.000000
Accuracy:    0.71
Sensitivity: 0.66
Agreement:   0.71


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0966|  0.7547|
|TRUE     |   0.1020|  0.3378|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.2188|  0.4248|
|TRUE     |   0.0132|  0.2445|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0287

Picking joint bandwidth of 0.0287</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    20.00
n ID pass Quest:  328.000000
Accuracy:    0.73
Sensitivity: 0.69
Agreement:   0.73


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0894|  0.7245|
|TRUE     |   0.1022|  0.4285|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.2533|  0.4262|
|TRUE     |   0.0134|  0.2506|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0291

Picking joint bandwidth of 0.0291</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    21.00
n ID pass Quest:  340.000000
Accuracy:    0.75
Sensitivity: 0.73
Agreement:   0.75


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0832|  0.7423|
|TRUE     |   0.1038|  0.4241|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.3218|  0.4268|
|TRUE     |   0.0169|  0.2499|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0296

Picking joint bandwidth of 0.0296</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-15.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    22.00
n ID pass Quest:  354.000000
Accuracy:    0.76
Sensitivity: 0.76
Agreement:   0.76


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0859|  0.7467|
|TRUE     |   0.1030|  0.4413|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |    0.459|  0.4262|
|TRUE     |    0.017|  0.2639|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0303

Picking joint bandwidth of 0.0303</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-16.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    23.00
n ID pass Quest:  367.000000
Accuracy:    0.78
Sensitivity: 0.78
Agreement:   0.78


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0830|  0.7659|
|TRUE     |   0.1044|  0.4402|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.5396|  0.4261|
|TRUE     |   0.0170|  0.2687|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0307

Picking joint bandwidth of 0.0307</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-17.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    24.00
n ID pass Quest:  373.000000
Accuracy:    0.78
Sensitivity: 0.79
Agreement:   0.78


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0864|  0.7667|
|TRUE     |   0.1029|  0.4484|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.5396|  0.4252|
|TRUE     |   0.0173|  0.2791|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0316

Picking joint bandwidth of 0.0316</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-18.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    25.00
n ID pass Quest:  385.000000
Accuracy:    0.76
Sensitivity: 0.80
Agreement:   0.76


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0846|  0.7246|
|TRUE     |   0.1032|  0.5009|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.5396|  0.4282|
|TRUE     |   0.0177|  0.2950|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0325

Picking joint bandwidth of 0.0325</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-19.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    26.00
n ID pass Quest:  399.000000
Accuracy:    0.76
Sensitivity: 0.82
Agreement:   0.76


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0864|  0.7173|
|TRUE     |   0.1029|  0.5185|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.5906|  0.4303|
|TRUE     |   0.0179|  0.3018|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0337

Picking joint bandwidth of 0.0337</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-20.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    27.00
n ID pass Quest:  410.000000
Accuracy:    0.77
Sensitivity: 0.84
Agreement:   0.77


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0859|  0.7149|
|TRUE     |   0.1026|  0.5279|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.5975|  0.4310|
|TRUE     |   0.0179|  0.3092|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0349

Picking joint bandwidth of 0.0349</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-21.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    28.00
n ID pass Quest:  426.000000
Accuracy:    0.78
Sensitivity: 0.87
Agreement:   0.78


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0676|  0.7407|
|TRUE     |   0.1030|  0.5267|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.6843|  0.4276|
|TRUE     |   0.0179|  0.3156|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.035

Picking joint bandwidth of 0.035</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-22.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    29.00
n ID pass Quest:  433.000000
Accuracy:    0.78
Sensitivity: 0.88
Agreement:   0.78


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0752|  0.7598|
|TRUE     |   0.1029|  0.5224|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.6853|  0.4226|
|TRUE     |   0.0179|  0.3217|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0356

Picking joint bandwidth of 0.0356</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-23.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    30.00
n ID pass Quest:  440.000000
Accuracy:    0.78
Sensitivity: 0.89
Agreement:   0.78


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0625|  0.7451|
|TRUE     |   0.1030|  0.5353|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.6863|  0.4211|
|TRUE     |   0.0209|  0.3281|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0365

Picking joint bandwidth of 0.0365</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-24.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    31.00
n ID pass Quest:  446.000000
Accuracy:    0.77
Sensitivity: 0.90
Agreement:   0.77


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0466|  0.7660|
|TRUE     |   0.1038|  0.5314|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.6863|  0.4211|
|TRUE     |   0.0210|  0.3337|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0372

Picking joint bandwidth of 0.0372</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-25.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    32.00
n ID pass Quest:  453.000000
Accuracy:    0.77
Sensitivity: 0.91
Agreement:   0.77


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0453|  0.6961|
|TRUE     |   0.1052|  0.5599|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.7209|  0.4220|
|TRUE     |   0.0213|  0.3364|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0377

Picking joint bandwidth of 0.0377</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-26.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    33.00
n ID pass Quest:  457.000000
Accuracy:    0.76
Sensitivity: 0.91
Agreement:   0.76


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0459|  0.7088|
|TRUE     |   0.1044|  0.5575|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.7209|  0.4243|
|TRUE     |   0.0213|  0.3391|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0382

Picking joint bandwidth of 0.0382</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-27.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    34.00
n ID pass Quest:  466.000000
Accuracy:    0.77
Sensitivity: 0.93
Agreement:   0.77


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0453|  0.6512|
|TRUE     |   0.1048|  0.5755|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.8048|  0.4184|
|TRUE     |   0.0220|  0.3420|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0398

Picking joint bandwidth of 0.0398</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-28.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    35.00
n ID pass Quest:  478.000000
Accuracy:    0.76
Sensitivity: 0.94
Agreement:   0.76


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0529|  0.6949|
|TRUE     |   0.1030|  0.5690|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.7342|  0.4102|
|TRUE     |   0.0223|  0.3539|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0413

Picking joint bandwidth of 0.0413</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-29.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    36.00
n ID pass Quest:  488.000000
Accuracy:    0.76
Sensitivity: 0.95
Agreement:   0.76


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0529|  0.6975|
|TRUE     |   0.1030|  0.5726|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.7342|  0.4015|
|TRUE     |   0.0238|  0.3594|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0418

Picking joint bandwidth of 0.0418</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-30.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    37.00
n ID pass Quest:  491.000000
Accuracy:    0.76
Sensitivity: 0.95
Agreement:   0.76


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0497|  0.7152|
|TRUE     |   0.1032|  0.5711|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.7695|  0.4019|
|TRUE     |   0.0253|  0.3611|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0429

Picking joint bandwidth of 0.0429</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-31.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    38.00
n ID pass Quest:  495.000000
Accuracy:    0.76
Sensitivity: 0.96
Agreement:   0.76


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0497|  0.6812|
|TRUE     |   0.1032|  0.5774|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.7695|  0.4018|
|TRUE     |   0.0254|  0.3633|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0451

Picking joint bandwidth of 0.0451</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-32.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    39.00
n ID pass Quest:  501.000000
Accuracy:    0.75
Sensitivity: 0.96
Agreement:   0.75


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0545|  0.7206|
|TRUE     |   0.1029|  0.5740|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.7695|  0.4034|
|TRUE     |   0.0257|  0.3671|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0462

Picking joint bandwidth of 0.0462</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-33.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    40.00
n ID pass Quest:  506.000000
Accuracy:    0.75
Sensitivity: 0.97
Agreement:   0.75


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0466|  0.7022|
|TRUE     |   0.1030|  0.5785|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.8048|  0.4012|
|TRUE     |   0.0261|  0.3689|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0495

Picking joint bandwidth of 0.0495</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-34.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    41.00
n ID pass Quest:  511.000000
Accuracy:    0.74
Sensitivity: 0.97
Agreement:   0.74


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0417|  0.7274|
|TRUE     |   0.1032|  0.5787|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.8649|  0.4099|
|TRUE     |   0.0266|  0.3700|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0556

Picking joint bandwidth of 0.0556</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-35.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    42.00
n ID pass Quest:  520.000000
Accuracy:    0.74
Sensitivity: 0.98
Agreement:   0.74


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0098|  0.7709|
|TRUE     |   0.1026|  0.5799|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.8769|  0.4152|
|TRUE     |   0.0297|  0.3742|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0537

Picking joint bandwidth of 0.0537</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-36.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    43.00
n ID pass Quest:  523.000000
Accuracy:    0.74
Sensitivity: 0.99
Agreement:   0.74


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0049|  0.8318|
|TRUE     |   0.1024|  0.5783|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.8814|  0.3825|
|TRUE     |   0.0297|  0.3746|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0211

Picking joint bandwidth of 0.0211</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-37.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    44.00
n ID pass Quest:  530.000000
Accuracy:    0.74
Sensitivity: 1.00
Agreement:   0.74


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |    0.000|  0.0069|
|TRUE     |    0.103|  0.5919|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.9909|  0.0666|
|TRUE     |   0.0298|  0.3750|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Picking joint bandwidth of 0.0412

Picking joint bandwidth of 0.0412</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Presentation_V1_files/figure-html/unnamed-chunk-44-38.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    45.00
n ID pass Quest:  537.000000
Accuracy:    0.73
Sensitivity: 1.00
Agreement:   0.73


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|TRUE     |   0.1009|  0.5887|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|TRUE     |   0.0309|  0.3823|</code></pre>
</div>
</div>
</section>
<section id="section-1" class="level1">
<h1></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">9</span><span class="sc">:</span><span class="dv">45</span>){</span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>  ds_Q<span class="sc">$</span>QuestCriteria <span class="ot">&lt;-</span> ds_Q<span class="sc">$</span><span class="st">`</span><span class="at">questionnaire score</span><span class="st">`</span> <span class="sc">&lt;=</span> i</span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(ds_Q<span class="sc">$</span>QuestCriteria)<span class="sc">/</span><span class="fu">length</span>(ds_Q<span class="sc">$</span>QuestCriteria)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a>  ID_SynQuest <span class="ot">&lt;-</span> ds_Q<span class="sc">$</span>ID[ds_Q<span class="sc">$</span>QuestCriteria]</span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true" tabindex="-1"></a>  ds<span class="sc">$</span>SynQuest <span class="ot">&lt;-</span> ds<span class="sc">$</span>ID <span class="sc">%in%</span> ID_SynQuest</span>
<span id="cb264-7"><a href="#cb264-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb264-8"><a href="#cb264-8" aria-hidden="true" tabindex="-1"></a>  Diagnoses_Ward <span class="ot">&lt;-</span>  ds <span class="sc">%&gt;%</span></span>
<span id="cb264-9"><a href="#cb264-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(dataSource <span class="sc">==</span> <span class="st">"Ward"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-10"><a href="#cb264-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb264-11"><a href="#cb264-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>)   <span class="sc">%&gt;%</span></span>
<span id="cb264-12"><a href="#cb264-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(ID, SynQuest, SynCons, SynPermzs, SynLine,dataSource)</span>
<span id="cb264-13"><a href="#cb264-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb264-14"><a href="#cb264-14" aria-hidden="true" tabindex="-1"></a>  criterion1 <span class="ot">=</span> <span class="fu">as.logical</span>(Diagnoses_Ward<span class="sc">$</span>SynQuest)</span>
<span id="cb264-15"><a href="#cb264-15" aria-hidden="true" tabindex="-1"></a>  criterion2 <span class="ot">=</span> <span class="fu">as.logical</span>(Diagnoses_Ward<span class="sc">$</span>SynLine)</span>
<span id="cb264-16"><a href="#cb264-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb264-17"><a href="#cb264-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Accuracy</span></span>
<span id="cb264-18"><a href="#cb264-18" aria-hidden="true" tabindex="-1"></a>  accuracy <span class="ot">&lt;-</span> <span class="fu">sum</span>(criterion1 <span class="sc">==</span> criterion2) <span class="sc">/</span> <span class="fu">length</span>(criterion1)</span>
<span id="cb264-19"><a href="#cb264-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb264-20"><a href="#cb264-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sensitivity: how well criterion1 detects positive cases in criterion2</span></span>
<span id="cb264-21"><a href="#cb264-21" aria-hidden="true" tabindex="-1"></a>  true_positives <span class="ot">&lt;-</span> <span class="fu">sum</span>(criterion1 <span class="sc">&amp;</span> criterion2)</span>
<span id="cb264-22"><a href="#cb264-22" aria-hidden="true" tabindex="-1"></a>  actual_positives <span class="ot">&lt;-</span> <span class="fu">sum</span>(criterion2)</span>
<span id="cb264-23"><a href="#cb264-23" aria-hidden="true" tabindex="-1"></a>  sensitivity <span class="ot">&lt;-</span> true_positives <span class="sc">/</span> actual_positives</span>
<span id="cb264-24"><a href="#cb264-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb264-25"><a href="#cb264-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Consistency: Percent agreement (could also compute Cohen’s kappa)</span></span>
<span id="cb264-26"><a href="#cb264-26" aria-hidden="true" tabindex="-1"></a>  percent_agreement <span class="ot">&lt;-</span> <span class="fu">mean</span>(criterion1 <span class="sc">==</span> criterion2)</span>
<span id="cb264-27"><a href="#cb264-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb264-28"><a href="#cb264-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Output</span></span>
<span id="cb264-29"><a href="#cb264-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Questionnaire score:    %.2f</span><span class="sc">\n</span><span class="st">"</span>, i))</span>
<span id="cb264-30"><a href="#cb264-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"n ID pass Quest: % 2f</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">length</span>(ID_SynQuest)))</span>
<span id="cb264-31"><a href="#cb264-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Accuracy:    %.2f</span><span class="sc">\n</span><span class="st">"</span>, accuracy))</span>
<span id="cb264-32"><a href="#cb264-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Sensitivity: %.2f</span><span class="sc">\n</span><span class="st">"</span>, sensitivity))</span>
<span id="cb264-33"><a href="#cb264-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Agreement:   %.2f</span><span class="sc">\n</span><span class="st">"</span>, percent_agreement))</span>
<span id="cb264-34"><a href="#cb264-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb264-35"><a href="#cb264-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(knitr<span class="sc">::</span><span class="fu">kable</span>( ds <span class="sc">%&gt;%</span></span>
<span id="cb264-36"><a href="#cb264-36" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">group_by</span>(SynQuest) <span class="sc">%&gt;%</span></span>
<span id="cb264-37"><a href="#cb264-37" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">summarize</span>(<span class="at">Med_Cons =</span> <span class="fu">round</span>(<span class="fu">median</span>(Consistency),<span class="dv">4</span>),<span class="at">SD_Cons =</span> <span class="fu">round</span>(<span class="fu">sd</span>(Consistency),<span class="dv">4</span>) ) ) )</span>
<span id="cb264-38"><a href="#cb264-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb264-39"><a href="#cb264-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb264-40"><a href="#cb264-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(knitr<span class="sc">::</span><span class="fu">kable</span>( ds <span class="sc">%&gt;%</span></span>
<span id="cb264-41"><a href="#cb264-41" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">group_by</span>(SynQuest) <span class="sc">%&gt;%</span></span>
<span id="cb264-42"><a href="#cb264-42" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">summarize</span>(<span class="at">Med_Line =</span><span class="fu">round</span>(<span class="fu">median</span>(GA_lineInter),<span class="dv">4</span>),<span class="at">SD_Line =</span> <span class="fu">round</span>(<span class="fu">sd</span>(GA_lineInter),<span class="dv">4</span>) ) ) )</span>
<span id="cb264-43"><a href="#cb264-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb264-44"><a href="#cb264-44" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Questionnaire score:    9.00
n ID pass Quest:  142.000000
Accuracy:    0.42
Sensitivity: 0.21
Agreement:   0.42


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1086|  0.6301|
|TRUE     |   0.0868|  0.1877|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.0469|  0.3997|
|TRUE     |   0.0043|  0.0818|
Questionnaire score:    10.00
n ID pass Quest:  165.000000
Accuracy:    0.47
Sensitivity: 0.28
Agreement:   0.47


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1135|  0.6463|
|TRUE     |   0.0786|  0.1677|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.0592|  0.4050|
|TRUE     |   0.0043|  0.0718|
Questionnaire score:    11.00
n ID pass Quest:  184.000000
Accuracy:    0.51
Sensitivity: 0.33
Agreement:   0.51


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1138|  0.6606|
|TRUE     |   0.0868|  0.1736|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.0683|  0.4092|
|TRUE     |   0.0044|  0.0986|
Questionnaire score:    12.00
n ID pass Quest:  206.000000
Accuracy:    0.54
Sensitivity: 0.38
Agreement:   0.54


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1157|  0.6783|
|TRUE     |   0.0892|  0.1783|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.0759|  0.4122|
|TRUE     |   0.0086|  0.1701|
Questionnaire score:    13.00
n ID pass Quest:  224.000000
Accuracy:    0.57
Sensitivity: 0.43
Agreement:   0.57


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1086|  0.6952|
|TRUE     |   0.0976|  0.1725|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.0939|  0.4154|
|TRUE     |   0.0086|  0.1761|
Questionnaire score:    14.00
n ID pass Quest:  241.000000
Accuracy:    0.61
Sensitivity: 0.48
Agreement:   0.61


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1083|  0.7115|
|TRUE     |   0.0990|  0.1699|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.1133|  0.4179|
|TRUE     |   0.0086|  0.1822|
Questionnaire score:    15.00
n ID pass Quest:  259.000000
Accuracy:    0.64
Sensitivity: 0.53
Agreement:   0.64


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1072|  0.7271|
|TRUE     |   0.0991|  0.2036|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.1282|  0.4212|
|TRUE     |   0.0089|  0.1931|
Questionnaire score:    16.00
n ID pass Quest:  268.000000
Accuracy:    0.65
Sensitivity: 0.55
Agreement:   0.65


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1086|  0.7368|
|TRUE     |   0.0991|  0.1998|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.1356|  0.4224|
|TRUE     |   0.0089|  0.2002|
Questionnaire score:    17.00
n ID pass Quest:  282.000000
Accuracy:    0.67
Sensitivity: 0.59
Agreement:   0.67


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1169|  0.7530|
|TRUE     |   0.0992|  0.1951|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.1526|  0.4234|
|TRUE     |   0.0126|  0.2159|
Questionnaire score:    18.00
n ID pass Quest:  299.000000
Accuracy:    0.69
Sensitivity: 0.63
Agreement:   0.69


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.1068|  0.7731|
|TRUE     |   0.1003|  0.2115|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.1847|  0.4227|
|TRUE     |   0.0128|  0.2385|
Questionnaire score:    19.00
n ID pass Quest:  315.000000
Accuracy:    0.71
Sensitivity: 0.66
Agreement:   0.71


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0966|  0.7547|
|TRUE     |   0.1020|  0.3378|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.2188|  0.4248|
|TRUE     |   0.0132|  0.2445|
Questionnaire score:    20.00
n ID pass Quest:  328.000000
Accuracy:    0.73
Sensitivity: 0.69
Agreement:   0.73


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0894|  0.7245|
|TRUE     |   0.1022|  0.4285|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.2533|  0.4262|
|TRUE     |   0.0134|  0.2506|
Questionnaire score:    21.00
n ID pass Quest:  340.000000
Accuracy:    0.75
Sensitivity: 0.73
Agreement:   0.75


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0832|  0.7423|
|TRUE     |   0.1038|  0.4241|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.3218|  0.4268|
|TRUE     |   0.0169|  0.2499|
Questionnaire score:    22.00
n ID pass Quest:  354.000000
Accuracy:    0.76
Sensitivity: 0.76
Agreement:   0.76


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0859|  0.7467|
|TRUE     |   0.1030|  0.4413|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |    0.459|  0.4262|
|TRUE     |    0.017|  0.2639|
Questionnaire score:    23.00
n ID pass Quest:  367.000000
Accuracy:    0.78
Sensitivity: 0.78
Agreement:   0.78


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0830|  0.7659|
|TRUE     |   0.1044|  0.4402|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.5396|  0.4261|
|TRUE     |   0.0170|  0.2687|
Questionnaire score:    24.00
n ID pass Quest:  373.000000
Accuracy:    0.78
Sensitivity: 0.79
Agreement:   0.78


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0864|  0.7667|
|TRUE     |   0.1029|  0.4484|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.5396|  0.4252|
|TRUE     |   0.0173|  0.2791|
Questionnaire score:    25.00
n ID pass Quest:  385.000000
Accuracy:    0.76
Sensitivity: 0.80
Agreement:   0.76


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0846|  0.7246|
|TRUE     |   0.1032|  0.5009|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.5396|  0.4282|
|TRUE     |   0.0177|  0.2950|
Questionnaire score:    26.00
n ID pass Quest:  399.000000
Accuracy:    0.76
Sensitivity: 0.82
Agreement:   0.76


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0864|  0.7173|
|TRUE     |   0.1029|  0.5185|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.5906|  0.4303|
|TRUE     |   0.0179|  0.3018|
Questionnaire score:    27.00
n ID pass Quest:  410.000000
Accuracy:    0.77
Sensitivity: 0.84
Agreement:   0.77


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0859|  0.7149|
|TRUE     |   0.1026|  0.5279|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.5975|  0.4310|
|TRUE     |   0.0179|  0.3092|
Questionnaire score:    28.00
n ID pass Quest:  426.000000
Accuracy:    0.78
Sensitivity: 0.87
Agreement:   0.78


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0676|  0.7407|
|TRUE     |   0.1030|  0.5267|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.6843|  0.4276|
|TRUE     |   0.0179|  0.3156|
Questionnaire score:    29.00
n ID pass Quest:  433.000000
Accuracy:    0.78
Sensitivity: 0.88
Agreement:   0.78


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0752|  0.7598|
|TRUE     |   0.1029|  0.5224|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.6853|  0.4226|
|TRUE     |   0.0179|  0.3217|
Questionnaire score:    30.00
n ID pass Quest:  440.000000
Accuracy:    0.78
Sensitivity: 0.89
Agreement:   0.78


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0625|  0.7451|
|TRUE     |   0.1030|  0.5353|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.6863|  0.4211|
|TRUE     |   0.0209|  0.3281|
Questionnaire score:    31.00
n ID pass Quest:  446.000000
Accuracy:    0.77
Sensitivity: 0.90
Agreement:   0.77


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0466|  0.7660|
|TRUE     |   0.1038|  0.5314|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.6863|  0.4211|
|TRUE     |   0.0210|  0.3337|
Questionnaire score:    32.00
n ID pass Quest:  453.000000
Accuracy:    0.77
Sensitivity: 0.91
Agreement:   0.77


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0453|  0.6961|
|TRUE     |   0.1052|  0.5599|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.7209|  0.4220|
|TRUE     |   0.0213|  0.3364|
Questionnaire score:    33.00
n ID pass Quest:  457.000000
Accuracy:    0.76
Sensitivity: 0.91
Agreement:   0.76


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0459|  0.7088|
|TRUE     |   0.1044|  0.5575|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.7209|  0.4243|
|TRUE     |   0.0213|  0.3391|
Questionnaire score:    34.00
n ID pass Quest:  466.000000
Accuracy:    0.77
Sensitivity: 0.93
Agreement:   0.77


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0453|  0.6512|
|TRUE     |   0.1048|  0.5755|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.8048|  0.4184|
|TRUE     |   0.0220|  0.3420|
Questionnaire score:    35.00
n ID pass Quest:  478.000000
Accuracy:    0.76
Sensitivity: 0.94
Agreement:   0.76


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0529|  0.6949|
|TRUE     |   0.1030|  0.5690|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.7342|  0.4102|
|TRUE     |   0.0223|  0.3539|
Questionnaire score:    36.00
n ID pass Quest:  488.000000
Accuracy:    0.76
Sensitivity: 0.95
Agreement:   0.76


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0529|  0.6975|
|TRUE     |   0.1030|  0.5726|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.7342|  0.4015|
|TRUE     |   0.0238|  0.3594|
Questionnaire score:    37.00
n ID pass Quest:  491.000000
Accuracy:    0.76
Sensitivity: 0.95
Agreement:   0.76


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0497|  0.7152|
|TRUE     |   0.1032|  0.5711|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.7695|  0.4019|
|TRUE     |   0.0253|  0.3611|
Questionnaire score:    38.00
n ID pass Quest:  495.000000
Accuracy:    0.76
Sensitivity: 0.96
Agreement:   0.76


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0497|  0.6812|
|TRUE     |   0.1032|  0.5774|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.7695|  0.4018|
|TRUE     |   0.0254|  0.3633|
Questionnaire score:    39.00
n ID pass Quest:  501.000000
Accuracy:    0.75
Sensitivity: 0.96
Agreement:   0.75


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0545|  0.7206|
|TRUE     |   0.1029|  0.5740|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.7695|  0.4034|
|TRUE     |   0.0257|  0.3671|
Questionnaire score:    40.00
n ID pass Quest:  506.000000
Accuracy:    0.75
Sensitivity: 0.97
Agreement:   0.75


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0466|  0.7022|
|TRUE     |   0.1030|  0.5785|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.8048|  0.4012|
|TRUE     |   0.0261|  0.3689|
Questionnaire score:    41.00
n ID pass Quest:  511.000000
Accuracy:    0.74
Sensitivity: 0.97
Agreement:   0.74


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0417|  0.7274|
|TRUE     |   0.1032|  0.5787|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.8649|  0.4099|
|TRUE     |   0.0266|  0.3700|
Questionnaire score:    42.00
n ID pass Quest:  520.000000
Accuracy:    0.74
Sensitivity: 0.98
Agreement:   0.74


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0098|  0.7709|
|TRUE     |   0.1026|  0.5799|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.8769|  0.4152|
|TRUE     |   0.0297|  0.3742|
Questionnaire score:    43.00
n ID pass Quest:  523.000000
Accuracy:    0.74
Sensitivity: 0.99
Agreement:   0.74


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |   0.0049|  0.8318|
|TRUE     |   0.1024|  0.5783|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.8814|  0.3825|
|TRUE     |   0.0297|  0.3746|
Questionnaire score:    44.00
n ID pass Quest:  530.000000
Accuracy:    0.74
Sensitivity: 1.00
Agreement:   0.74


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|FALSE    |    0.000|  0.0069|
|TRUE     |    0.103|  0.5919|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|FALSE    |   0.9909|  0.0666|
|TRUE     |   0.0298|  0.3750|
Questionnaire score:    45.00
n ID pass Quest:  537.000000
Accuracy:    0.73
Sensitivity: 1.00
Agreement:   0.73


|SynQuest | Med_Cons| SD_Cons|
|:--------|--------:|-------:|
|TRUE     |   0.1009|  0.5887|


|SynQuest | Med_Line| SD_Line|
|:--------|--------:|-------:|
|TRUE     |   0.0309|  0.3823|</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.3 (2024-02-29)
Platform: aarch64-apple-darwin20 (64-bit)
Running under: macOS 15.5

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: Europe/Zurich
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] irr_0.84.1        lpSolve_5.6.23    ggforce_0.4.2     ggalluvial_0.12.5
 [5] ggridges_0.5.6    readxl_1.4.5      ggplot2_3.5.2     dplyr_1.1.4      
 [9] tidyr_1.3.1       readr_2.1.5      

loaded via a namespace (and not attached):
 [1] gtable_0.3.6       jsonlite_2.0.0     compiler_4.3.3     Rcpp_1.0.14       
 [5] tidyselect_1.2.1   textshaping_1.0.1  systemfonts_1.2.3  scales_1.4.0      
 [9] yaml_2.3.10        fastmap_1.2.0      R6_2.6.1           labeling_0.4.3    
[13] generics_0.1.4     knitr_1.50         MASS_7.3-60.0.1    htmlwidgets_1.6.4 
[17] polyclip_1.10-7    tibble_3.3.0       pillar_1.10.2      RColorBrewer_1.1-3
[21] tzdb_0.5.0         rlang_1.1.6        utf8_1.2.6         xfun_0.52         
[25] cli_3.6.5          tweenr_2.0.3       withr_3.0.2        magrittr_2.0.3    
[29] digest_0.6.37      grid_4.3.3         rstudioapi_0.17.1  hms_1.1.3         
[33] lifecycle_1.0.4    vctrs_0.6.5        evaluate_1.0.3     glue_1.8.0        
[37] farver_2.1.2       cellranger_1.1.0   ragg_1.4.0         rmarkdown_2.29    
[41] purrr_1.0.4        tools_4.3.3        pkgconfig_2.0.3    htmltools_0.5.8.1 </code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>