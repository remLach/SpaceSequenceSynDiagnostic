<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-11-10">

<title>Pre-registered report: Space Sequence Synesthesia Diagnostic using form mapping</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="2.Pre-registeredReport_V5_mini_files/libs/clipboard/clipboard.min.js"></script>
<script src="2.Pre-registeredReport_V5_mini_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="2.Pre-registeredReport_V5_mini_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="2.Pre-registeredReport_V5_mini_files/libs/quarto-html/popper.min.js"></script>
<script src="2.Pre-registeredReport_V5_mini_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="2.Pre-registeredReport_V5_mini_files/libs/quarto-html/anchor.min.js"></script>
<link href="2.Pre-registeredReport_V5_mini_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="2.Pre-registeredReport_V5_mini_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="2.Pre-registeredReport_V5_mini_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="2.Pre-registeredReport_V5_mini_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="2.Pre-registeredReport_V5_mini_files/libs/bootstrap/bootstrap-81267100e462c21b3d6c0d5bf76a3417.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="2.Pre-registeredReport_V5_mini_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="2.Pre-registeredReport_V5_mini_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Pre-registered report: Space Sequence Synesthesia Diagnostic using form mapping</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 10, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data import</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Data wrangling:</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Render Formatting</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(papaja)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggalluvial)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># geometry/geography feature package</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># for ROC analyses:</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC) <span class="co"># See https://www.r-bloggers.com/2019/02/some-r-packages-for-roc-curves/</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="abstract" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Abstract:</h1>
<p>Space sequence synesthesia is the phenomenon of representing ordered visual symbols in particular spatial positions. Not everyone has space sequence synesthesia. Existent tools to detect space sequence synethesia are based on self-reports (i.e.&nbsp;questionnaire) and response consistency. Consistency can be derived on the stimulus level, i.e.&nbsp;spatial deviation in time, or on the form level, i.e.&nbsp;geometrical properties. In this pre-registered report, available data from 467 participants is used to explore new tools to discriminate syntheses from controls. Conceptually, the novel criteria aim at taking advantage of the inducerâ€™s ordinality that create synesthetic forms. For this aim, we harness a geography package to extract geometrical features to use as a test for synethesia. Reciever Operator Characteristics are used to select the features that best classify the groups. In a second phase, we will test the predictive power of the new diagnostic features on an additional dataset that has yet to be collected.</p>
</section>
<section id="introduction" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Introduction</h1>
<p>Sequence Space Synesthesia (SSS) is defined as representing ordered sequences in particular spatial positions. For example, numbers (the <em>inducers</em>) are perceived as arranged particular positions in space (the <em>concurrent</em>), also called number forms <span class="citation" data-cites="galton1880">(<a href="#ref-galton1880" role="doc-biblioref">Galton 1880</a>)</span>. In addition to numbers, SSS might also perceive weekdays and months in particular arrangement in space.</p>
<p>Estimated prevalence for SSS in the general population spans between 4.4 % <span class="citation" data-cites="brang2013">(<a href="#ref-brang2013" role="doc-biblioref">Brang et al. 2013</a>)</span> and 14.2 % <span class="citation" data-cites="seron1992">(<a href="#ref-seron1992" role="doc-biblioref">Seron et al. 1992</a>)</span>, see also <span class="citation" data-cites="ward2018 sagiv2006">(<a href="#ref-ward2018" role="doc-biblioref">Ward et al. 2018</a>; <a href="#ref-sagiv2006" role="doc-biblioref">Sagiv et al. 2006</a>)</span>. Hence a reliable diagnostic tool to detect SSS would also be useful to investigate SSS. SSS forms are idiosyncratic, meaning they each individual might have a different form. Idiosyncrasy makes it difficult to diagnose SSS.</p>
<p>Diagnostic depends on the definition of the conditions under investigation. A strict definition of Synestheesia requires five different criteria <span class="citation" data-cites="deroy2013">(<a href="#ref-deroy2013" role="doc-biblioref">Deroy and Spence 2013</a>)</span>. <em>Automaticity</em>: the <em>inducer</em> automatically triggers the <em>concurrent</em>. For example 10 might automatically be the number in the highest position. <em>Unidirectionality</em>: while the <em>inducer</em> triggers the concurrent, the concurrent does not trigger the inducer. Hence the highest position does not trigger the number 10. <em>Consciousness</em>: The concurrent is consciously perceived. <em>Developmentally early</em>: the experience was already present during childhood. <em>Consistency</em>: the inducer-concurrent pair remains stable in time. For example, the particular position triggered by 10 is stable in time. Consistency is a well suited charachteristic of synesthesia to develop a diagnostic tool. For esample a consistency test is used to diagnose grapheme-colour synesthesia <span class="citation" data-cites="rothen2013a">(<a href="#ref-rothen2013a" role="doc-biblioref">Rothen et al. 2013a</a>)</span>. While the original groups of synesthetes are mostly generated by self-reports.</p>
<p>Hence given consistency, similar concurrent responses triggered by the same inducers can be used as a marker for authentic SSS. Consistency test have become golden standart for colour-grapheme synesthesia, where an inducer is presented (i.e.&nbsp;letters of the alphabet) and the participant is requested to selected the concurrent colour, using a colour picker. Individual consistency is then calculated as the distance between repeated colour responses to the same inducers. Interestingly, the best colour space to detect colour-grapheme synesthesia is CIE*LUV, a colour space developed to be isoform to human perception <span class="citation" data-cites="rothen2013">(<a href="#ref-rothen2013" role="doc-biblioref">Rothen et al. 2013b</a>)</span>. Analogously to grapheme-colour synesthetes, consistency test can be used to diagnose SSS. In that tasks, it is repeatedly asked to report the position of the inducers on a screen. The total area between the responses of same inducer (i.e.&nbsp;a triangle if repeated three times) is then used as characteristic to diagnose SSS. The rationale being that consistent responses would lead to smaller area than inconsistent ones <span class="citation" data-cites="rothen2016">(<a href="#ref-rothen2016" role="doc-biblioref">Rothen et al. 2016</a>)</span>. This method resembles how number forms are describe in the single case study <span class="citation" data-cites="piazza2006">(<a href="#ref-piazza2006" role="doc-biblioref">Piazza, Pinel, and Dehaene 2006</a>)</span>, see Experiment 1.</p>
<p>However disciminating synesthesia using total area has several limitations. For example high consistency by non-synesthetes can be achieved by giving all responses on the same screen position (i.e.&nbsp;false positive). Moreover, this kind of criteria might bias the diagnosis to include synesthetes with straight lines which leads to less variability than more complex forms<span class="citation" data-cites="Ward">(<a href="#ref-Ward" role="doc-biblioref"><strong>Ward?</strong></a>)</span>.</p>
<p>The goal of the present registered report is to first identify new features characterizing synesthetes responses based on already available datasets and test the best working features on a future dataset. The new features are designed to take advantage of two properties of synesthetic responses that have not been included in precedent consistency tests. First, sequentiality on top of single inducer responses the ordered position between subsequent induces is important. For example the relative position of August and the other months. From numerical cognition, ordinality has been acknowledged to be an important semantic property of numbers, also given their sequential acquisition (i.e.&nbsp;1 is learned before 2). Second, thee particular synthetic forms of the sequential spatial location. These forms might have geometrical properties. For example months of the year might be represented circularly (as already described by <span class="citation" data-cites="galton1880">(<a href="#ref-galton1880" role="doc-biblioref">Galton 1880</a>)</span> for numbers).</p>
<p>To take advantage of sequential and geometrical synesthetic forms, we harnessed a geo-spatial package<span class="citation" data-cites="pebesma2018">(<a href="#ref-pebesma2018" role="doc-biblioref">Pebesma 2018</a>)</span> to extract geometrical features from participant x and y coordinate responses. This packages allows for example to build string or polygons for each repetition and compare different geometrical features. Those individual geometrical features are then compared using Receiver Operator Characteristics (ROC) between individuals grouped as synesthets and control. In the present <em>phase I</em>,we compare ROC on three merged derivation datasets using the same task on SSS <span class="citation" data-cites="rothen2016 vanpetersen2020a">Ward (<a href="#ref-ward" role="doc-biblioref">n.d.a</a>)</span>. In future <em>phase II</em>, we compare whether the features selected to diagnose SSS in <em>phase I,</em> on a validation dataset that is not yet acquired (registered report on the open science foundation: <a href="https://osf.io/9efjb/" class="uri">https://osf.io/9efjb/</a><strong>).</strong></p>
</section>
<section id="general-methods" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> General Methods</h1>
<p><em>Phase I: present analyses</em>. We merge three available dataset and compared available diagnostic criteria across datasets using Receiver Operator Characteristics (ROC) for different approaches. A first approach of diagnostic criteria based on a stimulus level consistency. The rationale being that synesthetes should produce more consistent (i.e.&nbsp;less variable) across repetitions. Such criteria include area between repetitions<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, standard deviation of responses <span class="citation" data-cites="ward">(<a href="#ref-ward" role="doc-biblioref">Ward, n.d.a</a>)</span> or permuting the responses to compare each responses to a permuted chance level Root <span class="citation" data-cites="root2021">(<a href="#ref-root2021" role="doc-biblioref">Root et al. 2021</a>)</span>. The second suggested approach is to look at the geometrical form generated by the responses across repetitions. The rationale here is that synesthetic responses should have geometrical feature that differ from controls. For example, several SSS representations for months are circular. For the form</p>
<p>Third, we compare whether the features lead to similar ROC characteristics across the different sets (i.e.&nbsp;for months, weeks and numbers). Fourth, we compute new candidate geometrical features that could be used to diagnose SS. Finally we summarize and compare all ROC and select the best features that class synesthetes from control with the merged dataset.</p>
<p><em>Phase II: future analyses.</em> On a future dataset to be collected using the same task, we will compare the predictive power of the selected features using ROC.</p>
<section id="materials" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="materials"><span class="header-section-number">3.1</span> Materials</h2>
<p>A the exception of <span class="citation" data-cites="rothen2016">(<a href="#ref-rothen2016" role="doc-biblioref">Rothen et al. 2016</a>)</span> (see <a href="https://osf.io/6hq94/files/osfstorage" class="uri">https://osf.io/6hq94/files/osfstorage</a>), the data from <span class="citation" data-cites="ward vanpetersen2020a">(<a href="#ref-ward" role="doc-biblioref">Ward, n.d.a</a>; <a href="#ref-vanpetersen2020a" role="doc-biblioref">Van Petersen et al. 2020a</a>)</span> were collected online. The 29 inducers were: the 12 months of a year, 7 days of the week and 10 numbers (i.e.&nbsp;hindo-arabic numerals from 0 to 9). <span class="citation" data-cites="vanpetersen2020a">(<a href="#ref-vanpetersen2020a" role="doc-biblioref">Van Petersen et al. 2020a</a>)</span> Also presented 50 and 100 numerals, which we excluded here. <span class="citation" data-cites="ward">(<a href="#ref-ward" role="doc-biblioref">Ward, n.d.a</a>)</span> data is collected using the Syntoolkit.</p>
</section>
<section id="procedure" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="procedure"><span class="header-section-number">3.2</span> Procedure</h2>
<p>The details for each procedure is described in each respective article <span class="citation" data-cites="rothen2016 ward vanpetersen2020a">(<a href="#ref-rothen2016" role="doc-biblioref">Rothen et al. 2016</a>; <a href="#ref-ward" role="doc-biblioref">Ward, n.d.a</a>; <a href="#ref-vanpetersen2020a" role="doc-biblioref">Van Petersen et al. 2020a</a>)</span>, here we describe the common task.</p>
<p>Each participant is presented with one one inducer at a time at the center of a otherwise white screen. The participant is instructed to click at the screen position that they visualize them. Inducers order is randomized and each inducer is repeated three times.</p>
<p><em>The order of the stimuli was randomized, but such that no stimulus was repeated until the previous batch of unique stimuli (N = 29) had been presented.</em></p>
<p>Importantly, while the three datasets inclucded in <em>phase I</em> include three repetitions per stimuli, the <em>phase II</em> will use four repetition per stimuli. Hence the cut-offs will be designed to be scalable to different number of repetitions and stimulus.</p>
</section>
</section>
<section id="phase-i-methods" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> <em>Phase I</em> Methods</h1>
<section id="phase-i-merge-and-prepare-data" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="phase-i-merge-and-prepare-data"><span class="header-section-number">4.1</span> <em>Phase I</em>: Merge and prepare data</h2>
<p>We merged three datasets: <span class="citation" data-cites="rothen2016">Rothen et al. (<a href="#ref-rothen2016" role="doc-biblioref">2016</a>)</span>],<span class="citation" data-cites="ward">(<a href="#ref-ward" role="doc-biblioref">Ward, n.d.a</a>)</span> (from: <a href="#0" class="uri">https://osf.io/p5xsd/files/osfstorage</a>) and <span class="citation" data-cites="vanpetersen2020">(<a href="#ref-vanpetersen2020" role="doc-biblioref">Van Petersen et al. 2020b</a>)</span>. To match the other datasets, stimuli form <span class="citation" data-cites="vanpetersen2020">(<a href="#ref-vanpetersen2020" role="doc-biblioref">Van Petersen et al. 2020b</a>)</span> are translated from dutch to English and for the stimuli, only numbers from 0 to 9 are kept (excluding 50 and 100). The x and y coordinates then separately normalized (z-score) per participant.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In the following I upload and merge the data from Ward, Rothen and Van Peters. Data is stored into a full dataset ds (i.e. 1 row per trial) and a dataset per participant ds_Quest (i.e. 1 row per participant).</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="do">### 0.1.1. Ward Data</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>ds_syn       <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"raw_synaesthetes_consistency_anon.xlsx"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>ds_syn<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="st">"Syn"</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>ds_ctl       <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"raw_controls_consistency_anon.xlsx"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>ds_ctl<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="st">"Ctl"</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>ds_Q_syn       <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"raw_synaesthetes_questionnaire_anon.xlsx"</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>ds_Q_syn<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="st">"Syn"</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>ds_Q_ctl       <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"raw_controls_questionnaire_anon.xlsx"</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>ds_Q_ctl<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="st">"Ctl"</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge wards datafiles:</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="fu">merge</span>(ds_syn,ds_ctl, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>ds_Q <span class="ot">&lt;-</span> <span class="fu">merge</span>(ds_Q_syn,ds_Q_ctl, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Ward only uses those who completed the Questionnaire (i.e. N = 215+252 = 467)</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(session_id <span class="sc">%in%</span> <span class="fu">unique</span>(ds_Q<span class="sc">$</span>session_id))</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="do">### 0.1.1. Rothen Data</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>ds_Rothen <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"~/Documents/SpaceSequenceSynDiagnostic/SpaceSequenceSynDiagnostic/rawdata.txt"</span>, <span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="do">### 0.1.2. Rename variables to match datasets</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(ds_Q<span class="sc">$</span>consistency_score <span class="sc">!=</span> ds_Q<span class="sc">$</span>consistency) <span class="co"># Duplicate variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>ds_Q<span class="sc">$</span>consistency <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>ds_Q<span class="sc">$</span>...<span class="dv">36</span> <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>ds_Q<span class="sc">$</span>...<span class="dv">37</span> <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>ds_Q<span class="sc">$</span>mean_simulation_Z <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>ds_Q<span class="sc">$</span>SD_simulation <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>ds_Q<span class="sc">$</span><span class="st">`</span><span class="at">z-score</span><span class="st">`</span>  <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ds_syn,ds_ctl,ds_Q_syn,ds_Q_ctl)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>ID <span class="ot">&lt;-</span> ds<span class="sc">$</span>session_id</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>ds_Q<span class="sc">$</span>ID <span class="ot">&lt;-</span> ds_Q<span class="sc">$</span>session_id</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>ds_Q<span class="sc">$</span>dataSource <span class="ot">&lt;-</span> <span class="st">"Ward"</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>dataSource <span class="ot">&lt;-</span> <span class="st">"Ward"</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co"># From Rothen:</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ds_Rothen)[<span class="fu">names</span>(ds_Rothen) <span class="sc">==</span> <span class="st">"Group"</span>] <span class="ot">&lt;-</span> <span class="st">"group"</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>ds_Rothen<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(ds_Rothen<span class="sc">$</span>group)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(ds_Rothen<span class="sc">$</span>group) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Ctl"</span>,<span class="st">"Syn"</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ds_Rothen)[<span class="fu">names</span>(ds_Rothen) <span class="sc">==</span> <span class="st">"Inducer"</span>] <span class="ot">&lt;-</span> <span class="st">"stimulus"</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ds_Rothen)[<span class="fu">names</span>(ds_Rothen) <span class="sc">==</span> <span class="st">"X"</span>] <span class="ot">&lt;-</span> <span class="st">"x"</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ds_Rothen)[<span class="fu">names</span>(ds_Rothen) <span class="sc">==</span> <span class="st">"Y"</span>] <span class="ot">&lt;-</span> <span class="st">"y"</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>ds_Rothen<span class="sc">$</span>SynQuest <span class="ot">&lt;-</span> ds_Rothen<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"Syn"</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>ds_Rothen<span class="sc">$</span>dataSource <span class="ot">&lt;-</span> <span class="st">"Rothen"</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="co"># From the paper (all the same since lab based):</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>ds_Rothen<span class="sc">$</span>width <span class="ot">&lt;-</span> <span class="dv">1024</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>ds_Rothen<span class="sc">$</span>height <span class="ot">&lt;-</span> <span class="dv">768</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.2 Merge data:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># remove non matching colnames: </span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>ColNames_ds <span class="ot">&lt;-</span> <span class="fu">colnames</span>(ds_Rothen)[<span class="fu">colnames</span>(ds_Rothen) <span class="sc">%in%</span> <span class="fu">colnames</span>(ds)]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(ColNames_ds))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>ds_Rothen <span class="ot">&lt;-</span> ds_Rothen <span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(ColNames_ds))</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Data:</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>ds   <span class="ot">&lt;-</span> <span class="fu">merge</span>(ds,ds_Rothen, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Because there is no questionnaire in Nicola's data:</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>SynQuest[ds<span class="sc">$</span>dataSource <span class="sc">==</span> <span class="st">"Rothen"</span>] <span class="ot">=</span> <span class="st">"NaN"</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Questionnaire:</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>ID <span class="ot">&lt;-</span> <span class="fu">unique</span>((ds_Rothen<span class="sc">$</span>ID))</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>ds_Q_Rothen <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ID)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>ds_Q_Rothen<span class="sc">$</span>dataSource <span class="ot">&lt;-</span> <span class="st">"Rothen"</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>ds_Q_Rothen <span class="ot">&lt;-</span> <span class="fu">merge</span>(ds_Q_Rothen, ds_Rothen <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, dataSource, group) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ID"</span>,<span class="st">"dataSource"</span>))</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Append rows:</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>ds_Q<span class="sc">$</span>ID <span class="ot">&lt;-</span> <span class="fu">as.character</span>(ds_Q<span class="sc">$</span>ID)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>ds_Q <span class="ot">&lt;-</span>  <span class="fu">bind_rows</span>(ds_Q,ds_Q_Rothen)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Clear up:</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ds_Q_Rothen, ds_Rothen)</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.3 Wrangle dataset</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Add Condition, i.e. stim type:</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>Cond <span class="ot">&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>Cond[ds<span class="sc">$</span>stimulus <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"4"</span>,<span class="st">"5"</span>,<span class="st">"6"</span>,<span class="st">"7"</span>,<span class="st">"8"</span>,<span class="st">"9"</span>,<span class="st">"0"</span>)] <span class="ot">&lt;-</span> <span class="st">"number"</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>Cond[ds<span class="sc">$</span>stimulus <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Monday"</span>,<span class="st">"Tuesday"</span>,<span class="st">"Wednesday"</span>,<span class="st">"Thursday"</span>,<span class="st">"Friday"</span>,<span class="st">"Saturday"</span>,<span class="st">"Sunday"</span>)] <span class="ot">&lt;-</span> <span class="st">"weekday"</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>Cond[ds<span class="sc">$</span>stimulus <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"January"</span>, <span class="st">"February"</span>, <span class="st">"March"</span>, <span class="st">"April"</span>, <span class="st">"May"</span>,<span class="st">"June"</span>,<span class="st">"July"</span>,<span class="st">"August"</span>,<span class="st">"September"</span>,<span class="st">"October"</span>,<span class="st">"November"</span>,<span class="st">"December"</span>)] <span class="ot">&lt;-</span> <span class="st">"month"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">### ADD Van Petersen Cortex data</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>filedir <span class="ot">&lt;-</span> <span class="st">"~/Documents/SpaceSequenceSynDiagnostic/VanPetersen/Cortex/di.dcc.DSC_2018.00019_653/Consistency test/Preprocessed data/"</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">paste0</span>(filedir,<span class="fu">dir</span>(filedir))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>ds_PeterCor <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(fn[<span class="dv">1</span>],</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">"text"</span>, <span class="st">"numeric"</span>, <span class="st">"text"</span>, </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">"text"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">"text"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>))</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(fn)){</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  ds_i <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(fn[i],</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">"text"</span>, <span class="st">"numeric"</span>, <span class="st">"text"</span>, </span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"text"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, </span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"text"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>))</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    ds_PeterCor <span class="ot">&lt;-</span> <span class="fu">merge</span>(ds_PeterCor, ds_i, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Here information about group:</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>ds_PeterCor_Q <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"~/Documents/SpaceSequenceSynDiagnostic/VanPetersen/Cortex/di.dcc.DSC_2018.00019_653/Consistency test/Final data files/Consistency_scores.xlsx"</span>)</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ds_PeterCor_Q)[<span class="fu">names</span>(ds_PeterCor_Q) <span class="sc">==</span> <span class="st">"PPcode"</span>] <span class="ot">&lt;-</span> <span class="st">"ID"</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ds_PeterCor)[<span class="fu">names</span>(ds_PeterCor) <span class="sc">==</span> <span class="st">"Code"</span>] <span class="ot">&lt;-</span> <span class="st">"ID"</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclude and Match ID's:</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="co"># IDExcl &lt;- unique(ds_PeterCor$ID[is.na(ds_PeterCor$MouseClick.RESPCursorX)])</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="co"># ds_PeterCor &lt;- ds_PeterCor %&gt;%</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="co">#     filter(!ID %in% IDExcl)</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>ID_IN <span class="ot">&lt;-</span> <span class="fu">intersect</span>(ds_PeterCor<span class="sc">$</span>ID, ds_PeterCor_Q<span class="sc">$</span>ID)</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>ds_PeterCor <span class="ot">&lt;-</span> ds_PeterCor <span class="sc">%&gt;%</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(ID <span class="sc">%in%</span> ID_IN)</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>ds_PeterCor_Q <span class="ot">&lt;-</span> ds_PeterCor_Q <span class="sc">%&gt;%</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(ID <span class="sc">%in%</span> ID_IN)</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge data with group and all dataset: </span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>ds_PeterCor <span class="ot">&lt;-</span> ds_PeterCor_Q <span class="sc">%&gt;%</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ds_PeterCor, <span class="at">by =</span> <span class="st">"ID"</span>)</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename to match:</span></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ds_PeterCor)[<span class="fu">names</span>(ds_PeterCor) <span class="sc">==</span> <span class="st">"Group"</span>] <span class="ot">&lt;-</span> <span class="st">"group"</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>ds_PeterCor[ds_PeterCor<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"SSS"</span>,]<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="st">"Syn"</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>ds_PeterCor[ds_PeterCor<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"control"</span>,]<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="st">"Ctl"</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ds_PeterCor)[<span class="fu">names</span>(ds_PeterCor) <span class="sc">==</span> <span class="st">"MouseClick.RESPCursorY"</span>] <span class="ot">&lt;-</span> <span class="st">"y"</span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ds_PeterCor)[<span class="fu">names</span>(ds_PeterCor) <span class="sc">==</span> <span class="st">"MouseClick.RESPCursorX"</span>] <span class="ot">&lt;-</span> <span class="st">"x"</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ds_PeterCor)[<span class="fu">names</span>(ds_PeterCor) <span class="sc">==</span> <span class="st">"word"</span>] <span class="ot">&lt;-</span> <span class="st">"stimulus"</span> <span class="co"># Will need to translate to english!</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ds_PeterCor)[<span class="fu">names</span>(ds_PeterCor) <span class="sc">==</span> <span class="st">"BlockList.Cycle"</span>] <span class="ot">&lt;-</span> <span class="st">"repetition"</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>ds_PeterCor<span class="sc">$</span>width  <span class="ot">&lt;-</span> <span class="dv">1920</span> <span class="co"># "screen with display resolution set to 1920 x 1080, controlled by a Dell computer running Windows 7."</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>ds_PeterCor<span class="sc">$</span>height <span class="ot">&lt;-</span> <span class="dv">1080</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>ds_PeterCor<span class="sc">$</span>dataSource <span class="ot">&lt;-</span> <span class="st">"PeterCor"</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>ds_PeterCor <span class="ot">&lt;-</span> ds_PeterCor <span class="sc">%&gt;%</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(ColNames_ds))</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Translate, weekdays:</span></span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>ds_PeterCor<span class="sc">$</span>stimulus[ds_PeterCor<span class="sc">$</span>stimulus <span class="sc">==</span> <span class="st">"maandag"</span>]   <span class="ot">&lt;-</span> <span class="st">"Monday"</span></span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>ds_PeterCor<span class="sc">$</span>stimulus[ds_PeterCor<span class="sc">$</span>stimulus <span class="sc">==</span> <span class="st">"dinsdag"</span>]   <span class="ot">&lt;-</span> <span class="st">"Tuesday"</span></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>ds_PeterCor<span class="sc">$</span>stimulus[ds_PeterCor<span class="sc">$</span>stimulus <span class="sc">==</span> <span class="st">"woensdag"</span>]  <span class="ot">&lt;-</span> <span class="st">"Wednesday"</span></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>ds_PeterCor<span class="sc">$</span>stimulus[ds_PeterCor<span class="sc">$</span>stimulus <span class="sc">==</span> <span class="st">"donderdag"</span>] <span class="ot">&lt;-</span> <span class="st">"Thursday"</span></span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>ds_PeterCor<span class="sc">$</span>stimulus[ds_PeterCor<span class="sc">$</span>stimulus <span class="sc">==</span> <span class="st">"vrijdag"</span>]   <span class="ot">&lt;-</span> <span class="st">"Friday"</span></span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>ds_PeterCor<span class="sc">$</span>stimulus[ds_PeterCor<span class="sc">$</span>stimulus <span class="sc">==</span> <span class="st">"zaterdag"</span>]  <span class="ot">&lt;-</span> <span class="st">"Saturday"</span></span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>ds_PeterCor<span class="sc">$</span>stimulus[ds_PeterCor<span class="sc">$</span>stimulus <span class="sc">==</span> <span class="st">"zondag"</span>]    <span class="ot">&lt;-</span> <span class="st">"Sunday"</span></span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Translate, Monthc:</span></span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>ds_PeterCor<span class="sc">$</span>stimulus[ds_PeterCor<span class="sc">$</span>stimulus <span class="sc">==</span> <span class="st">"januari"</span>]   <span class="ot">&lt;-</span> <span class="st">"January"</span></span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>ds_PeterCor<span class="sc">$</span>stimulus[ds_PeterCor<span class="sc">$</span>stimulus <span class="sc">==</span> <span class="st">"februari"</span>]  <span class="ot">&lt;-</span> <span class="st">"February"</span></span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>ds_PeterCor<span class="sc">$</span>stimulus[ds_PeterCor<span class="sc">$</span>stimulus <span class="sc">==</span> <span class="st">"maart"</span>]     <span class="ot">&lt;-</span> <span class="st">"March"</span></span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>ds_PeterCor<span class="sc">$</span>stimulus[ds_PeterCor<span class="sc">$</span>stimulus <span class="sc">==</span> <span class="st">"april"</span>]     <span class="ot">&lt;-</span> <span class="st">"April"</span></span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>ds_PeterCor<span class="sc">$</span>stimulus[ds_PeterCor<span class="sc">$</span>stimulus <span class="sc">==</span> <span class="st">"mei"</span>]       <span class="ot">&lt;-</span> <span class="st">"May"</span></span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>ds_PeterCor<span class="sc">$</span>stimulus[ds_PeterCor<span class="sc">$</span>stimulus <span class="sc">==</span> <span class="st">"juni"</span>]      <span class="ot">&lt;-</span> <span class="st">"June"</span></span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>ds_PeterCor<span class="sc">$</span>stimulus[ds_PeterCor<span class="sc">$</span>stimulus <span class="sc">==</span> <span class="st">"juli"</span>]      <span class="ot">&lt;-</span> <span class="st">"July"</span></span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a>ds_PeterCor<span class="sc">$</span>stimulus[ds_PeterCor<span class="sc">$</span>stimulus <span class="sc">==</span> <span class="st">"augustus"</span>]  <span class="ot">&lt;-</span> <span class="st">"August"</span></span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>ds_PeterCor<span class="sc">$</span>stimulus[ds_PeterCor<span class="sc">$</span>stimulus <span class="sc">==</span> <span class="st">"september"</span>] <span class="ot">&lt;-</span> <span class="st">"September"</span></span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>ds_PeterCor<span class="sc">$</span>stimulus[ds_PeterCor<span class="sc">$</span>stimulus <span class="sc">==</span> <span class="st">"oktober"</span>]   <span class="ot">&lt;-</span> <span class="st">"October"</span></span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>ds_PeterCor<span class="sc">$</span>stimulus[ds_PeterCor<span class="sc">$</span>stimulus <span class="sc">==</span> <span class="st">"november"</span>]  <span class="ot">&lt;-</span> <span class="st">"November"</span></span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a>ds_PeterCor<span class="sc">$</span>stimulus[ds_PeterCor<span class="sc">$</span>stimulus <span class="sc">==</span> <span class="st">"december"</span>] <span class="ot">&lt;-</span> <span class="st">"December"</span></span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a><span class="co"># They added 2 numbers that are not in the other datasets:</span></span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a>ds_PeterCor <span class="ot">&lt;-</span> ds_PeterCor <span class="sc">%&gt;%</span></span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(stimulus <span class="sc">!=</span> <span class="st">"50"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(stimulus <span class="sc">!=</span> <span class="st">"100"</span>)</span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a><span class="do">##### MERGE ####</span></span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a>ds   <span class="ot">&lt;-</span> <span class="fu">merge</span>(ds,ds_PeterCor, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Questionnaire:</span></span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ds_PeterCor_Q)[<span class="fu">names</span>(ds_PeterCor_Q) <span class="sc">==</span> <span class="st">"Group"</span>] <span class="ot">&lt;-</span> <span class="st">"group"</span></span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a>ds_PeterCor_Q[ds_PeterCor_Q<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"SSS"</span>,]<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="st">"Syn"</span></span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a>ds_PeterCor_Q[ds_PeterCor_Q<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"control"</span>,]<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="st">"Ctl"</span></span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a>ds_PeterCor_Q<span class="sc">$</span>dataSource <span class="ot">&lt;-</span> <span class="st">"PeterCor"</span></span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a>ds_PeterCor_Q <span class="ot">&lt;-</span> ds_PeterCor_Q <span class="sc">%&gt;%</span></span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, group, <span class="st">`</span><span class="at">Consistency All</span><span class="st">`</span>, <span class="st">`</span><span class="at">Consistency Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">Consistency Months</span><span class="st">`</span>,<span class="st">`</span><span class="at">Consistency Numbers</span><span class="st">`</span>, dataSource)</span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a><span class="co"># Append rows:</span></span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a>ds_Q <span class="ot">&lt;-</span>  <span class="fu">bind_rows</span>(ds_Q,ds_PeterCor_Q)</span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a><span class="co"># Tidy workspace:</span></span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ds_PeterCor_Q,ds_PeterCor,ds_i, ID, fn,ColNames_ds,i,ID_IN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we can enrich our dataset and process several checks</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Add Condition, i.e. stim type:</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>Cond <span class="ot">&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>Cond[ds<span class="sc">$</span>stimulus <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"4"</span>,<span class="st">"5"</span>,<span class="st">"6"</span>,<span class="st">"7"</span>,<span class="st">"8"</span>,<span class="st">"9"</span>,<span class="st">"0"</span>)] <span class="ot">&lt;-</span> <span class="st">"number"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>Cond[ds<span class="sc">$</span>stimulus <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Monday"</span>,<span class="st">"Tuesday"</span>,<span class="st">"Wednesday"</span>,<span class="st">"Thursday"</span>,<span class="st">"Friday"</span>,<span class="st">"Saturday"</span>,<span class="st">"Sunday"</span>)] <span class="ot">&lt;-</span> <span class="st">"weekday"</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>Cond[ds<span class="sc">$</span>stimulus <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"January"</span>, <span class="st">"February"</span>, <span class="st">"March"</span>, <span class="st">"April"</span>, <span class="st">"May"</span>,<span class="st">"June"</span>,<span class="st">"July"</span>,<span class="st">"August"</span>,<span class="st">"September"</span>,<span class="st">"October"</span>,<span class="st">"November"</span>,<span class="st">"December"</span>)] <span class="ot">&lt;-</span> <span class="st">"month"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Add stimulus repetition number</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ID, stimulus, <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">repetition =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Factorialize group variable to avoid confusions:</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>group   <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(ds<span class="sc">$</span>group)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>ds_Q<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(ds_Q<span class="sc">$</span>group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Important. To reproduce Rothen, the X = -1 and Y = -1 need to be NaN:</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>x[ds<span class="sc">$</span>x <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>y[ds<span class="sc">$</span>y <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Detect ID that with overlapping coordinates across responses:</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(ID, Cond, repetition) <span class="sc">%&gt;%</span> <span class="co"># Or  group_by(ID, Cond)</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">SameCoord_x =</span> <span class="fu">length</span>(<span class="fu">unique</span>(x[<span class="sc">!</span><span class="fu">is.na</span>(x)])) <span class="sc">==</span> <span class="dv">1</span>,<span class="at">SameCoord_y =</span> <span class="fu">length</span>(<span class="fu">unique</span>(x[<span class="sc">!</span><span class="fu">is.na</span>(y)])) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>ID_same_x <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SameCoord_x) <span class="sc">%&gt;%</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>ID_same_y <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SameCoord_y) <span class="sc">%&gt;%</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>Same_x_same_y <span class="ot">&lt;-</span> ID_same_y<span class="sc">$</span>ID[ID_same_y<span class="sc">$</span>ID <span class="sc">%in%</span> ID_same_x<span class="sc">$</span>ID]</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>isSame_xy   <span class="ot">&lt;-</span> ds<span class="sc">$</span>ID <span class="sc">%in%</span> Same_x_same_y</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>ds_Q<span class="sc">$</span>isSame_xy <span class="ot">&lt;-</span> ds_Q<span class="sc">$</span>ID <span class="sc">%in%</span> Same_x_same_y</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Honestly, this one should not be in the data:</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="co"># ds %&gt;% filter(ID == "12_CH")%&gt;% select(Cond,x,y)  %&gt;% print(n = 87) </span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Only responses for months.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The main difficulty is that z-score need variability. Now if ID clicked on the same coordinates, no zs can be calculated. So what should it be? 0.</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.4 Standardize/scale coordinates</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span> <span class="co"># Not by Cond, so to avoid NaN's</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x_zs =</span> <span class="fu">scale</span>(x)) <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y_zs =</span> <span class="fu">scale</span>(y))</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">ATTENTION</span><span class="co"> WHEN INTERPRETING THIS:</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>x_zs[<span class="fu">is.na</span>(ds<span class="sc">$</span>x_zs)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>y_zs[<span class="fu">is.na</span>(ds<span class="sc">$</span>y_zs)] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="phase-i.-population" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="phase-i.-population"><span class="header-section-number">4.2</span> <em>Phase I.</em> Population</h2>
<p>For all the three datasets, the synesthetes were self-reported.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th>Source</th>
<th></th>
<th>Synesthetes</th>
<th></th>
<th></th>
<th>Controls</th>
<th></th>
<th>Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>N</td>
<td>Age</td>
<td>n females</td>
<td>N</td>
<td>Age</td>
<td>n females</td>
<td></td>
</tr>
<tr class="even">
<td><span class="citation" data-cites="rothen2016">(<a href="#ref-rothen2016" role="doc-biblioref">Rothen et al. 2016</a>)</span></td>
<td>33</td>
<td>23.1</td>
<td>24</td>
<td>37</td>
<td>28.2</td>
<td>27</td>
<td>70</td>
</tr>
<tr class="odd">
<td><span class="citation" data-cites="vanpetersen2020">(<a href="#ref-vanpetersen2020" role="doc-biblioref">Van Petersen et al. 2020b</a>)</span></td>
<td>23</td>
<td>23.22</td>
<td>20</td>
<td>21</td>
<td>21.57</td>
<td>19</td>
<td>44</td>
</tr>
<tr class="even">
<td><span class="citation" data-cites="wardb">(<a href="#ref-wardb" role="doc-biblioref">Ward, n.d.b</a>)</span></td>
<td>252</td>
<td>37.21</td>
<td>202</td>
<td>215</td>
<td>19.90</td>
<td>178</td>
<td>467</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Merged</td>
<td>308</td>
<td></td>
<td></td>
<td>273</td>
<td></td>
<td></td>
<td>557</td>
</tr>
</tbody>
</table>
</section>
<section id="phase-i.-analysis" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="phase-i.-analysis"><span class="header-section-number">4.3</span> <em>Phase I</em>. Analysis</h2>
<p>First, we replicate consistency methods found in the literature using the same task (<span class="citation" data-cites="rothen2016 ward vanpetersen2020a root2021">(<a href="#ref-rothen2016" role="doc-biblioref">Rothen et al. 2016</a>; <a href="#ref-ward" role="doc-biblioref">Ward, n.d.a</a>; <a href="#ref-vanpetersen2020a" role="doc-biblioref">Van Petersen et al. 2020a</a>; <a href="#ref-root2021" role="doc-biblioref">Root et al. 2021</a>)</span>) and compare the results.</p>
<p>Second, we extract features based on the form. (C) We harness a geography package to compute segment based features (D) We compute polygon based features. (E) Convex Hull (F) Angles.</p>
</section>
</section>
<section id="phase-i.-results-reproduce" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> <em>Phase I.</em> Results Reproduce</h1>
</section>
<section id="replicated-features" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Replicated features</h1>
<section id="standard-deviation" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="standard-deviation"><span class="header-section-number">6.1</span> Standard deviation</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rescale x &amp; y coordinates depending on screen size:</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>xSc <span class="ot">&lt;-</span> ds<span class="sc">$</span>x<span class="sc">/</span>ds<span class="sc">$</span>width</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>ySc <span class="ot">&lt;-</span> ds<span class="sc">$</span>y<span class="sc">/</span>ds<span class="sc">$</span>height</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the SD across all trials (per ID):</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SD_x =</span> <span class="fu">sd</span>(xSc, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SD_y =</span> <span class="fu">sd</span>(ySc, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Add to ds_Q:</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>ds_Q <span class="ot">&lt;-</span> <span class="fu">merge</span>(ds_Q, ds <span class="sc">%&gt;%</span> </span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID,SD_x,SD_y),<span class="at">by =</span> <span class="st">"ID"</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>              )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="triangle-area-consistency" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="triangle-area-consistency"><span class="header-section-number">6.2</span> Triangle area Consistency</h2>
<p><strong>Definition</strong>: Calculating consistency. Each stimulus is represented by three xy coordinates - (x1, y1), (x2, y2), (x3, y3) - from the three repetitions. For each stimulus, the area of the triangle bounded by the coordinates is calculated as follows:<br>
<span class="math inline">\(Area = (x1y2 + x2y3 + x3y1 â€“ x1y3 â€“ x2y1 â€“ x3y2) / 2\)</span></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define area calculation function</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>triangle_area <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(x) <span class="sc">!=</span> <span class="dv">3</span> <span class="sc">|</span> <span class="fu">length</span>(y) <span class="sc">!=</span> <span class="dv">3</span>) <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  area <span class="ot">&lt;-</span> <span class="fu">abs</span>(</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    x[<span class="dv">1</span>]<span class="sc">*</span>y[<span class="dv">2</span>] <span class="sc">+</span> x[<span class="dv">2</span>]<span class="sc">*</span>y[<span class="dv">3</span>] <span class="sc">+</span> x[<span class="dv">3</span>]<span class="sc">*</span>y[<span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    x[<span class="dv">1</span>]<span class="sc">*</span>y[<span class="dv">3</span>] <span class="sc">-</span> x[<span class="dv">2</span>]<span class="sc">*</span>y[<span class="dv">1</span>] <span class="sc">-</span> x[<span class="dv">3</span>]<span class="sc">*</span>y[<span class="dv">2</span>]</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(area)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute triangle area by group:</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span>  </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">triangle_area =</span> <span class="fu">triangle_area</span>(x, y)) <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Summarize By ID:</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>ds_ID <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ID,group) <span class="sc">%&gt;%</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">rep_area =</span> <span class="fu">mean</span>(triangle_area, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))  <span class="sc">%&gt;%</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID,rep_area)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># tmp_perID &lt;- ds  %&gt;% ungroup() %&gt;% group_by(ID) %&gt;% filter(row_number() == 1) %&gt;% select(ID, Consistency)</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co"># names(tmp_perID) &lt;- c("ID", "Consistency2")</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>ds_Q <span class="ot">&lt;-</span> <span class="fu">merge</span>(ds_Q,ds_ID,<span class="at">by =</span> <span class="st">"ID"</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tmp_perID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span>  </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rep_area_zs =</span> <span class="fu">triangle_area</span>(x_zs, y_zs)) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span>  </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">group_by</span>(ID,repetition) <span class="sc">%&gt;%</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">rep_area_GAzs =</span> (<span class="fu">mean</span>(rep_area_zs)))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>tmp_perID2 <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, rep_area_GAzs)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>ds_Q <span class="ot">&lt;-</span> <span class="fu">merge</span>(ds_Q,tmp_perID2,<span class="at">by =</span> <span class="st">"ID"</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tmp_perID2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="perimeter-pixel" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="perimeter-pixel"><span class="header-section-number">6.3</span> Perimeter (<span class="math inline">\(pixel\)</span>):</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Perimeter function: </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>triangle_perimeter <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(x) <span class="sc">!=</span> <span class="dv">3</span> <span class="sc">|</span> <span class="fu">length</span>(y) <span class="sc">!=</span> <span class="dv">3</span>) <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Side lengths</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((x[<span class="dv">2</span>] <span class="sc">-</span> x[<span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (y[<span class="dv">2</span>] <span class="sc">-</span> y[<span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((x[<span class="dv">3</span>] <span class="sc">-</span> x[<span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (y[<span class="dv">3</span>] <span class="sc">-</span> y[<span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((x[<span class="dv">1</span>] <span class="sc">-</span> x[<span class="dv">3</span>])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (y[<span class="dv">1</span>] <span class="sc">-</span> y[<span class="dv">3</span>])<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  perimeter <span class="ot">&lt;-</span> a <span class="sc">+</span> b <span class="sc">+</span> c</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(perimeter)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute triangle perimeter by group:</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span>  </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">triangle_perim_zs =</span> <span class="fu">triangle_perimeter</span>(x_zs, y_zs)) <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Summarize By ID:</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>tmp_ID <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ID,group) <span class="sc">%&gt;%</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">triangle_perim_GA_zs =</span> <span class="fu">mean</span>(triangle_perim_zs)) <span class="sc">%&gt;%</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, triangle_perim_GA_zs)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>ds_Q <span class="ot">&lt;-</span> <span class="fu">merge</span>(ds_Q,tmp_ID,<span class="at">by =</span> <span class="st">"ID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="phase-i.-results-novel-features" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> <em>Phase I.</em> Results: Novel features</h1>
<section id="segment-self-intersection" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="segment-self-intersection"><span class="header-section-number">7.1</span> Segment self-intersection</h2>
<p>We calculated the number of self intersection for each segments sperately for repetitions and conditions. For each participant we then compute the average of self intersections per conditions and repetitions.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define function: this was generated by chatgpt and it does the correct job after checking</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>count_self_intersections <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">verbose =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n <span class="sc">&lt;</span> <span class="dv">4</span>) {</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (verbose) <span class="fu">cat</span>(<span class="st">"Need at least 4 points to check for self-intersection.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Orientation function</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  orientation <span class="ot">&lt;-</span> <span class="cf">function</span>(p, q, r) {</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    val <span class="ot">&lt;-</span> (q[<span class="dv">2</span>] <span class="sc">-</span> p[<span class="dv">2</span>]) <span class="sc">*</span> (r[<span class="dv">1</span>] <span class="sc">-</span> q[<span class="dv">1</span>]) <span class="sc">-</span> (q[<span class="dv">1</span>] <span class="sc">-</span> p[<span class="dv">1</span>]) <span class="sc">*</span> (r[<span class="dv">2</span>] <span class="sc">-</span> q[<span class="dv">2</span>])</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.na</span>(val)) <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (val <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (val <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="dv">1</span>) <span class="cf">else</span> <span class="fu">return</span>(<span class="dv">2</span>)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if q lies on segment pr</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  on_segment <span class="ot">&lt;-</span> <span class="cf">function</span>(p, q, r) {</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">is.na</span>(<span class="fu">c</span>(p, q, r)))) <span class="fu">return</span>(<span class="cn">FALSE</span>)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    q[<span class="dv">1</span>] <span class="sc">&lt;=</span> <span class="fu">max</span>(p[<span class="dv">1</span>], r[<span class="dv">1</span>]) <span class="sc">&amp;&amp;</span> q[<span class="dv">1</span>] <span class="sc">&gt;=</span> <span class="fu">min</span>(p[<span class="dv">1</span>], r[<span class="dv">1</span>]) <span class="sc">&amp;&amp;</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>      q[<span class="dv">2</span>] <span class="sc">&lt;=</span> <span class="fu">max</span>(p[<span class="dv">2</span>], r[<span class="dv">2</span>]) <span class="sc">&amp;&amp;</span> q[<span class="dv">2</span>] <span class="sc">&gt;=</span> <span class="fu">min</span>(p[<span class="dv">2</span>], r[<span class="dv">2</span>])</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Main intersection check</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>  segments_intersect <span class="ot">&lt;-</span> <span class="cf">function</span>(p1, p2, p3, p4) {</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    o1 <span class="ot">&lt;-</span> <span class="fu">orientation</span>(p1, p2, p3)</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    o2 <span class="ot">&lt;-</span> <span class="fu">orientation</span>(p1, p2, p4)</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>    o3 <span class="ot">&lt;-</span> <span class="fu">orientation</span>(p3, p4, p1)</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>    o4 <span class="ot">&lt;-</span> <span class="fu">orientation</span>(p3, p4, p2)</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">is.na</span>(<span class="fu">c</span>(o1, o2, o3, o4)))) <span class="fu">return</span>(<span class="cn">FALSE</span>)</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># General case</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (o1 <span class="sc">!=</span> o2 <span class="sc">&amp;&amp;</span> o3 <span class="sc">!=</span> o4) <span class="fu">return</span>(<span class="cn">TRUE</span>)</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Special colinear cases</span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (o1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">on_segment</span>(p1, p3, p2)) <span class="fu">return</span>(<span class="cn">TRUE</span>)</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (o2 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">on_segment</span>(p1, p4, p2)) <span class="fu">return</span>(<span class="cn">TRUE</span>)</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (o3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">on_segment</span>(p3, p1, p4)) <span class="fu">return</span>(<span class="cn">TRUE</span>)</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (o4 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">on_segment</span>(p3, p2, p4)) <span class="fu">return</span>(<span class="cn">TRUE</span>)</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">FALSE</span>)</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>  count <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">2</span>)) {</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> (i <span class="sc">+</span> <span class="dv">2</span>)<span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (j <span class="sc">==</span> i <span class="sc">+</span> <span class="dv">1</span>) <span class="cf">next</span>  <span class="co"># skip adjacent segments</span></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>      p1 <span class="ot">&lt;-</span> <span class="fu">c</span>(x[i], y[i])</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>      p2 <span class="ot">&lt;-</span> <span class="fu">c</span>(x[i <span class="sc">+</span> <span class="dv">1</span>], y[i <span class="sc">+</span> <span class="dv">1</span>])</span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>      p3 <span class="ot">&lt;-</span> <span class="fu">c</span>(x[j], y[j])</span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>      p4 <span class="ot">&lt;-</span> <span class="fu">c</span>(x[j <span class="sc">+</span> <span class="dv">1</span>], y[j <span class="sc">+</span> <span class="dv">1</span>])</span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">segments_intersect</span>(p1, p2, p3, p4)) {</span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>        count <span class="ot">&lt;-</span> count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (verbose) {</span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Intersection #%d: segments (%d-%d) and (%d-%d)</span><span class="sc">\n</span><span class="st">"</span>, count, i, i<span class="sc">+</span><span class="dv">1</span>, j, j<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (verbose) <span class="fu">cat</span>(<span class="st">"Total crossings:"</span>, count, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(count)</span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of intersections for each ID X Cond X repetition</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Important! The dataset must be correctly informed about stimulus order.</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">ordered</span>(stimulus, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Monday"</span>, <span class="st">"Tuesday"</span>, <span class="st">"Wednesday"</span>, <span class="st">"Thursday"</span>, <span class="st">"Friday"</span>,<span class="st">"Saturday"</span>,<span class="st">"Sunday"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">ordered</span>(stimulus, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"January"</span>, <span class="st">"February"</span>, <span class="st">"March"</span>, <span class="st">"April"</span>, <span class="st">"May"</span>,<span class="st">"June"</span>,<span class="st">"July"</span>,<span class="st">"August"</span>,<span class="st">"September"</span>,<span class="st">"October"</span>,<span class="st">"November"</span>,<span class="st">"December"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Cond,repetition) <span class="sc">%&gt;%</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nLineCross =</span> (<span class="fu">count_self_intersections</span>(x,y, <span class="at">verbose =</span> <span class="cn">FALSE</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ID)<span class="co"># could also be x_zs and y_zs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Average self-intersections per ID by Cond X repetition</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID,Cond,repetition) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="co"># keep only 1 row per IDXCondXrep</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SelfInter_persegm =</span> <span class="fu">mean</span>(nLineCross)) <span class="sc">%&gt;%</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="co"># keep only 1 row per ID</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, SelfInter_persegm) </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="fu">merge</span>(ds, tmp,<span class="at">by =</span> <span class="st">"ID"</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>ds_Q <span class="ot">&lt;-</span> <span class="fu">right_join</span>(ds_Q, </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>           (ds <span class="sc">%&gt;%</span> </span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>                <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>                <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>                <span class="fu">select</span>(ID, SelfInter_persegm)), <span class="at">by =</span> <span class="st">"ID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="segments-with-sf" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="segments-with-sf"><span class="header-section-number">7.2</span> Segments (with sf)</h2>
<p>We will take advantage of the <code>sf</code> package and connect the x and y coordinates of ordered inducer with a segment. Sf hates NaNâ€™s. Either convert them to 0 (as originally) or remove them. Iâ€™ll start converting to 0.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Turn off spherical geometry:</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>sf<span class="sc">::</span><span class="fu">sf_use_s2</span>(<span class="cn">FALSE</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Explicitly enforce item order (i.e. ordinality):</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>ds_segm <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(stimulus) <span class="sc">%&gt;%</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">ordered</span>(stimulus, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Monday"</span>, <span class="st">"Tuesday"</span>, <span class="st">"Wednesday"</span>, <span class="st">"Thursday"</span>, <span class="st">"Friday"</span>,<span class="st">"Saturday"</span>,<span class="st">"Sunday"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">ordered</span>(stimulus, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"January"</span>, <span class="st">"February"</span>, <span class="st">"March"</span>, <span class="st">"April"</span>, <span class="st">"May"</span>,<span class="st">"June"</span>,<span class="st">"July"</span>,<span class="st">"August"</span>,<span class="st">"September"</span>,<span class="st">"October"</span>,<span class="st">"November"</span>,<span class="st">"December"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.nan</span>(x_zs), <span class="sc">!</span><span class="fu">is.nan</span>(y_zs)) <span class="sc">%&gt;%</span> <span class="co"># sf hates NaN! Not needed anymore, NaN's are managed above in the code.</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">as.character</span>(group),</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">ID     =</span> <span class="fu">as.character</span>(ID),</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cond      =</span> <span class="fu">as.character</span>(Cond),</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">repetition     =</span> <span class="fu">as.integer</span>(repetition),</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">dataSource =</span> <span class="fu">as.character</span>(dataSource)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># arrange(ID, Cond, repetition,group) %&gt;%</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Cond, repetition,group) <span class="sc">%&gt;%</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">geometry =</span> <span class="fu">st_sfc</span>(<span class="fu">st_linestring</span>(<span class="fu">as.matrix</span>(<span class="fu">cbind</span>(x_zs, y_zs)))), <span class="co"># preserves order</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">crs =</span> <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="segment-length" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="segment-length"><span class="header-section-number">7.2.1</span> Segment length</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>ds_segm<span class="sc">$</span>leng <span class="ot">&lt;-</span> <span class="fu">st_length</span>(ds_segm)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>ds_segm <span class="ot">&lt;-</span> ds_segm <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">segm_leng_GA =</span> <span class="fu">mean</span>(leng, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>ds_Q <span class="ot">&lt;-</span> <span class="fu">right_join</span>(ds_Q, </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                ds_segm <span class="sc">%&gt;%</span> </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>                <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>                <span class="fu">select</span>(ID, segm_leng_GA),<span class="at">by =</span> <span class="st">"ID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="polygon-based-geometries" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="polygon-based-geometries"><span class="header-section-number">7.3</span> Polygon based geometries</h2>
<section id="polygon-area" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="polygon-area"><span class="header-section-number">7.3.1</span> Polygon area</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>ds_poly          <span class="ot">&lt;-</span> <span class="fu">st_cast</span>(ds_segm, <span class="st">"POLYGON"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>ds_poly<span class="sc">$</span>area     <span class="ot">&lt;-</span> <span class="fu">st_area</span>(ds_poly)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>ds_poly <span class="ot">&lt;-</span> ds_poly <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">areaPoly_GA =</span> <span class="fu">mean</span>(area, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>ds_Q <span class="ot">&lt;-</span> <span class="fu">right_join</span>(ds_Q, </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>                   ds_poly <span class="sc">%&gt;%</span> <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, areaPoly_GA),</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by =</span> <span class="st">"ID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="polygon-simplicity" class="level3" data-number="7.3.2">
<h3 data-number="7.3.2" class="anchored" data-anchor-id="polygon-simplicity"><span class="header-section-number">7.3.2</span> Polygon simplicity</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Might depend on cast:</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>ds_poly          <span class="ot">&lt;-</span> <span class="fu">st_cast</span>(ds_segm, <span class="st">"POLYGON"</span>, <span class="at">group_or_split =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>ds_poly<span class="sc">$</span>isSimple <span class="ot">&lt;-</span> <span class="fu">st_is_simple</span>(ds_poly)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>ds_poly <span class="ot">&lt;-</span> ds_poly <span class="sc">%&gt;%</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">isSimple_GA =</span> <span class="fu">mean</span>(isSimple, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>ds_Q <span class="ot">&lt;-</span> <span class="fu">right_join</span>(ds_Q, </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>                   ds_poly <span class="sc">%&gt;%</span> <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, isSimple_GA),</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by =</span> <span class="st">"ID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="topological-validity-structure" class="level3" data-number="7.3.3">
<h3 data-number="7.3.3" class="anchored" data-anchor-id="topological-validity-structure"><span class="header-section-number">7.3.3</span> Topological validity Structure</h3>
<p>From the package description: <em>â€œFor projected geometries, st_make_valid uses the lwgeom_makevalid method also used by the PostGIS command ST_makevalid if the GEOS version linked to is smaller than 3.8.0, and otherwise the version shipped in GEOS; for geometries having ellipsoidal coordinates s2::s2_rebuild is being used.â€</em> From <a href="https://postgis.net/docs/ST_IsValid.html" class="uri">https://postgis.net/docs/ST_IsValid.html</a>: <em>value is well-formed and valid in 2D according to the OGC rules.</em> (Open Geopsatial Consotrtium)</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>ds_poly<span class="sc">$</span>isValidStruct <span class="ot">&lt;-</span> <span class="fu">st_is_valid</span>(ds_poly, <span class="at">geos_method =</span> <span class="st">"valid_structure"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ds_poly &lt;- ds_poly %&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(ID) %&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(Sum_isValidStruct = sum(isValidStruct, na.rm = TRUE))</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ds_Q &lt;- right_join(ds_Q, </span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                    ds_poly %&gt;% st_drop_geometry() %&gt;% ungroup() %&gt;% group_by(ID) %&gt;% filter(row_number() == 1) %&gt;% select(ID, Sum_isValidStruct),</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                    by = "ID")</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>ds_poly <span class="ot">&lt;-</span> ds_poly <span class="sc">%&gt;%</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">isValidStruct_GA =</span> <span class="fu">mean</span>(isValidStruct, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>ds_Q <span class="ot">&lt;-</span> <span class="fu">right_join</span>(ds_Q, </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>                   ds_poly <span class="sc">%&gt;%</span> <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, isValidStruct_GA),</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by =</span> <span class="st">"ID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="permutations" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Permutations</h1>
<p>Until now the form based features are computed by chronologically ordered repetitions. For example, Monday is repeated three times per ID. The coordinates for Monday presented the first time will always be used to form the segment/polygon with the Tuesday presented the first time. However, for consistency, this should be independent from chronological order. To circumvent this, we can permute the repetitions per conditions. I predict the permuted averages of the same features should give rise to better AUC. Since these are time consuming I will only apply permutations on the criteria that are at stake:<br>
topological validity.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>ds_perm <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">"permuted_isValid.csv"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># read.csv2("permuted_isValid.csv")</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>ds_Perm_perID <span class="ot">&lt;-</span>  ds_perm <span class="sc">%&gt;%</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">isValid_M_perm_ID =</span> <span class="fu">mean</span>(<span class="fu">c_across</span>(n_perm001<span class="sc">:</span>n_perm100)), <span class="at">isValid_Med_perm_ID =</span> <span class="fu">median</span>(<span class="fu">c_across</span>(n_perm001<span class="sc">:</span>n_perm100))) <span class="sc">%&gt;%</span> </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span> (ID, group, isValid_M_perm_ID, isValid_Med_perm_ID)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>ds_Q <span class="ot">&lt;-</span> <span class="fu">right_join</span>(ds_Q, </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>                   ds_Perm_perID <span class="sc">%&gt;%</span> <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(ID) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, isValid_M_perm_ID, isValid_Med_perm_ID),</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by =</span> <span class="st">"ID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="combine-valid-and-area-criteria" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Combine valid and area criteria</h1>
<p>What if we combined consistency and permuted topological validity?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>Model3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(group <span class="sc">~</span>  rep_area_GAzs <span class="sc">+</span>isValid_M_perm_ID, <span class="at">data =</span> ds_Q, <span class="at">family =</span> binomial)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>pred3 <span class="ot">=</span> <span class="fu">predict</span>(Model3)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>ds_Q<span class="sc">$</span>GLMValid_area_zs <span class="ot">&lt;-</span> pred3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="combine-sd_x-and-area-criteria" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Combine SD_x and area criteria</h1>
<p>Like in Ward</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>Model3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(group <span class="sc">~</span> SD_x <span class="sc">+</span> rep_area_GAzs , <span class="at">data =</span> ds_Q, <span class="at">family =</span> binomial)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>pred3 <span class="ot">=</span> <span class="fu">predict</span>(Model3)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>ds_Q<span class="sc">$</span>GLMSD_area_zs <span class="ot">&lt;-</span> pred3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="compare-all-features" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Compare all features:</h1>
<section id="compute-all-roc" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="compute-all-roc"><span class="header-section-number">11.1</span> Compute all ROC</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Define function to compute ROC:</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>Comp_ROC <span class="ot">&lt;-</span> <span class="cf">function</span>(data, group_col, feature, ID, Ord){</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ord: must be: moreSyn or moreCtl. Wheter feature value is moer in Syn or ctl.</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">setequal</span>(<span class="fu">levels</span>(data[[group_col]]), <span class="fu">c</span>(<span class="st">"Syn"</span>,<span class="st">"Ctl"</span>))){</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">warning</span>(<span class="st">"group name must inculde: Syn Ctl"</span>))</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (Ord <span class="sc">==</span> <span class="st">"moreSyn"</span>) {</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    Dirhere <span class="ot">&lt;-</span> <span class="st">"&lt;"</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (Ord <span class="sc">==</span> <span class="st">"moreCtl"</span>) {</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    Dirhere <span class="ot">&lt;-</span> <span class="st">"&gt;"</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">warning</span>(<span class="st">"Ord must be moreSyn or moreCtl"</span>))  </span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="do">################ ROC analyses ################ </span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  ROC_here <span class="ot">&lt;-</span> pROC<span class="sc">::</span><span class="fu">roc</span>(data[[group_col]] <span class="sc">~</span> data[[feature]], data, </span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">direction=</span> Dirhere,</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">percent=</span><span class="cn">TRUE</span>,</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># arguments for ci</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ci=</span><span class="cn">TRUE</span>, <span class="at">boot.n=</span><span class="dv">100</span>, <span class="at">ci.alpha=</span><span class="fl">0.9</span>, <span class="at">stratified=</span><span class="cn">FALSE</span>,</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># arguments for plot</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>                  <span class="at">plot=</span><span class="cn">FALSE</span>, <span class="at">auc.polygon=</span><span class="cn">TRUE</span>, <span class="at">max.auc.polygon=</span><span class="cn">TRUE</span>, <span class="at">grid=</span><span class="cn">TRUE</span>,</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>                  <span class="at">print.auc=</span><span class="cn">TRUE</span>, <span class="at">show.thres=</span><span class="cn">TRUE</span>, <span class="at">print.thres =</span> <span class="st">"best"</span>, <span class="at">print.thres.best.method=</span><span class="st">"youden"</span>)</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Best threshold using Youden's J</span></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>  best_coords <span class="ot">&lt;-</span> pROC<span class="sc">::</span><span class="fu">coords</span>(ROC_here, <span class="st">"best"</span>, </span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>                              <span class="at">ret =</span> <span class="fu">c</span>(<span class="st">"accuracy"</span>,<span class="st">"threshold"</span>, <span class="st">"sensitivity"</span>,<span class="st">"specificity"</span>,<span class="st">"ppv"</span>,<span class="st">"npv"</span>), </span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>                              <span class="at">best.method =</span> <span class="st">"youden"</span>)</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>  auc_val <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(pROC<span class="sc">::</span><span class="fu">auc</span>(ROC_here))</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>  ci_auc  <span class="ot">&lt;-</span> <span class="fu">ci.auc</span>(ROC_here)</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>  new_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">Feature   =</span> feature,</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">AUC        =</span> <span class="fu">round</span>(auc_val, <span class="dv">4</span>),</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">threshold  =</span> <span class="fu">as.numeric</span>(best_coords[[<span class="st">"threshold"</span>]]),</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">sensitivity=</span> <span class="fu">as.numeric</span>(best_coords[[<span class="st">"sensitivity"</span>]]),</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">specificity=</span> <span class="fu">as.numeric</span>(best_coords[[<span class="st">"specificity"</span>]]),</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">ppv        =</span> <span class="fu">as.numeric</span>(best_coords[[<span class="st">"ppv"</span>]]),</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">npv        =</span> <span class="fu">as.numeric</span>(best_coords[[<span class="st">"npv"</span>]]),</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_low     =</span> <span class="fu">as.numeric</span>(ci_auc[<span class="dv">1</span>]),</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_high    =</span> <span class="fu">as.numeric</span>(ci_auc[<span class="dv">3</span>]),</span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>  <span class="do">################ Contingency table ################ </span></span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (Ord <span class="sc">==</span> <span class="st">"moreSyn"</span>) {</span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>diagnosis <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data[[feature]] <span class="sc">&gt;=</span> best_coords<span class="sc">$</span>threshold,  <span class="st">"Test : Syn"</span>, <span class="st">"Test : Ctl"</span>)</span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (Ord <span class="sc">==</span> <span class="st">"moreCtl"</span>) {</span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>diagnosis <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data[[feature]] <span class="sc">&gt;=</span> best_coords<span class="sc">$</span>threshold,  <span class="st">"Test : Ctl"</span>,<span class="st">"Test : Syn"</span>)</span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="st">"Ord must be moreSyn or moreCtl"</span>)  </span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>  tab_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(data[[group_col]], data<span class="sc">$</span>diagnosis)</span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a>  tab_percent <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(tab_counts, <span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(tab_counts, <span class="st">" ("</span>, <span class="fu">round</span>(tab_percent, <span class="dv">1</span>), <span class="st">"%)"</span>),</span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="fu">nrow</span>(tab_counts),</span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">dimnames =</span> <span class="fu">dimnames</span>(tab_counts)</span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a>  <span class="do">################ Mosaic plot of the contigency table #############</span></span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a>  <span class="co"># gp1 &lt;- data %&gt;%</span></span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   # mutate(test_out = SD_ID_ysc &gt; best_coords[["threshold"]]) %&gt;%</span></span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   ggplot() +</span></span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   geom_mosaic(aes(x = product(diagnosis, [[group_col]]), fill = diagnosis)) +</span></span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   scale_fill_manual(values = c("#66C2A5","#FC8D62")) +</span></span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   geom_mosaic_text(aes(x = product(diagnosis, [[group_col]]), label = after_stat(.wt))) +</span></span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   theme_minimal()</span></span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-79"><a href="#cb27-79" aria-hidden="true" tabindex="-1"></a>  <span class="do">################ General description ################ </span></span>
<span id="cb27-80"><a href="#cb27-80" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Attention, na removed  </span></span>
<span id="cb27-81"><a href="#cb27-81" aria-hidden="true" tabindex="-1"></a>  Descr_table <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb27-82"><a href="#cb27-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="sc">!!</span><span class="fu">sym</span>(group_col)) <span class="sc">%&gt;%</span></span>
<span id="cb27-83"><a href="#cb27-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">length</span>(<span class="fu">unique</span>(<span class="sc">!!</span><span class="fu">sym</span>(ID))), <span class="at">Mean =</span> <span class="fu">mean</span>(<span class="sc">!!</span><span class="fu">sym</span>(feature), <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">SD =</span> <span class="fu">sd</span>(<span class="sc">!!</span><span class="fu">sym</span>(feature), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb27-84"><a href="#cb27-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-85"><a href="#cb27-85" aria-hidden="true" tabindex="-1"></a>  <span class="do">################ Return outputs ################ </span></span>
<span id="cb27-86"><a href="#cb27-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">ROC_properties =</span> new_row, <span class="at">Coningency_table =</span>result, <span class="at">Descr_table =</span> Descr_table, <span class="at">ROC_curve =</span> ROC_here))</span>
<span id="cb27-87"><a href="#cb27-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-88"><a href="#cb27-88" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>all_cols <span class="ot">&lt;-</span> <span class="fu">colnames</span>(ds_Q)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>feature_list      <span class="ot">&lt;-</span> all_cols[<span class="dv">43</span><span class="sc">:</span><span class="fu">length</span>(all_cols)]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># feature_direction &lt;- c(rep("moreSyn",2),rep("moreCtl",4),rep("moreSyn",8))</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>feature_direction <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"moreSyn"</span>,<span class="dv">2</span>),<span class="fu">rep</span>(<span class="st">"moreCtl"</span>,<span class="dv">5</span>),<span class="fu">rep</span>(<span class="st">"moreSyn"</span>,<span class="dv">8</span>))</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Visual check if correct matches:</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># rbind(feature_list,feature_direction)</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we will loop through features:</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co"># INITIALIZE ROC_curves</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>ROC_curves <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>ROC_contingency <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize dataframe to collect relevant ROC values:</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>All_ROC <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Feature=</span><span class="fu">character</span>(),</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>                      <span class="at">AUC =</span> <span class="fu">character</span>(),</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">threshold=</span><span class="fu">integer</span>(),</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sensitivity=</span><span class="fu">integer</span>(),</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">specificity=</span><span class="fu">integer</span>(),</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ppv =</span> <span class="fu">integer</span>(),</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>                 <span class="at">npv =</span> <span class="fu">integer</span>(),</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">high_ci =</span> <span class="fu">integer</span>(),</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">low_ci =</span> <span class="fu">integer</span>(),</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">stringsAsFactors=</span><span class="cn">FALSE</span>)</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop by features:</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(fit_n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(feature_list)){</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>  ROC_here <span class="ot">&lt;-</span> <span class="fu">Comp_ROC</span>(ds_Q, <span class="st">"group"</span>, feature_list[fit_n],<span class="st">"ID"</span>,feature_direction[fit_n])</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>  ROC_curves      <span class="ot">&lt;-</span> <span class="fu">c</span>(ROC_curves,<span class="fu">list</span>(ROC_here<span class="sc">$</span>ROC_curve,ROC_here<span class="sc">$</span>ROC_properties<span class="sc">$</span>Feature))</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>  All_ROC         <span class="ot">&lt;-</span> <span class="fu">rbind</span>(All_ROC, ROC_here<span class="sc">$</span>ROC_properties)</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>  ROC_contingency <span class="ot">&lt;-</span> <span class="fu">c</span>(ROC_contingency,<span class="fu">list</span>(ROC_here<span class="sc">$</span>Coningency_table,ROC_here<span class="sc">$</span>ROC_properties<span class="sc">$</span>Feature))</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="summaries" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Summaries</h1>
<section id="summary-table" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="summary-table"><span class="header-section-number">12.1</span> Summary table:</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>All_ROC_round <span class="ot">&lt;-</span> All_ROC <span class="sc">%&gt;%</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_if</span>(is.numeric, round,<span class="dv">2</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>All_ROC_round <span class="ot">&lt;-</span> All_ROC_round[<span class="fu">order</span>(All_ROC_round<span class="sc">$</span>AUC, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Add colours for a nice table:</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>n_color <span class="ot">&lt;-</span> <span class="fu">length</span>(All_ROC_round<span class="sc">$</span>Feature)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>All_ROC_round[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(All_ROC_round[<span class="dv">2</span>], <span class="cf">function</span>(x) {</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cell_spec</span>(x, <span class="at">bold =</span> T, </span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">background  =</span> <span class="fu">spec_color</span>(x, <span class="at">end =</span> <span class="fl">0.9</span>,  <span class="at">palette =</span> paletteer<span class="sc">::</span><span class="fu">paletteer_c</span>(<span class="st">"ggthemes::Red-Green Diverging"</span>, n_color), <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span> ),</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>All_ROC_round[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(All_ROC_round[<span class="dv">4</span>], <span class="cf">function</span>(x) {</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cell_spec</span>(x, <span class="at">bold =</span> T, </span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">background  =</span> <span class="fu">spec_color</span>(x, <span class="at">end =</span> <span class="fl">0.9</span>,  <span class="at">palette =</span> paletteer<span class="sc">::</span><span class="fu">paletteer_c</span>(<span class="st">"ggthemes::Red-Green Diverging"</span>, n_color), <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span> ),</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>All_ROC_round[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(All_ROC_round[<span class="dv">5</span>], <span class="cf">function</span>(x) {</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cell_spec</span>(x, <span class="at">bold =</span> T, </span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">background =</span> <span class="fu">spec_color</span>(x, <span class="at">end =</span> <span class="fl">0.9</span>,  <span class="at">palette =</span> paletteer<span class="sc">::</span><span class="fu">paletteer_c</span>(<span class="st">"ggthemes::Red-Green Diverging"</span>, n_color), <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span> ),</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(All_ROC_round, <span class="at">escape =</span> F, <span class="at">align =</span> <span class="st">"c"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="st">"striped"</span>, <span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic lightable-striped caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Feature</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">AUC</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">threshold</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">sensitivity</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">specificity</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">ppv</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">npv</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">ci_low</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">ci_high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">13</td>
<td style="text-align: center;">GLMValid_area_zs</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(36, 105, 61, 255) !important;">81.83</span></td>
<td style="text-align: center;">-0.14</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(186, 209, 174, 255) !important;">74.75</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(51, 123, 69, 255) !important;">76.92</span></td>
<td style="text-align: center;">77.89</td>
<td style="text-align: center;">73.68</td>
<td style="text-align: center;">78.36</td>
<td style="text-align: center;">85.31</td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: center;">isValid_M_perm_ID</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(36, 105, 61, 255) !important;">81.21</span></td>
<td style="text-align: center;">0.15</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(240, 157, 133, 255) !important;">71.38</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(36, 105, 61, 255) !important;">79.12</span></td>
<td style="text-align: center;">78.81</td>
<td style="text-align: center;">71.76</td>
<td style="text-align: center;">77.68</td>
<td style="text-align: center;">84.75</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: center;">triangle_perim_GA_zs</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(51, 123, 69, 255) !important;">79.7</span></td>
<td style="text-align: center;">1.92</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(186, 209, 174, 255) !important;">75.42</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(66, 142, 77, 255) !important;">74.73</span></td>
<td style="text-align: center;">76.45</td>
<td style="text-align: center;">73.65</td>
<td style="text-align: center;">75.92</td>
<td style="text-align: center;">83.49</td>
</tr>
<tr class="even">
<td style="text-align: left;">12</td>
<td style="text-align: center;">isValid_Med_perm_ID</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(51, 123, 69, 255) !important;">79.66</span></td>
<td style="text-align: center;">0.14</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(236, 91, 82, 255) !important;">67.34</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(36, 105, 61, 255) !important;">79.49</span></td>
<td style="text-align: center;">78.13</td>
<td style="text-align: center;">69.11</td>
<td style="text-align: center;">76.10</td>
<td style="text-align: center;">83.22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: center;">isValidStruct_GA</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(66, 142, 77, 255) !important;">77.85</span></td>
<td style="text-align: center;">0.17</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(240, 157, 133, 255) !important;">70.71</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(51, 123, 69, 255) !important;">75.46</span></td>
<td style="text-align: center;">75.81</td>
<td style="text-align: center;">70.31</td>
<td style="text-align: center;">74.12</td>
<td style="text-align: center;">81.57</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: center;">SelfInter_persegm</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(86, 161, 87, 255) !important;">74.26</span></td>
<td style="text-align: center;">1.17</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(108, 180, 99, 255) !important;">79.46</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(145, 195, 131, 255) !important;">62.64</span></td>
<td style="text-align: center;">69.82</td>
<td style="text-align: center;">73.71</td>
<td style="text-align: center;">70.13</td>
<td style="text-align: center;">78.38</td>
</tr>
<tr class="odd">
<td style="text-align: left;">14</td>
<td style="text-align: center;">GLMSD_area_zs</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(108, 180, 99, 255) !important;">72.8</span></td>
<td style="text-align: center;">0.14</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(66, 142, 77, 255) !important;">84.18</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(186, 209, 174, 255) !important;">59.34</span></td>
<td style="text-align: center;">69.25</td>
<td style="text-align: center;">77.51</td>
<td style="text-align: center;">68.53</td>
<td style="text-align: center;">77.08</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: center;">areaPoly_GA</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(108, 180, 99, 255) !important;">70.91</span></td>
<td style="text-align: center;">1.29</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(163, 18, 58, 255) !important;">60.61</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(86, 161, 87, 255) !important;">70.7</span></td>
<td style="text-align: center;">69.23</td>
<td style="text-align: center;">62.26</td>
<td style="text-align: center;">66.72</td>
<td style="text-align: center;">75.11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: center;">rep_area_GAzs</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(145, 195, 131, 255) !important;">69.81</span></td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(186, 209, 174, 255) !important;">76.43</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(145, 195, 131, 255) !important;">64.84</span></td>
<td style="text-align: center;">70.28</td>
<td style="text-align: center;">71.66</td>
<td style="text-align: center;">65.22</td>
<td style="text-align: center;">74.40</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: center;">isSimple_GA</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(145, 195, 131, 255) !important;">68.78</span></td>
<td style="text-align: center;">0.28</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(163, 18, 58, 255) !important;">60.94</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(86, 161, 87, 255) !important;">69.6</span></td>
<td style="text-align: center;">68.56</td>
<td style="text-align: center;">62.09</td>
<td style="text-align: center;">64.46</td>
<td style="text-align: center;">73.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: center;">SD_y</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(145, 195, 131, 255) !important;">68.41</span></td>
<td style="text-align: center;">0.12</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(108, 180, 99, 255) !important;">80.47</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(186, 209, 174, 255) !important;">59.71</span></td>
<td style="text-align: center;">68.48</td>
<td style="text-align: center;">73.76</td>
<td style="text-align: center;">63.85</td>
<td style="text-align: center;">72.96</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: center;">segm_leng_GA</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(220, 196, 174, 255) !important;">63.07</span></td>
<td style="text-align: center;">7.86</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(66, 142, 77, 255) !important;">83.84</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(236, 91, 82, 255) !important;">48.72</span></td>
<td style="text-align: center;">64.01</td>
<td style="text-align: center;">73.48</td>
<td style="text-align: center;">58.34</td>
<td style="text-align: center;">67.81</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: center;">SD_x</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(240, 157, 133, 255) !important;">61.2</span></td>
<td style="text-align: center;">0.12</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(36, 105, 61, 255) !important;">88.22</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(222, 60, 66, 255) !important;">44.69</span></td>
<td style="text-align: center;">63.44</td>
<td style="text-align: center;">77.71</td>
<td style="text-align: center;">56.36</td>
<td style="text-align: center;">66.05</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: center;">rep_area</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(163, 18, 58, 255) !important;">49.26</span></td>
<td style="text-align: center;">2338.97</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(186, 209, 174, 255) !important;">76.09</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(163, 18, 58, 255) !important;">38.83</span></td>
<td style="text-align: center;">57.51</td>
<td style="text-align: center;">59.89</td>
<td style="text-align: center;">44.27</td>
<td style="text-align: center;">54.25</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="summary-plot" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="summary-plot"><span class="header-section-number">12.2</span> Summary plot</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>nFeat <span class="ot">&lt;-</span> <span class="fu">length</span>(ROC_curves)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>Odd_idx  <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,nFeat,<span class="at">by=</span><span class="dv">2</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>Pair_idx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>,nFeat,<span class="at">by=</span><span class="dv">2</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>ROC_listed <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>Feattype <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nFeat){</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  ROC_listed[[i]] <span class="ot">&lt;-</span> ROC_curves[[Odd_idx[i]]]</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  Feattype <span class="ot">&lt;-</span> <span class="fu">c</span>(Feattype,ROC_curves[[Pair_idx[i]]])</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggroc</span>(ROC_listed) <span class="sc">+</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">xend =</span> <span class="dv">100</span>, <span class="at">y =</span> <span class="dv">100</span>, <span class="at">yend =</span> <span class="dv">0</span>),</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">"grey"</span>, <span class="at">size =</span> <span class="fl">0.01</span>) <span class="sc">+</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">labels =</span> Feattype,<span class="at">values =</span>pals<span class="sc">::</span><span class="fu">cols25</span>(nFeat)) <span class="sc">+</span> </span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="2.Pre-registeredReport_V5_mini_files/figure-html/summaryplot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="summary-excluding-overlapping-responses" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Summary excluding overlapping responses</h1>
<p>We remove 84 participants that have overlapping responses in one conditions (i.e.&nbsp;the exact same coordinate responses for all repetitions in one conditions).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>ds_Q2 <span class="ot">&lt;-</span> ds_Q <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>isSame_xy)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we will loop through features:</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># INITIALIZE ROC_curves</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>ROC_curves2 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>ROC_contingency2 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize dataframe to collect relevant ROC values:</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>All_ROC2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Feature=</span><span class="fu">character</span>(),</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">AUC =</span> <span class="fu">character</span>(),</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">threshold=</span><span class="fu">integer</span>(),</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sensitivity=</span><span class="fu">integer</span>(),</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">specificity=</span><span class="fu">integer</span>(),</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ppv =</span> <span class="fu">integer</span>(),</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">npv =</span> <span class="fu">integer</span>(),</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">high_ci =</span> <span class="fu">integer</span>(),</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">low_ci =</span> <span class="fu">integer</span>(),</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">stringsAsFactors=</span><span class="cn">FALSE</span>)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop by features:</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(fit_n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(feature_list)){</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  ROC_here2 <span class="ot">&lt;-</span> <span class="fu">Comp_ROC</span>(ds_Q2, <span class="st">"group"</span>, feature_list[fit_n],<span class="st">"ID"</span>,feature_direction[fit_n])</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>  ROC_curves2      <span class="ot">&lt;-</span> <span class="fu">c</span>(ROC_curves2,<span class="fu">list</span>(ROC_here2<span class="sc">$</span>ROC_curve,ROC_here2<span class="sc">$</span>ROC_properties<span class="sc">$</span>Feature))</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>  All_ROC2         <span class="ot">&lt;-</span> <span class="fu">rbind</span>(All_ROC2, ROC_here2<span class="sc">$</span>ROC_properties)</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>  ROC_contingency2 <span class="ot">&lt;-</span> <span class="fu">c</span>(ROC_contingency,<span class="fu">list</span>(ROC_here2<span class="sc">$</span>Coningency_table,ROC_here2<span class="sc">$</span>ROC_properties<span class="sc">$</span>Feature))</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>All_ROC_round2 <span class="ot">&lt;-</span> All_ROC2 <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_if</span>(is.numeric, round,<span class="dv">2</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>All_ROC_round2 <span class="ot">&lt;-</span> All_ROC_round2[<span class="fu">order</span>(All_ROC_round2<span class="sc">$</span>AUC, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Add colours for a nice table:</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>n_color <span class="ot">&lt;-</span> <span class="fu">length</span>(All_ROC_round2<span class="sc">$</span>Feature)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>All_ROC_round2[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(All_ROC_round2[<span class="dv">2</span>], <span class="cf">function</span>(x) {</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cell_spec</span>(x, <span class="at">bold =</span> T, </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">background  =</span> <span class="fu">spec_color</span>(x, <span class="at">end =</span> <span class="fl">0.9</span>,  <span class="at">palette =</span> paletteer<span class="sc">::</span><span class="fu">paletteer_c</span>(<span class="st">"ggthemes::Red-Green Diverging"</span>, n_color), <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span> ),</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>All_ROC_round2[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(All_ROC_round2[<span class="dv">4</span>], <span class="cf">function</span>(x) {</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cell_spec</span>(x, <span class="at">bold =</span> T, </span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">background  =</span> <span class="fu">spec_color</span>(x, <span class="at">end =</span> <span class="fl">0.9</span>,  <span class="at">palette =</span> paletteer<span class="sc">::</span><span class="fu">paletteer_c</span>(<span class="st">"ggthemes::Red-Green Diverging"</span>, n_color), <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span> ),</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>All_ROC_round2[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(All_ROC_round2[<span class="dv">5</span>], <span class="cf">function</span>(x) {</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cell_spec</span>(x, <span class="at">bold =</span> T, </span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">background =</span> <span class="fu">spec_color</span>(x, <span class="at">end =</span> <span class="fl">0.9</span>,  <span class="at">palette =</span> paletteer<span class="sc">::</span><span class="fu">paletteer_c</span>(<span class="st">"ggthemes::Red-Green Diverging"</span>, n_color), <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span> ),</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(All_ROC_round2, <span class="at">escape =</span> F, <span class="at">align =</span> <span class="st">"c"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="st">"striped"</span>, <span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic lightable-striped caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Feature</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">AUC</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">threshold</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">sensitivity</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">specificity</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">ppv</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">npv</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">ci_low</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">ci_high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">13</td>
<td style="text-align: center;">GLMValid_area_zs</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(36, 105, 61, 255) !important;">80.02</span></td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(145, 195, 131, 255) !important;">72.63</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(66, 142, 77, 255) !important;">74.63</span></td>
<td style="text-align: center;">80.23</td>
<td style="text-align: center;">65.79</td>
<td style="text-align: center;">76.05</td>
<td style="text-align: center;">83.99</td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: center;">isValid_M_perm_ID</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(51, 123, 69, 255) !important;">78.7</span></td>
<td style="text-align: center;">0.20</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(186, 209, 174, 255) !important;">66.32</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(51, 123, 69, 255) !important;">80.1</span></td>
<td style="text-align: center;">82.53</td>
<td style="text-align: center;">62.65</td>
<td style="text-align: center;">74.61</td>
<td style="text-align: center;">82.78</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: center;">triangle_perim_GA_zs</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(51, 123, 69, 255) !important;">77.62</span></td>
<td style="text-align: center;">1.57</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(145, 195, 131, 255) !important;">70.88</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(66, 142, 77, 255) !important;">76.12</span></td>
<td style="text-align: center;">80.80</td>
<td style="text-align: center;">64.83</td>
<td style="text-align: center;">73.18</td>
<td style="text-align: center;">82.06</td>
</tr>
<tr class="even">
<td style="text-align: left;">12</td>
<td style="text-align: center;">isValid_Med_perm_ID</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(51, 123, 69, 255) !important;">77.09</span></td>
<td style="text-align: center;">0.31</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(245, 120, 101, 255) !important;">56.14</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(36, 105, 61, 255) !important;">86.07</span></td>
<td style="text-align: center;">85.11</td>
<td style="text-align: center;">58.05</td>
<td style="text-align: center;">72.98</td>
<td style="text-align: center;">81.20</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: center;">rep_area_GAzs</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(66, 142, 77, 255) !important;">76.08</span></td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(108, 180, 99, 255) !important;">76.84</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(86, 161, 87, 255) !important;">70.65</span></td>
<td style="text-align: center;">78.78</td>
<td style="text-align: center;">68.27</td>
<td style="text-align: center;">71.49</td>
<td style="text-align: center;">80.67</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: center;">isSimple_GA</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(66, 142, 77, 255) !important;">75.92</span></td>
<td style="text-align: center;">0.28</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(240, 157, 133, 255) !important;">60.7</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(51, 123, 69, 255) !important;">80.6</span></td>
<td style="text-align: center;">81.60</td>
<td style="text-align: center;">59.12</td>
<td style="text-align: center;">71.70</td>
<td style="text-align: center;">80.13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: center;">isValidStruct_GA</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(66, 142, 77, 255) !important;">75.38</span></td>
<td style="text-align: center;">0.17</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(145, 195, 131, 255) !important;">73.33</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(108, 180, 99, 255) !important;">67.16</span></td>
<td style="text-align: center;">76.00</td>
<td style="text-align: center;">63.98</td>
<td style="text-align: center;">71.13</td>
<td style="text-align: center;">79.64</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: center;">segm_leng_GA</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(108, 180, 99, 255) !important;">71.2</span></td>
<td style="text-align: center;">7.86</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(66, 142, 77, 255) !important;">83.51</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(145, 195, 131, 255) !important;">62.69</span></td>
<td style="text-align: center;">76.04</td>
<td style="text-align: center;">72.83</td>
<td style="text-align: center;">66.15</td>
<td style="text-align: center;">76.25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: center;">SelfInter_persegm</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(145, 195, 131, 255) !important;">67.85</span></td>
<td style="text-align: center;">1.17</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(66, 142, 77, 255) !important;">82.11</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(240, 157, 133, 255) !important;">49.25</span></td>
<td style="text-align: center;">69.64</td>
<td style="text-align: center;">66.00</td>
<td style="text-align: center;">62.89</td>
<td style="text-align: center;">72.80</td>
</tr>
<tr class="even">
<td style="text-align: left;">14</td>
<td style="text-align: center;">GLMSD_area_zs</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(186, 209, 174, 255) !important;">67.02</span></td>
<td style="text-align: center;">-0.04</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(36, 105, 61, 255) !important;">90.53</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(245, 120, 101, 255) !important;">42.29</span></td>
<td style="text-align: center;">68.98</td>
<td style="text-align: center;">75.89</td>
<td style="text-align: center;">61.87</td>
<td style="text-align: center;">72.16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: center;">areaPoly_GA</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(186, 209, 174, 255) !important;">64.78</span></td>
<td style="text-align: center;">1.92</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(163, 18, 58, 255) !important;">41.05</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(51, 123, 69, 255) !important;">83.08</span></td>
<td style="text-align: center;">77.48</td>
<td style="text-align: center;">49.85</td>
<td style="text-align: center;">59.90</td>
<td style="text-align: center;">69.66</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: center;">SD_y</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(240, 157, 133, 255) !important;">61.4</span></td>
<td style="text-align: center;">0.11</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(66, 142, 77, 255) !important;">84.21</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(245, 120, 101, 255) !important;">44.28</span></td>
<td style="text-align: center;">68.18</td>
<td style="text-align: center;">66.42</td>
<td style="text-align: center;">56.01</td>
<td style="text-align: center;">66.79</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: center;">rep_area</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(240, 157, 133, 255) !important;">60.27</span></td>
<td style="text-align: center;">2124.47</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(145, 195, 131, 255) !important;">72.28</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(220, 196, 174, 255) !important;">53.23</span></td>
<td style="text-align: center;">68.67</td>
<td style="text-align: center;">57.53</td>
<td style="text-align: center;">54.88</td>
<td style="text-align: center;">65.65</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: center;">SD_x</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(163, 18, 58, 255) !important;">49.49</span></td>
<td style="text-align: center;">0.12</td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(36, 105, 61, 255) !important;">91.58</span></td>
<td style="text-align: center;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: rgba(163, 18, 58, 255) !important;">24.88</span></td>
<td style="text-align: center;">63.35</td>
<td style="text-align: center;">67.57</td>
<td style="text-align: center;">43.95</td>
<td style="text-align: center;">55.03</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="summary-plot-1" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="summary-plot-1"><span class="header-section-number">13.1</span> Summary plot</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>nFeat <span class="ot">&lt;-</span> <span class="fu">length</span>(ROC_curves2)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>Odd_idx  <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,nFeat,<span class="at">by=</span><span class="dv">2</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>Pair_idx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>,nFeat,<span class="at">by=</span><span class="dv">2</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>ROC_listed2 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>Feattype <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nFeat){</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  ROC_listed2[[i]] <span class="ot">&lt;-</span> ROC_curves2[[Odd_idx[i]]]</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  Feattype <span class="ot">&lt;-</span> <span class="fu">c</span>(Feattype,ROC_curves2[[Pair_idx[i]]])</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggroc</span>(ROC_listed2) <span class="sc">+</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">xend =</span> <span class="dv">100</span>, <span class="at">y =</span> <span class="dv">100</span>, <span class="at">yend =</span> <span class="dv">0</span>),</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">"grey"</span>, <span class="at">size =</span> <span class="fl">0.01</span>) <span class="sc">+</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">labels =</span> Feattype,<span class="at">values =</span>pals<span class="sc">::</span><span class="fu">cols25</span>(nFeat)) <span class="sc">+</span> </span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="2.Pre-registeredReport_V5_mini_files/figure-html/no%20OverlapPlot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="compare-consistency-and-validity" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="compare-consistency-and-validity"><span class="header-section-number">13.2</span> Compare Consistency and validity</h2>
<p>When removing the overlapping responses both criteria seems to work at pairs!</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>ROC_Valid <span class="ot">&lt;-</span> <span class="fu">plot.roc</span>(group <span class="sc">~</span> isValid_M_perm_ID , ds_Q, <span class="at">percent =</span> <span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>ROC_Cons  <span class="ot">&lt;-</span> <span class="fu">lines.roc</span>(group <span class="sc">~</span> rep_area_GAzs , ds_Q, <span class="at">percent =</span> <span class="cn">TRUE</span>,<span class="at">col =</span><span class="st">"green"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="2.Pre-registeredReport_V5_mini_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">roc.test</span>(ROC_Valid, ROC_Cons)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bootstrap test for two correlated ROC curves

data:  ROC_Valid and ROC_Cons
D = 4.5434, boot.n = 2000, boot.stratified = 1, p-value = 5.535e-06
alternative hypothesis: true difference in AUC is not equal to 0
sample estimates:
AUC of roc1 AUC of roc2 
   81.21138    69.80982 </code></pre>
</div>
</div>
</section>
<section id="phase-ii-methods" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="phase-ii-methods"><span class="header-section-number">13.3</span> <em>Phase II</em> Methods</h2>
</section>
<section id="phase-ii-materials" class="level2" data-number="13.4">
<h2 data-number="13.4" class="anchored" data-anchor-id="phase-ii-materials"><span class="header-section-number">13.4</span> <em>Phase II</em> Materials:</h2>
<p>Materials are described here <a href="https://osf.io/pjb6e/?view_only=d467ebf4c1f94076ae4ac61298255065" class="uri">https://osf.io/pjb6e/?view_only=d467ebf4c1f94076ae4ac61298255065</a>.</p>
</section>
<section id="phase-ii-planned-population" class="level2" data-number="13.5">
<h2 data-number="13.5" class="anchored" data-anchor-id="phase-ii-planned-population"><span class="header-section-number">13.5</span> <em>Phase II</em> Planned population</h2>
<p><a href="https://osf.io/6h8dx"><strong>https://osf.io/6h8dx</strong></a></p>
</section>
</section>
<section id="discussion" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> Discussion</h1>
<p>From the different features we extracted, topological validity across the repetitions appeared to be the one leading to the largest Area Under the Curve. The optimal cutoff was exactly 1.5, leading to a sensitivity () and specificity ().</p>
<p>The optimal criterion ineeds to be informed about the order between inducers (i.e.&nbsp;to construct the polygons) and interestingly suggests that synthetic inducer are structurally mapped following topological rules analogous to geographical space structures. Hence suggesting a spatial nature for the synthetic forms of space sequence synesthetes.</p>
<p>Although an optimal tool to discriminate SSS might be particularly relevant for experimental purposes, it is important to consider some limitations. These consistency tools are designed with a limited set of sequential stimuli (i.e.&nbsp;months, weeks and the first ten natural numbers). <!--# Diversity --> Other sequences might also be represented in particular spatial positions such as temperature, ect. <!--# Continuum --> Another point is that rather than categorical, synesthesia might be present on a continuum in the general population. In that case diagnostic cutoffs might not be relevant, rather a score would be necessary. <!--# Cirularity --> Finally, there might also be an issue of circularity - as with many diagnostics : how synesthesia is defined determines how synestetes are detected which are the groups on which synesthesia is defined. <!--# External validity --> This is particularly relevant when the two diagnostic criteria on which validity are compared are self-reports (i.e.&nbsp;being conscious) and consistency.</p>
<p>Overlapping responses. A methodological issue concerns participants that give the same responses across conditions. These responses are a complication since we canâ€™t infer whether those conditions did not give rise to a synesthetic response in a synthesete or whether it is from a control that was confused about the instructions. On a methodological level, those responses can critically bias the diagnostic criteria. On one side excluding those responses would imbalance the number of responses by participant, on the other side including these responses might bias the diagnostic.</p>
<p>See also <span class="citation" data-cites="root2025">(<a href="#ref-root2025" role="doc-biblioref">Root et al. 2025</a>)</span>.</p>
</section>
<section id="supplementary-per-conditions" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> Supplementary: per Conditions</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>All_ROC_Cond <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Feature=</span><span class="fu">character</span>(),</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">AUC =</span> <span class="fu">character</span>(),</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">threshold=</span><span class="fu">integer</span>(),</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sensitivity=</span><span class="fu">integer</span>(),</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">specificity=</span><span class="fu">integer</span>(),</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ppv =</span> <span class="fu">integer</span>(),</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">npv =</span> <span class="fu">integer</span>(),</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">high_ci =</span> <span class="fu">integer</span>(),</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">low_ci =</span> <span class="fu">integer</span>(),</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">stringsAsFactors=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="per-conditions" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="per-conditions"><span class="header-section-number">15.1</span> Per Conditions</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span>  </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(ID,repetition,Cond) <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Consistency_zs_Cond =</span> (<span class="fu">sum</span>(rep_area_zs)))</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>Cond_list <span class="ot">&lt;-</span> <span class="fu">unique</span>(ds<span class="sc">$</span>Cond)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ROC_curvesCond) <span class="co"># we are concatenating list, so make sure they don't already exist</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(Cond_i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  PerCond <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Cond <span class="sc">%in%</span> Cond_list[Cond_i]) <span class="sc">%&gt;%</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Comp_ROC</span>(., <span class="st">"group"</span>, <span class="st">"Consistency_zs_Cond"</span>,<span class="st">"ID"</span>,<span class="st">"moreCtl"</span>)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  PerCond<span class="sc">$</span>ROC_properties<span class="sc">$</span>Feature <span class="ot">&lt;-</span> <span class="fu">paste0</span>(PerCond<span class="sc">$</span>ROC_properties<span class="sc">$</span>Feature, <span class="st">"_"</span>, Cond_list[Cond_i])</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  All_ROC_Cond <span class="ot">&lt;-</span> <span class="fu">rbind</span>(All_ROC_Cond, PerCond<span class="sc">$</span>ROC_properties)</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(Cond_i <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># INITIALIZE ROC_curves</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>    ROC_curvesCond <span class="ot">&lt;-</span> <span class="fu">list</span>(PerCond<span class="sc">$</span>ROC_curve,PerCond<span class="sc">$</span>ROC_properties<span class="sc">$</span>Feature)</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>  ROC_curvesCond <span class="ot">&lt;-</span> <span class="fu">c</span>(ROC_curvesCond,<span class="fu">list</span>(PerCond<span class="sc">$</span>ROC_curve,PerCond<span class="sc">$</span>ROC_properties<span class="sc">$</span>Feature))</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>ds_poly <span class="ot">&lt;-</span> ds_poly <span class="sc">%&gt;%</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID,Cond) <span class="sc">%&gt;%</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GA_isValidStructCond =</span> <span class="fu">mean</span>(isValidStruct, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(Cond_i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>  PerCond <span class="ot">&lt;-</span> ds_poly <span class="sc">%&gt;%</span></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Cond <span class="sc">%in%</span> Cond_list[Cond_i]) <span class="sc">%&gt;%</span></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">as.factor</span>(group)) <span class="sc">%&gt;%</span></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Comp_ROC</span>(., <span class="st">"group"</span>, <span class="st">"GA_isValidStructCond"</span>,<span class="st">"ID"</span>,<span class="st">"moreCtl"</span>)</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>  PerCond<span class="sc">$</span>ROC_properties<span class="sc">$</span>Feature <span class="ot">&lt;-</span> <span class="fu">paste0</span>(PerCond<span class="sc">$</span>ROC_properties<span class="sc">$</span>Feature, <span class="st">"_"</span>, Cond_list[Cond_i])</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>  All_ROC_Cond <span class="ot">&lt;-</span> <span class="fu">rbind</span>(All_ROC_Cond, PerCond<span class="sc">$</span>ROC_properties)</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>  ROC_curvesCond <span class="ot">&lt;-</span> <span class="fu">c</span>(ROC_curvesCond,<span class="fu">list</span>(PerCond<span class="sc">$</span>ROC_curve,PerCond<span class="sc">$</span>ROC_properties<span class="sc">$</span>Feature))</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Sum per ID</span></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID,Cond) <span class="sc">%&gt;%</span></span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SelfInter_persegmCond =</span> <span class="fu">sum</span>(nLineCross)) </span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(Cond_i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>  PerCond <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Cond <span class="sc">%in%</span> Cond_list[Cond_i]) <span class="sc">%&gt;%</span></span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Comp_ROC</span>(., <span class="st">"group"</span>, <span class="st">"SelfInter_persegmCond"</span>,<span class="st">"ID"</span>,<span class="st">"moreCtl"</span>)</span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>  PerCond<span class="sc">$</span>ROC_properties<span class="sc">$</span>Feature <span class="ot">&lt;-</span> <span class="fu">paste0</span>(PerCond<span class="sc">$</span>ROC_properties<span class="sc">$</span>Feature, <span class="st">"_"</span>, Cond_list[Cond_i])</span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a>  All_ROC_Cond <span class="ot">&lt;-</span> <span class="fu">rbind</span>(All_ROC_Cond, PerCond<span class="sc">$</span>ROC_properties)</span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a>  ROC_curvesCond <span class="ot">&lt;-</span> <span class="fu">c</span>(ROC_curvesCond,<span class="fu">list</span>(PerCond<span class="sc">$</span>ROC_curve,PerCond<span class="sc">$</span>ROC_properties<span class="sc">$</span>Feature))</span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a><span class="fu">ggroc</span>(<span class="fu">list</span>(ROC_curvesCond[[<span class="dv">1</span>]],ROC_curvesCond[[<span class="dv">3</span>]],ROC_curvesCond[[<span class="dv">5</span>]],ROC_curvesCond[[<span class="dv">7</span>]],ROC_curvesCond[[<span class="dv">9</span>]],ROC_curvesCond[[<span class="dv">11</span>]],ROC_curvesCond[[<span class="dv">13</span>]],ROC_curvesCond[[<span class="dv">15</span>]],ROC_curvesCond[[<span class="dv">17</span>]],ROC_curvesCond[[<span class="dv">19</span>]])) <span class="sc">+</span></span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">labels =</span> <span class="fu">c</span>(ROC_curvesCond[[<span class="dv">2</span>]],ROC_curvesCond[[<span class="dv">4</span>]],ROC_curvesCond[[<span class="dv">6</span>]],ROC_curvesCond[[<span class="dv">8</span>]],ROC_curvesCond[[<span class="dv">10</span>]],ROC_curvesCond[[<span class="dv">12</span>]],ROC_curvesCond[[<span class="dv">14</span>]],ROC_curvesCond[[<span class="dv">16</span>]],ROC_curvesCond[[<span class="dv">18</span>]],ROC_curvesCond[[<span class="dv">20</span>]]), <span class="at">values =</span> <span class="fu">brewer.pal</span>(<span class="dv">11</span>, <span class="at">name =</span> <span class="st">"Set3"</span>)) <span class="sc">+</span> </span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="2.Pre-registeredReport_V5_mini_files/figure-html/PerCondition-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="summary-table-1" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="summary-table-1"><span class="header-section-number">15.2</span> Summary table</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(All_ROC_Cond[<span class="fu">order</span>(All_ROC_Cond<span class="sc">$</span>AUC, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ], <span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 2%">
<col style="width: 29%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Feature</th>
<th style="text-align: right;">AUC</th>
<th style="text-align: right;">threshold</th>
<th style="text-align: right;">sensitivity</th>
<th style="text-align: right;">specificity</th>
<th style="text-align: right;">ppv</th>
<th style="text-align: right;">npv</th>
<th style="text-align: right;">ci_low</th>
<th style="text-align: right;">ci_high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: left;">SelfInter_persegmCond_month</td>
<td style="text-align: right;">78.25</td>
<td style="text-align: right;">30.00</td>
<td style="text-align: right;">80.52</td>
<td style="text-align: right;">68.86</td>
<td style="text-align: right;">74.47</td>
<td style="text-align: right;">75.81</td>
<td style="text-align: right;">77.64</td>
<td style="text-align: right;">78.87</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">GA_isValidStructCond_month</td>
<td style="text-align: right;">74.73</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">84.62</td>
<td style="text-align: right;">60.71</td>
<td style="text-align: right;">65.62</td>
<td style="text-align: right;">81.66</td>
<td style="text-align: right;">72.76</td>
<td style="text-align: right;">76.69</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: left;">SelfInter_persegmCond_number</td>
<td style="text-align: right;">73.75</td>
<td style="text-align: right;">25.00</td>
<td style="text-align: right;">73.70</td>
<td style="text-align: right;">65.57</td>
<td style="text-align: right;">70.72</td>
<td style="text-align: right;">68.85</td>
<td style="text-align: right;">73.03</td>
<td style="text-align: right;">74.47</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Consistency_zs_Cond_number</td>
<td style="text-align: right;">70.25</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">80.19</td>
<td style="text-align: right;">59.71</td>
<td style="text-align: right;">69.19</td>
<td style="text-align: right;">72.77</td>
<td style="text-align: right;">69.44</td>
<td style="text-align: right;">71.06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: left;">SelfInter_persegmCond_weekday</td>
<td style="text-align: right;">68.89</td>
<td style="text-align: right;">59.50</td>
<td style="text-align: right;">93.51</td>
<td style="text-align: right;">41.03</td>
<td style="text-align: right;">64.14</td>
<td style="text-align: right;">84.85</td>
<td style="text-align: right;">67.99</td>
<td style="text-align: right;">69.79</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Consistency_zs_Cond_month</td>
<td style="text-align: right;">68.54</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">76.30</td>
<td style="text-align: right;">65.93</td>
<td style="text-align: right;">71.65</td>
<td style="text-align: right;">71.15</td>
<td style="text-align: right;">67.76</td>
<td style="text-align: right;">69.32</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Consistency_zs_Cond_weekday</td>
<td style="text-align: right;">67.37</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">77.92</td>
<td style="text-align: right;">58.24</td>
<td style="text-align: right;">67.80</td>
<td style="text-align: right;">70.04</td>
<td style="text-align: right;">66.36</td>
<td style="text-align: right;">68.38</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: left;">GA_isValidStructCond_weekday</td>
<td style="text-align: right;">67.11</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">88.64</td>
<td style="text-align: right;">37.99</td>
<td style="text-align: right;">55.89</td>
<td style="text-align: right;">79.05</td>
<td style="text-align: right;">64.81</td>
<td style="text-align: right;">69.41</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: left;">GA_isValidStructCond_number</td>
<td style="text-align: right;">59.36</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">81.32</td>
<td style="text-align: right;">37.01</td>
<td style="text-align: right;">53.37</td>
<td style="text-align: right;">69.09</td>
<td style="text-align: right;">57.29</td>
<td style="text-align: right;">61.43</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="references" class="level1 unnumbered" data-number="16">


</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">16 References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-brang2013" class="csl-entry" role="listitem">
Brang, David, Luke E. Miller, Marguerite McQuire, V. S. Ramachandran, and Seana Coulson. 2013. <span>â€œEnhanced Mental Rotation Ability in Time-Space Synesthesia.â€</span> <em>Cognitive Processing</em> 14 (4): 429â€“34. <a href="https://doi.org/10.1007/s10339-013-0561-5">https://doi.org/10.1007/s10339-013-0561-5</a>.
</div>
<div id="ref-deroy2013" class="csl-entry" role="listitem">
Deroy, Ophelia, and Charles Spence. 2013. <span>â€œWhy We Are Not All Synesthetes (Not Even Weakly So).â€</span> <em>Psychonomic Bulletin &amp; Review</em> 20 (4): 643â€“64. <a href="https://doi.org/10.3758/s13423-013-0387-2">https://doi.org/10.3758/s13423-013-0387-2</a>.
</div>
<div id="ref-galton1880" class="csl-entry" role="listitem">
Galton, Francis. 1880. <span>â€œVisualised Numerals.â€</span> <em>Nature</em> 21 (533): 252â€“56. <a href="https://doi.org/10.1038/021252a0">https://doi.org/10.1038/021252a0</a>.
</div>
<div id="ref-pebesma2018" class="csl-entry" role="listitem">
Pebesma, Edzer. 2018. <span>â€œSimple Features for R: Standardized Support for Spatial Vector Data.â€</span> <em>The R Journal</em> 10 (1): 439â€“46. <a href="https://doi.org/10.32614/RJ-2018-009">https://doi.org/10.32614/RJ-2018-009</a>.
</div>
<div id="ref-piazza2006" class="csl-entry" role="listitem">
Piazza, M., P. Pinel, and S. Dehaene. 2006. <span>â€œObjective Correlates of an Unusual Subjective Experience: A Single-Case Study of Number<span></span>form Synaesthesia.â€</span> <em>Cognitive Neuropsychology</em> 23 (8): 1162â€“73. <a href="https://doi.org/10.1080/02643290600780080">https://doi.org/10.1080/02643290600780080</a>.
</div>
<div id="ref-root2021" class="csl-entry" role="listitem">
Root, Nicholas, Michiko Asano, Helena Melero, Chai-Youn Kim, Anton V. Sidoroff-Dorso, Argiro Vatakis, Kazuhiko Yokosawa, Vilayanur Ramachandran, and Romke Rouw. 2021. <span>â€œDo the Colors of Your Letters Depend on Your Language? Language-Dependent and Universal Influences on Grapheme-Color Synesthesia in Seven Languages.â€</span> <em>Consciousness and Cognition</em> 95 (October): 103192. <a href="https://doi.org/10.1016/j.concog.2021.103192">https://doi.org/10.1016/j.concog.2021.103192</a>.
</div>
<div id="ref-root2025" class="csl-entry" role="listitem">
Root, Nicholas, Ana Chkhaidze, Helena Melero, Anton Sidoroff-Dorso, Gregor Volberg, Yijia Zhang, and Romke Rouw. 2025. <span>â€œHow <span>â€œ</span>Diagnostic<span>â€</span> Criteria Interact to Shape Synesthetic Behavior: The Role of Self-Report and Test<span></span>retest Consistency in Synesthesia Research.â€</span> <em>Consciousness and Cognition</em> 129 (March): 103819. <a href="https://doi.org/10.1016/j.concog.2025.103819">https://doi.org/10.1016/j.concog.2025.103819</a>.
</div>
<div id="ref-rothen2016" class="csl-entry" role="listitem">
Rothen, Nicolas, Kristin JÃ¼nemann, Andy D. Mealor, Vera Burckhardt, and Jamie Ward. 2016. <span>â€œThe Sensitivity and Specificity of a Diagnostic Test of Sequence-Space Synesthesia.â€</span> <em>Behavior Research Methods</em> 48 (4): 1476â€“81. <a href="https://doi.org/10.3758/s13428-015-0656-2">https://doi.org/10.3758/s13428-015-0656-2</a>.
</div>
<div id="ref-rothen2013" class="csl-entry" role="listitem">
Rothen, Nicolas, Anil K. Seth, Christoph Witzel, and Jamie Ward. 2013b. <span>â€œDiagnosing Synaesthesia with Online Colour Pickers: Maximising Sensitivity and Specificity.â€</span> <em>Journal of Neuroscience Methods</em> 215 (1): 156â€“60. <a href="https://doi.org/10.1016/j.jneumeth.2013.02.009">https://doi.org/10.1016/j.jneumeth.2013.02.009</a>.
</div>
<div id="ref-rothen2013a" class="csl-entry" role="listitem">
â€”â€”â€”. 2013a. <span>â€œDiagnosing Synaesthesia with Online Colour Pickers: Maximising Sensitivity and Specificity.â€</span> <em>Journal of Neuroscience Methods</em> 215 (1): 156â€“60. <a href="https://doi.org/10.1016/j.jneumeth.2013.02.009">https://doi.org/10.1016/j.jneumeth.2013.02.009</a>.
</div>
<div id="ref-sagiv2006" class="csl-entry" role="listitem">
Sagiv, N, J Simner, J Collins, B Butterworth, and J Ward. 2006. <span>â€œWhat Is the Relationship Between Synaesthesia and Visuo-Spatial Number Forms?â€</span> <em>Cognition</em> 101 (1): 114â€“28. <a href="https://doi.org/10.1016/j.cognition.2005.09.004">https://doi.org/10.1016/j.cognition.2005.09.004</a>.
</div>
<div id="ref-seron1992" class="csl-entry" role="listitem">
Seron, Xavier, Mauro Pesenti, Marie-Pascale NoÃ«l, GÃ©rard Deloche, and Jacques-AndrÃ© Cornet. 1992. <span>â€œImages of numbers, or <span>â€œ</span>when 98 is upper left and 6 sky blue<span>â€</span>.â€</span> <em>Cognition</em>, Numerical Cognition, 44 (1): 159â€“96. <a href="https://doi.org/10.1016/0010-0277(92)90053-K">https://doi.org/10.1016/0010-0277(92)90053-K</a>.
</div>
<div id="ref-vanpetersen2020" class="csl-entry" role="listitem">
Van Petersen, Eline, Mareike Altgassen, Rob Van Lier, and Tessa M. Van Leeuwen. 2020b. <span>â€œEnhanced Spatial Navigation Skills in Sequence-Space Synesthetes.â€</span> <em>Cortex</em> 130 (September): 49â€“63. <a href="https://doi.org/10.1016/j.cortex.2020.04.034">https://doi.org/10.1016/j.cortex.2020.04.034</a>.
</div>
<div id="ref-vanpetersen2020a" class="csl-entry" role="listitem">
â€”â€”â€”. 2020a. <span>â€œEnhanced Spatial Navigation Skills in Sequence-Space Synesthetes.â€</span> <em>Cortex</em> 130 (September): 49â€“63. <a href="https://doi.org/10.1016/j.cortex.2020.04.034">https://doi.org/10.1016/j.cortex.2020.04.034</a>.
</div>
<div id="ref-ward" class="csl-entry" role="listitem">
Ward, Jamie. n.d.a. <span>â€œOptimizing a Measure of Consistency for Sequence-Space Synaesthesia.â€</span> <a href="https://doi.org/10.31234/osf.io/5cnr7">https://doi.org/10.31234/osf.io/5cnr7</a>.
</div>
<div id="ref-wardb" class="csl-entry" role="listitem">
â€”â€”â€”. n.d.b. <span>â€œOptimizing a Measure of Consistency for Sequence-Space Synaesthesia.â€</span> <a href="https://doi.org/10.31234/osf.io/5cnr7">https://doi.org/10.31234/osf.io/5cnr7</a>.
</div>
<div id="ref-ward2018" class="csl-entry" role="listitem">
Ward, Jamie, Alberta Ipser, Eva Phanvanova, Paris Brown, Iris Bunte, and Julia Simner. 2018. <span>â€œThe Prevalence and Cognitive Profile of Sequence-Space Synaesthesia.â€</span> <em>Consciousness and Cognition</em> 61 (May): 79â€“93. <a href="https://doi.org/10.1016/j.concog.2018.03.012">https://doi.org/10.1016/j.concog.2018.03.012</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Of which we replicate the original results <span class="citation" data-cites="rothen2016">(<a href="#ref-rothen2016" role="doc-biblioref">Rothen et al. 2016</a>)</span> in a separate document<a href="#fnref1" class="footnote-back" role="doc-backlink">â†©ï¸Ž</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>